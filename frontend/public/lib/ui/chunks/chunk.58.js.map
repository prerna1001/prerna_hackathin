{"version":3,"sources":["webpack:///./src/ui/src/components/AnnotationContentOverlay/AnnotationContentOverlay.scss?be7c","webpack:///./src/ui/src/components/AnnotationContentOverlay/FormFieldWidgetOverlay.js","webpack:///./src/ui/src/components/AnnotationContentOverlay/AnnotationContentOverlay.js","webpack:///./src/ui/src/components/AnnotationContentOverlay/index.js"],"names":["module","exports","propTypes","annotation","PropTypes","object","overlayPosition","overlayRef","FormFieldWidgetOverlay","_ref","t","_slicedToArray","useTranslation","formFieldWidgetName","getField","name","React","createElement","className","data-element","DataElements","ANNOTATION_CONTENT_OVERLAY","style","_objectSpread","ref","widget","window","Core","Annotations","TextWidgetAnnotation","SignatureWidgetAnnotation","CheckButtonWidgetAnnotation","ListWidgetAnnotation","ChoiceWidgetAnnotation","RadioButtonWidgetAnnotation","PushButtonWidgetAnnotation","mapWidgetypeToTranslation","clientXY","AnnotationContentOverlay","core","useCore","_useSelector2","useSelector","state","selectors","isElementDisabled","isElementOpen","getAnnotationContentOverlayHandler","shallowEqual","isDisabled","isOverlayOpen","customHandler","_useState2","useState","left","top","setOverlayPosition","isUsingCustomHandler","useRef","contents","getContents","fitWindowSize","useCallback","clientX","clientY","overlayRect","current","getBoundingClientRect","width","innerWidth","height","innerHeight","isApryseWebViewerWebComponent","_getRootNode","host","getRootNode","hostBoundingRect","scrollLeft","scrollTop","useEffect","_fitWindowSize","numberOfReplies","getReplies","length","preRenderedElements","customRender","isMobileDevice","undefined","CustomElement","render","isInFormFieldCreationMode","getFormFieldCreationManager","WidgetAnnotation","getDisplayAuthor","concat","slice","count"],"mappings":"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","file":"chunks/chunk.58.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"LEFT_HEADER_WIDTH\":\"41px\",\"RIGHT_HEADER_WIDTH\":\"41px\"};","\nimport React from 'react';\nimport { useTranslation } from 'react-i18next';\nimport DataElements from 'constants/dataElement';\nimport PropTypes from 'prop-types';\n\nconst propTypes = {\n  annotation: PropTypes.object,\n  overlayPosition: PropTypes.object,\n  overlayRef: PropTypes.object,\n};\n\nconst FormFieldWidgetOverlay = ({ annotation, overlayPosition, overlayRef }) => {\n  const [t] = useTranslation();\n  const formFieldWidgetName = annotation.getField().name;\n\n  const mapWidgetypeToTranslation = (widget) => {\n    switch (true) {\n      case widget instanceof window.Core.Annotations.TextWidgetAnnotation:\n        return 'formField.types.text';\n      case widget instanceof window.Core.Annotations.SignatureWidgetAnnotation:\n        return 'formField.types.signature';\n      case widget instanceof window.Core.Annotations.CheckButtonWidgetAnnotation:\n        return 'formField.types.checkbox';\n      case widget instanceof window.Core.Annotations.ListWidgetAnnotation:\n        return 'formField.types.listbox';\n      case widget instanceof window.Core.Annotations.ChoiceWidgetAnnotation:\n        return 'formField.types.combobox';\n      case widget instanceof window.Core.Annotations.RadioButtonWidgetAnnotation:\n        return 'formField.types.radio';\n      case widget instanceof window.Core.Annotations.PushButtonWidgetAnnotation:\n        return 'formField.types.button';\n      default:\n        return undefined;\n    }\n  };\n\n  return (\n    <div\n      className=\"Overlay AnnotationContentOverlay\"\n      data-element={DataElements.ANNOTATION_CONTENT_OVERLAY}\n      style={{ ...overlayPosition }}\n      ref={overlayRef}\n    >\n      <div>\n        <span style={{ 'fontWeight': 'bold' }}>{t('formField.type')}: </span>\n        {t(mapWidgetypeToTranslation(annotation))}\n      </div>\n      <div>\n        <span style={{ 'fontWeight': 'bold' }}>{t('formField.formFieldPopup.fieldName')}: </span>\n        {formFieldWidgetName}\n      </div>\n    </div>\n  );\n};\n\nFormFieldWidgetOverlay.propTypes = propTypes;\nexport default FormFieldWidgetOverlay;","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useSelector, shallowEqual } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport PropTypes from 'prop-types';\nimport useCore from 'hooks/useCore';\nimport selectors from 'selectors';\n\nimport { isMobileDevice } from 'helpers/device';\nimport DataElements from 'constants/dataElement';\nimport CustomElement from '../CustomElement';\nimport FormFieldWidgetOverlay from './FormFieldWidgetOverlay';\nimport './AnnotationContentOverlay.scss';\nimport getRootNode from 'src/helpers/getRootNode';\n\nconst MAX_CHARACTERS = 100;\n\nconst propTypes = {\n  annotation: PropTypes.object,\n  clientXY: PropTypes.object,\n};\n\nconst AnnotationContentOverlay = ({ annotation, clientXY }) => {\n  const { core } = useCore();\n  const [\n    isDisabled,\n    isOverlayOpen,\n    // Clients have the option to customize how the tooltip is rendered by passing a handler\n    customHandler,\n  ] = useSelector((state) => [\n    selectors.isElementDisabled(state, DataElements.ANNOTATION_CONTENT_OVERLAY),\n    selectors.isElementOpen(state, DataElements.ANNOTATION_CONTENT_OVERLAY),\n    selectors.getAnnotationContentOverlayHandler(state),\n  ], shallowEqual);\n\n  const [t] = useTranslation();\n  const [overlayPosition, setOverlayPosition] = useState({\n    left: -99999,\n    top: -99999,\n  });\n\n  const isUsingCustomHandler = customHandler !== null;\n  const overlayRef = useRef(null);\n  const contents = annotation?.getContents();\n  // the gap between the component and the mouse, to make sure that the mouse won't be on component element\n  // so that the underlying annotation will always be hovered\n  const gap = 20;\n\n  const fitWindowSize = useCallback((clientX, clientY, left, top) => {\n    const overlayRect = overlayRef.current.getBoundingClientRect();\n\n    if (left + overlayRect.width > window.innerWidth) {\n      left = clientX - overlayRect.width - gap;\n    }\n\n    if (top + overlayRect.height > window.innerHeight) {\n      top = clientY - overlayRect.height - gap;\n    }\n\n    if (top <= 0) {\n      top = 0;\n    }\n\n    if (window.isApryseWebViewerWebComponent) {\n      const host = getRootNode()?.host;\n      const hostBoundingRect = host?.getBoundingClientRect();\n      if (hostBoundingRect) {\n        left -= hostBoundingRect.left;\n        top -= hostBoundingRect.top;\n\n        // Include host scroll offsets\n        left += host.scrollLeft;\n        top += host.scrollTop;\n      }\n    }\n\n    return { left, top };\n  }, []);\n\n  useEffect(() => {\n    if (overlayRef.current && annotation) {\n      const { clientX, clientY } = clientXY;\n      const { left, top } = fitWindowSize(clientX, clientY, clientX + gap, clientY + gap);\n      setOverlayPosition({ left, top });\n    }\n  }, [annotation, clientXY, fitWindowSize]);\n\n  const numberOfReplies = annotation?.getReplies().length;\n  const preRenderedElements = isUsingCustomHandler && annotation ? customHandler(annotation) : null;\n  const customRender = useCallback(() => preRenderedElements, [preRenderedElements]);\n\n  const renderContents = () => (\n    <div\n      className=\"Overlay AnnotationContentOverlay\"\n      data-element={DataElements.ANNOTATION_CONTENT_OVERLAY}\n      style={{ ...overlayPosition }}\n      ref={overlayRef}\n    >\n      <div className=\"author\">{core.getDisplayAuthor(annotation['Author'])}</div>\n      <div className=\"contents\">\n        {contents.length > MAX_CHARACTERS\n          ? `${contents.slice(0, MAX_CHARACTERS)}...`\n          : contents}\n      </div>\n      {numberOfReplies > 0 && (\n        <div className=\"replies\">\n          {t('message.annotationReplyCount', { count: numberOfReplies })}\n        </div>\n      )}\n    </div>\n  );\n\n  if (isDisabled || isMobileDevice || !annotation) {\n    return null;\n  }\n\n  if (isUsingCustomHandler && isOverlayOpen && preRenderedElements !== undefined) {\n    if (preRenderedElements) {\n      return (\n        <div\n          className=\"Overlay AnnotationContentOverlay\"\n          data-element={DataElements.ANNOTATION_CONTENT_OVERLAY}\n          style={{ ...overlayPosition }}\n          ref={overlayRef}\n        >\n          <CustomElement render={customRender} />\n        </div>\n      );\n    }\n    return null;\n  }\n\n  const isInFormFieldCreationMode = core.getFormFieldCreationManager().isInFormFieldCreationMode();\n\n  if (isOverlayOpen && isInFormFieldCreationMode && annotation instanceof window.Core.Annotations.WidgetAnnotation) {\n    return (\n      <FormFieldWidgetOverlay\n        annotation={annotation}\n        overlayPosition={overlayPosition}\n        overlayRef={overlayRef}\n      />\n    );\n  }\n\n  if (contents && isOverlayOpen) {\n    return renderContents();\n  }\n\n  return null;\n};\n\nAnnotationContentOverlay.propTypes = propTypes;\n\nexport default AnnotationContentOverlay;\n","import AnnotationContentOverlay from './AnnotationContentOverlay';\n\nexport default AnnotationContentOverlay;"],"sourceRoot":""}