(window.webpackJsonpWebViewerUI=window.webpackJsonpWebViewerUI||[]).push([[78],{1761:function(e,t,a){e.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1870:function(e,t,a){"use strict";a.r(t);a(9),a(10),a(14),a(38),a(81),a(21),a(49),a(20),a(12),a(43),a(22),a(18),a(16),a(267),a(37),a(8),a(17),a(19),a(62),a(11),a(13),a(94);var n=a(0),r=a.n(n),l=a(6),c=a(307),i=a(106),o=a(15),u=a.n(o),s=a(419),d=a(33),m=a(2),f=a(3),p=(a(36),a(137),a(136),a(1)),v=a.n(p),b=a(120),E=a(72),S=a(53);function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,i=[],o=!0,u=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;o=!1}else for(;!(o=(n=l.call(a)).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){u=!0,r=e}finally{try{if(!o&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(u)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var w=window.Core.Scale,O={scale:v.a.array,onScaleChange:v.a.func,precision:v.a.number};function j(e){var t=e.scale,a=e.onScaleChange,i=e.precision,o=g(Object(l.e)((function(e){return[f.a.getMeasurementUnits(e)]}),l.c),1)[0],d=g(Object(n.useState)(""),2),m=d[0],p=d[1],v=g(Object(n.useState)(""),2),y=v[0],O=v[1],j=g(Object(n.useState)(!1),2),A=j[0],h=j[1],N=g(Object(n.useState)(""),2),C=N[0],M=N[1],I=g(Object(n.useState)(""),2),L=I[0],T=I[1],D=g(Object(n.useState)(!1),2),U=D[0],k=D[1],R=g(Object(n.useState)(0),2),_=R[0],x=R[1],F=Object(n.useRef)(null),H=Object(n.useRef)(null),P=Object(n.useRef)(null),V=g(Object(c.a)(),1)[0],B=function(e){return e.filter((function(e){return s.e.includes(e)}))},W=A?B(o.from):o.from,K=A?B(o.to):o.to;Object(n.useEffect)((function(){W.includes(t[0][1])||X(W[0],!0)}),[t[0][1]]),Object(n.useEffect)((function(){W.includes(t[0][1])&&!K.includes(t[1][1])&&X(K[0],!1)}),[t[0][1],t[1][1]]),Object(n.useEffect)((function(){var e=function(e){return null==e?void 0:e.toFixed((1/i).toString().length-1)};t[0][0]&&(null==F?void 0:F.current)!==document.activeElement&&p(A?w.getFormattedValue(t[0][0],t[0][1],i,!1,!0)||"":e(t[0][0])||""),!t[1][0]||H&&H.current===document.activeElement||(A||"ft-in"===t[1][1]?O(w.getFormattedValue(t[1][0],t[1][1],i,!1,!0)||""):O(e(t[1][0])||""))}),[t,i,H,F,A,U]),Object(n.useEffect)((function(){h(Object(s.j)(i))}),[i]),Object(n.useEffect)((function(){A?(M(s.i[t[0][1]]),T(s.i[t[1][1]])):"ft-in"===t[1][1]?(M(""),T(s.i["ft-in decimal"])):(M(""),T(""))}),[t,A]),Object(n.useEffect)((function(){!$&&Q(H.current.value,!1)}),[t[1][1]]),Object(n.useEffect)((function(){if(J||$)!J&&Q(F.current.value,!0),!$&&Q(H.current.value,!1);else{var e={value:t[0][0],unit:t[0][1]};Q(F.current.value,!0,(function(t){e=t.pageScale}));var a={value:t[1][0],unit:t[1][1]};Q(H.current.value,!1,(function(e){a=e.worldScale})),z(new w({pageScale:e,worldScale:a}))}}),[A]),Object(n.useEffect)((function(){P.current&&x((P.current.clientWidth-8)/2)}),[P]);var J=!!t[0][0],$=!!t[1][0],q=u()("scale-input",{"invalid-value":!J}),G=u()("scale-input",{"invalid-value":!$}),z=function(e){var t=function(e){return"ft-in"===e?i/12:i};e.pageScale.value&&e.pageScale.value<i&&(e.pageScale.value=t(e.pageScale.unit)),e.worldScale.value&&e.worldScale.value<i&&(e.worldScale.value=t(e.worldScale.unit)),a(e)},Q=function(e,a,n){var r=function(e){if(a&&e!==t[0][0]||!a&&e!==t[1][0]){var r=new w({pageScale:{value:a?e:t[0][0],unit:t[0][1]},worldScale:{value:a?t[1][0]:e,unit:t[1][1]}});n?n(r):z(r)}};a?p(e):O(e);var l=e.trim();if(A){var c=a?t[0][1]:t[1][1];if("in"===c){if(s.k.test(l)){var i=Object(s.p)(l);if(i>0)return void r(i)}}else if("ft-in"===c&&s.g.test(l)){var o=Object(s.o)(l);if(o>0)return void r(o)}}else if(a||"ft-in"!==t[1][1]){if(s.d.test(l)){return void r(parseFloat(l)||0)}}else if(s.f.test(l)){var u=Object(s.n)(l);if(u>0)return void r(u)}r(void 0)},X=function(e,a){var n,r;n=a&&e!==t[0][1]?{value:t[0][0]?Object(s.c)(t[0][0],t[0][1],e):t[0][0],unit:e}:{value:t[0][0],unit:t[0][1]},r=a||e===t[1][1]?{value:t[1][0],unit:t[1][1]}:{value:t[1][0]?Object(s.c)(t[1][0],t[1][1],e):t[1][0],unit:e},z(new w({pageScale:n,worldScale:r}))},Y=function(e){var a=e?t[0][1]:t[1][1];return A?s.i[a]:"ft-in"===a?s.i["ft-in decimal"]:""},Z=function(){k((function(e){return!e}))};return r.a.createElement("div",{className:"custom-scale-container"},r.a.createElement("div",{className:"scale-ratio-input-container"},r.a.createElement("div",{className:"scale-ratio-display"},r.a.createElement("div",{className:"left-container",ref:P},r.a.createElement("div",{className:"unit-label",id:"paper-units-dropdown-label"},V("option.measurement.scaleModal.paperUnits")),r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("div",{className:u()({"warning-alert":!J})},r.a.createElement("input",{type:A?"text":"number",min:"0",className:q,value:m,"aria-label":V("insertPageModal.pageDimensions.units"),"data-element":"customPageScaleValue",onChange:function(e){return Q(e.target.value,!0)},placeholder:Y(!0),ref:F,onBlur:Z}),r.a.createElement(S.a,{glyph:"icon-alert",className:"warning-alert-icon"})),r.a.createElement(b.a,{content:"option.measurement.scaleModal.paperUnits"},r.a.createElement("div",{className:"unit-input"},r.a.createElement(E.a,{id:"paper-units-dropdown",labelledById:"paper-units-dropdown-label",dataElement:"customPageScaleUnit",items:W,onClickItem:function(e){return X(e,!0)},currentSelectionKey:t[0][1],width:_}))))),r.a.createElement("div",{className:"scale-ratio-equal"}," = "),r.a.createElement("div",{className:"right-container"},r.a.createElement("div",{className:"unit-label",id:"display-units-dropdown-label"},V("option.measurement.scaleModal.displayUnits")),r.a.createElement("div",{className:"input-wrapper"},r.a.createElement("div",{className:u()({"warning-alert":!$})},r.a.createElement("input",{type:A||"ft-in"===t[1][1]?"text":"number",min:"0",className:G,value:y,"aria-label":V("insertPageModal.pageDimensions.units"),"data-element":"customDisplayScaleValue",onChange:function(e){return Q(e.target.value,!1)},placeholder:Y(!1),ref:H,onBlur:Z}),r.a.createElement(S.a,{glyph:"icon-alert",className:"warning-alert-icon"})),r.a.createElement(b.a,{content:"option.measurement.scaleModal.displayUnits"},r.a.createElement("div",{className:"unit-input"},r.a.createElement(E.a,{id:"display-units-dropdown",labelledById:"display-units-dropdown-label",items:K,dataElement:"customDisplayScaleUnit",onClickItem:function(e){return X(e,!1)},currentSelectionKey:t[1][1],width:_}))))))),r.a.createElement("div",{className:"warning-messages","aria-live":"assertive"},!J&&r.a.createElement("p",{className:"no-margin"},"".concat(V("option.measurement.scaleModal.incorrectSyntax")," ").concat(C)),!$&&r.a.createElement("p",{className:"world-value-warning no-margin"},"".concat(V("option.measurement.scaleModal.incorrectSyntax")," ").concat(L))))}j.propTypes=O;var A=j,h=a(5),N=a(230),C=a(61),M=a(383);a(1761),a(645);function I(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var n,r,l,c,i=[],o=!0,u=!1;try{if(l=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;o=!1}else for(;!(o=(n=l.call(a)).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){u=!0,r=e}finally{try{if(!o&&null!=a.return&&(c=a.return(),Object(c)!==c))return}finally{if(u)throw r}}return i}}(e,t)||T(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){if(e){if("string"==typeof e)return D(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?D(e,t):void 0}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=Array(t);a<t;a++)n[a]=e[a];return n}var U=window.Core.Scale,k=window.Core.Tools.ToolNames,R="custom",_="preset",x=function(e){var t,a,o=e.annotations,p=e.selectedTool,v=Object(d.a)().core,S=Object(l.d)(),g=L(Object(c.a)(),1)[0],y=L(Object(l.e)((function(e){return[f.a.isElementDisabled(e,h.a.SCALE_MODAL),f.a.isElementOpen(e,h.a.SCALE_MODAL),f.a.isElementHidden(e,h.a.SCALE_MODAL),f.a.getSelectedScale(e),f.a.getActiveToolName(e),f.a.getIsAddingNewScale(e),f.a.getMeasurementScalePreset(e),f.a.getCalibrationInfo(e),f.a.getIsMultipleScalesMode(e)]})),9),w=y[0],O=y[1],j=y[2],T=y[3],D=y[4],x=y[5],F=y[6],H=y[7],P=H.tempScale,V=H.isFractionalUnit,B=y[8],W=L(Object(n.useState)(!1),2),K=W[0],J=W[1],$=L(Object(n.useState)(s.r[s.a.DECIMAL][0]),2),q=$[0],G=$[1],z=L(Object(n.useState)(R),2),Q=z[0],X=z[1],Y=L(Object(n.useState)(F[s.b.METRIC][0]),2),Z=Y[0],ee=Y[1],te=L(Object(n.useState)(new U("")),2),ae=te[0],ne=te[1],re=L(Object(n.useState)(!1),2),le=re[0],ce=re[1],ie=Object.keys(v.getScales()).length;Object(n.useEffect)((function(){s.r[pe].includes(q)||G(s.r[pe][0]),ee(F[me][0])}),[K]),Object(n.useEffect)((function(){X(R),ne(new U(T.getScaleRatioAsArray()));var e=v.getScalePrecision(T);if(e){var t=Object(s.j)(e);J(t);var a=s.r[fe(t)].find((function(t){return t[1]===e}));G(a),setTimeout((function(){ce(!1)}))}}),[T]),Object(N.a)((function(){if(Q===R)ne(Z[1]);else{var e=s.s[Z[0]];e&&e!==q&&G(e)}}),[Q]),Object(n.useEffect)((function(){var e=function(e){e.name===k.CALIBRATION_MEASUREMENT||!O||j||oe()};return v.addEventListener("toolModeUpdated",e),function(){return v.removeEventListener("toolModeUpdated",e)}}),[O,j]),Object(n.useEffect)((function(){var e=s.s[Z[0]];e&&Q===_&&G(e)}),[Z]),Object(n.useEffect)((function(){!j&&P&&(ne(new U(P)),S(m.a.updateCalibrationInfo({isCalibration:!1})),J(V))}),[j]),Object(n.useEffect)((function(){ce(!0)}),[q,ae,Z,Q]),Object(n.useEffect)((function(){O&&x&&!P&&(X(R),ne(s.l),J(!1),G(s.r[s.a.DECIMAL][0]))}),[O,x]);var oe=function(){S(m.a.closeElement(h.a.SCALE_MODAL)),S(m.a.setIsAddingNewScale(!1))},ue=function(){var e=function(e,t){var a=e,n=q[1];return K?("ft-in"===t&&(n/=12),a=Math.round(a/n)*n):"ft-in"!==t&&(a=a.toFixed((1/n).toString().length-1)),1*a};if(de){var t=ae.getScaleRatioAsArray();return t[0][0]=e(t[0][0],t[0][1]),t[1][0]=e(t[1][0],t[1][1]),t}return Z[1].toString()},se=u()("Modal","ScaleModal",{open:!j,closed:j}),de=Q===R,me=K?s.b.IMPERIAL:s.b.METRIC,fe=function(e){return e?s.a.FRACTIONAL:s.a.DECIMAL},pe=fe(K),ve=!de||ae.isValid(),be=de&&!(s.e.includes(null===(t=ae.pageScale)||void 0===t?void 0:t.unit)&&s.e.includes(null===(a=ae.worldScale)||void 0===a?void 0:a.unit));return!w&&r.a.createElement("div",{className:se,"data-element":h.a.SCALE_MODAL},r.a.createElement(M.a,{title:"option.measurementOption.scale",isOpen:O,onCloseClick:oe,closeHandler:oe,swipeToClose:!0},r.a.createElement("div",{className:"content-container"},r.a.createElement("div",{className:"scaleSetting"},r.a.createElement("div",{className:"custom-option-wrapper"},r.a.createElement("div",{className:"custom-scale-option"},r.a.createElement(i.a,{"data-element":"customScaleOption",radio:!0,name:"setting",onChange:function(){return X(R)},checked:de,label:"".concat(g("option.measurement.scaleModal.custom"),":"),center:!0})),de&&r.a.createElement("button",{"data-element":"calibrate",className:"calibrate-btn",onClick:function(){var e;v.setToolMode("AnnotationCreateCalibrationMeasurement");var t=de?(null===(e=ae.worldScale)||void 0===e?void 0:e.unit)||"":Z[1].worldScale.unit;S(m.a.updateCalibrationInfo({isCalibration:!0,previousToolName:D,defaultUnit:t})),S(m.a.setIsElementHidden(h.a.SCALE_MODAL,!0))}},g("option.measurement.scaleModal.calibrate"))),de?r.a.createElement(A,{scale:ae.getScaleRatioAsArray(),onScaleChange:ne,precision:q[1]}):null,r.a.createElement("div",{className:"custom-scale-option"},r.a.createElement(i.a,{"data-element":"presetScaleOption",radio:!0,onChange:function(){return X(_)},name:"setting",checked:!de,label:"".concat(g("option.measurement.scaleModal.preset"),":"),center:!0})),!de&&r.a.createElement("div",{className:"scaleModal__preset-container"},r.a.createElement("div",{className:"selector"},r.a.createElement(E.a,{id:"preset-scale-dropdown",dataElement:"presetScales",items:F[me].map((function(e){return e[0]})),currentSelectionKey:Z[0],onClickItem:function(e,t){return ee(F[me][t])}}))),de?null:r.a.createElement("div",{className:"block"})),r.a.createElement("div",{className:"precision-container"},r.a.createElement("div",{className:"precision-selector"},r.a.createElement("div",{className:"precision-title",id:"scale-precision-dropdown-label"},g("option.shared.precision"),":"),r.a.createElement("div",{className:"selector"},r.a.createElement(E.a,{id:"scale-precision-dropdown",labelledById:"scale-precision-dropdown-label",dataElement:"scalePrecisions",items:s.r[pe].map((function(e){return e[0]})),currentSelectionKey:q[0],onClickItem:function(e,t){return G(s.r[pe][t])},ariaLabel:g("option.shared.precision")}))),r.a.createElement(b.a,{content:g("option.measurement.scaleModal.fractionUnitsTooltip")},r.a.createElement("div",{className:"fractional-units-container"},r.a.createElement(i.a,{isSwitch:!0,leftLabel:!0,id:"scale-modal-fractional-units",label:g("option.measurement.scaleModal.fractionalUnits"),checked:K,onChange:function(){J((function(e){return!e}))},disabled:be}))))),r.a.createElement("div",{className:"footer"},r.a.createElement(C.a,{type:"button",onClick:function(){var e,t;e=[T],t=new U(ue(),q[1]),v.replaceScales(e,t),oe()},className:"scale-update",dataElement:"updateScale",disabled:x||!ve||!le},g("action.update")),r.a.createElement("button",{onClick:function(){var e,t;e=new U(ue(),q[1]),t=[].concat(I(o),[p]),v.createAndApplyScale(e,t),oe()},className:"scale-create","data-element":"createScale",disabled:!ve||!B&&ie||!x&&!le},g("action.create")))))};t.default=x}}]);
//# sourceMappingURL=chunk.78.js.map