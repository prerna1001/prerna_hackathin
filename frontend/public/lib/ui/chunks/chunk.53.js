(window.webpackJsonpWebViewerUI=window.webpackJsonpWebViewerUI||[]).push([[53],{1823:function(e,t,n){},1824:function(e,t,n){},1850:function(e,t,n){"use strict";n.r(t);n(9),n(10),n(14),n(31),n(38),n(36),n(27),n(21),n(20),n(12),n(22),n(32),n(18),n(16),n(29),n(47),n(23),n(46),n(48),n(37),n(8),n(17),n(19),n(11),n(30),n(13);var r=n(0),a=n.n(r),o=n(33),i=(n(81),n(43),n(95),n(6)),l=n(307),c=n(567),u=n(44),s=n(97),d=n(53),f=n(5),b=n(76),m=n(3),h=n(2),v=n(1),g=n.n(v),p=function(e){var t=e.id,n=void 0===t?"":t,a=e.additionalTabs,o=e.tabsForReference,l=e.onClick,c=e.activeItem,u=Object(i.d)(),s=Object(i.e)((function(e){return m.a.getFlyout(e,n)}));return Object(r.useLayoutEffect)((function(){var e={dataElement:n,className:"AdditionalTabsFlyout",items:a.map((function(e){var t=e.name;return{label:t,title:t,option:t,disabled:e.disabled,isActive:t===c,dataElement:Symbol(t).toString(),onClick:function(){return l(t,e.sheetIndex)}}}))};u(s?h.a.updateFlyout(e.dataElement,e):h.a.addFlyout(e))}),[o,c]),null};p.propTypes={id:g.a.string,additionalTabs:g.a.arrayOf(g.a.shape({name:g.a.string,sheetIndex:g.a.number,disabled:g.a.bool})),tabsForReference:g.a.array,onClick:g.a.func,activeItem:g.a.string};var y=p,S=(n(111),n(136),n(15)),O=n.n(S),E=n(90),j=function(e){var t=e.sheetId,n=e.handleClick,a=e.sheetCount,o=e.disabled,l=Object(i.d)(),c="".concat(f.a.SHEET_TAB_OPTIONS_FLYOUT,"-").concat(t),u=Object(i.e)((function(e){return m.a.getFlyout(e,c)})),s=Object(E.a)((function(e){return n("Rename",e)})),d=Object(E.a)((function(e){return n("Delete",e)}));return Object(r.useLayoutEffect)((function(){var e={dataElement:c,className:"TabOptionsFlyout",items:[{label:"action.rename",title:"action.rename",option:"Rename",dataElement:"sheetTabRenameOption",onClick:s},{label:"action.delete",title:"action.delete",option:"Delete",dataElement:"sheetTabDeleteOption",onClick:d,disabled:1===a||o}]};l(u?h.a.updateFlyout(e.dataElement,e):h.a.addFlyout(e))}),[a,o,n]),null};j.propTypes={sheetId:g.a.string,handleClick:g.a.func,sheetCount:g.a.number,disabled:g.a.bool};var I=j;function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var T=function(e){var t=e.handleClick,n=void 0===t?function(){}:t,r=e.id,o=e.onToggle,i=e.label,c=e.disabled,u=e.sheetCount,d=k(Object(l.a)(),1)[0];return a.a.createElement(a.a.Fragment,null,a.a.createElement(s.a,{dataElement:"options-".concat(r),title:"".concat(d("option.searchPanel.moreOptions")," ").concat(i),img:"icon-tools-more-vertical",onToggle:function(e){e&&o(i)},disabled:c,toggleElement:"".concat(f.a.SHEET_TAB_OPTIONS_FLYOUT,"-").concat(r)}),a.a.createElement(I,{sheetId:r,sheetCount:u,handleClick:function(e){return n(r,i,e)},disabled:c}))};T.propTypes={id:g.a.string,label:g.a.string,onToggle:g.a.func,handleClick:g.a.func,disabled:g.a.bool,sheetCount:g.a.number};var A=T,C=(n(1823),n(164));function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var N={sheet:g.a.any.isRequired,sheetCount:g.a.number,activeSheetLabel:g.a.string.isRequired,setLabelBeingEdited:g.a.func.isRequired,setActiveSheet:g.a.func.isRequired,renameSheet:g.a.func.isRequired,deleteSheet:g.a.func.isRequired,onClick:g.a.func.isRequired,isEditMode:g.a.bool.isRequired,checkIsSheetNameDuplicated:g.a.func,noRightBorder:g.a.bool,isReadOnlyMode:g.a.bool,skipDeleteWarning:g.a.bool},x=function(e){var t=e.sheet,n=e.activeSheetLabel,o=e.onClick,c=e.sheetCount,s=e.setLabelBeingEdited,d=e.setActiveSheet,f=e.isEditMode,b=e.noRightBorder,m=e.checkIsSheetNameDuplicated,v=e.isReadOnlyMode,g=e.deleteSheet,p=e.renameSheet,y=e.skipDeleteWarning,S=t.sheetIndex,E=t.name,j=t.disabled,I=E===n,k=D(Object(r.useState)(""),2),w=k[0],T=k[1],R=D(Object(r.useState)(!1),2),N=R[0],x=R[1],L=Object(l.a)().t,M=Object(r.useRef)(),B=Object(i.d)();Object(r.useEffect)((function(){w&&M.current&&M.current.focus()}),[w]);var F=function(){var e=""===w?"warning.sheetTabRenameIssueTwo":"warning.sheetTabRenameIssueOne",t={message:L("".concat(e,".message")),title:L("".concat(e,".title")),confirmBtnText:L("action.ok"),onConfirm:function(){return M.current.focus()},onCancel:function(){s(!1),x(!1),T(E)}};B(h.a.showWarningMessage(t))},P=function(){if(N)F();else{var e=m(w),t=""===w.trim();if(e||t)return x(!0),void F();p(E,w),s(null),x(!1),T("")}},W=Object(C.a)(P,"addTabButton"),_=null;return _=f?a.a.createElement("input",{type:"text",className:O()("sheet-input",{"input-error":N}),ref:M,value:w,onChange:function(e){var t=e.target.value,n=m(t);x(n),T(t)},onBlur:P,onKeyDown:function(e){"Enter"!==e.key||N||W()},"aria-invalid":N,"aria-label":L("action.rename")}):a.a.createElement(a.a.Fragment,null,a.a.createElement(u.a,{role:"tab",ariaSelected:I,ariaLabel:E,className:"sheet-label",onClick:function(e){return o(e,E,S)},title:E,label:E,useI18String:!1,disabled:j}),a.a.createElement("div",{className:"sheet-options"},a.a.createElement(A,{id:null==E?void 0:E.replace(/\s+/g,"-").toLowerCase(),label:E,sheetCount:c,onToggle:function(e){return t=e,n=S,s(null),x(!1),void d(t,n);var t,n},handleClick:function(e,t,n){if("Rename"===n)T(a=t),x(!1),s(a);else if("Delete"===n){if(y)return g(E);var r={message:L("warning.sheetTabDeleteMessage.message"),title:L("warning.sheetTabDeleteMessage.title"),confirmBtnText:L("action.ok"),secondaryBtnText:L("action.cancel"),onConfirm:function(){g(E)}};B(h.a.showWarningMessage(r))}var a},disabled:v}))),a.a.createElement("div",{className:O()({active:I,"no-left-border":b,disabled:j},"sheet-tab")},a.a.createElement("div",{className:O()({"input-mode":f},"tab-body")},_))};x.propTypes=N;var L=a.a.memo(x),M=(n(1824),n(606));function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var P=function(e){var t,n=e.tabs,o=void 0===n?[]:n,h=e.activeSheetIndex,v=void 0===h?0:h,g=e.setActiveSheet,p=e.createNewSheet,S=e.deleteSheet,O=e.renameSheet,E=e.checkIsSheetNameDuplicated,j=e.skipDeleteWarning,I=void 0!==j&&j,k=(null===(t=o.find((function(e){return e.sheetIndex===v})))||void 0===t?void 0:t.name)||"",w=Object(c.a)().width,T=Object(r.useMemo)((function(){return Math.floor((w-80)/170)}),[w]),A=Object(l.a)().t,C=B(Object(r.useState)(""),2),D=C[0],R=C[1],N=Object(i.e)(m.a.getSpreadsheetEditorEditMode)===b.h.VIEW_ONLY,x=function(e,t){R(null),g(e,t)},F=function(e,t,n){e.preventDefault(),e.stopPropagation(),x(t,n)},P=B(Object(r.useMemo)((function(){return[o.slice(0,T),o.slice(T)]}),[o,T]),2),W=P[0],_=P[1],U=Object(r.useRef)(),q=Object(M.a)(U,[W,D]).currentFocusIndex,H=W.map((function(e,t){return a.a.createElement(L,{key:e.sheetIndex,sheet:e,sheetCount:o.length,activeSheetLabel:k,onClick:F,isEditMode:D===e.name,setLabelBeingEdited:R,setActiveSheet:g,deleteSheet:S,renameSheet:O,noRightBorder:o[e.sheetIndex+1]&&o[e.sheetIndex+1].name===k,checkIsSheetNameDuplicated:E,isReadOnlyMode:N,skipDeleteWarning:I,tabIndex:q===t?0:-1})})),V=Object(r.useMemo)((function(){return _.some((function(e){return e.name===k}))}),[_,k]);return a.a.createElement("div",{className:"SpreadsheetSwitcher ModularHeader BottomHeader stroke start"},a.a.createElement("div",{className:"GenericFileTab",role:"tablist",ref:U},H,(null==_?void 0:_.length)>0?a.a.createElement(s.a,{className:"dropdown-menu tab-dropdown-button",dataElement:"tabTrigger",title:A("message.showMore"),toggleElement:f.a.ADDITIONAL_SPREADSHEET_TABS_MENU,label:_.length.toString()},V&&a.a.createElement(d.a,{glyph:"icon-active-indicator"})):null,a.a.createElement(u.a,{className:"add-sheet-tab",title:"action.addSheet",img:"icon-menu-add",onClick:p,dataElement:"addTabButton",label:"",ariaLabel:A("action.addSheet"),disabled:N}),(null==_?void 0:_.length)>0&&a.a.createElement(y,{id:f.a.ADDITIONAL_SPREADSHEET_TABS_MENU,additionalTabs:_,tabsForReference:o,onClick:x,activeItem:k})))};P.propTypes={tabs:g.a.arrayOf(g.a.shape({name:g.a.string,sheetIndex:g.a.number,disabled:g.a.bool})),activeSheetIndex:g.a.number,setActiveSheet:g.a.func,createNewSheet:g.a.func,deleteSheet:g.a.func,renameSheet:g.a.func,skipDeleteWarning:g.a.bool,checkIsSheetNameDuplicated:g.a.func};var W=P,_=n(196);function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=U(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==U(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var J="SpreadsheetEditorDocument is not loaded",G=1;function K(e){var t=Object(o.a)().core,n=Object(l.a)().t,i=$(Object(r.useState)([]),2),c=i[0],u=i[1],s=$(Object(r.useState)(0),2),d=s[0],f=s[1];Object(r.useEffect)((function(){var e=function(e){u(e.getVisibleSheets()),f(e.getActiveSheetIndex())},n=function(e){f(e.getSheetIndex())},r=function(){var e=t.getDocumentViewer().getDocument().getSpreadsheetEditorDocument().getWorkbook();e&&u(function(e){for(var t=e.sheetCount,n=[],r=0;r<t;r++){var a=e.getSheetAt(r);e.isSheetHidden(a.name)||n.push({name:a.name,sheetIndex:r})}return n}(e))};return t.addEventListener("activeSheetChanged",n),t.addEventListener("spreadsheetEditorReady",r),t.addEventListener("sheetChanged",e),function(){t.removeEventListener("sheetChanged",e),t.removeEventListener("spreadsheetEditorReady",r),t.removeEventListener("activeSheetChanged",n)}}),[]);var b=Object(r.useCallback)((function(){u([]),f(0)}),[]);Object(_.a)(b);var m=Object(C.a)((function(e){var n,r,a=null===(n=t.getDocument())||void 0===n||null===(r=n.getSpreadsheetEditorDocument())||void 0===r?void 0:r.getWorkbook();if(!a)return console.error(J);a.getSheet(e)&&a.removeSheet(e)}),"addTabButton"),h=H(H({},e),{},{tabs:c,activeSheetIndex:d,setActiveSheet:function(e,n){var r,a,o=null===(r=t.getDocument())||void 0===r||null===(a=r.getSpreadsheetEditorDocument())||void 0===a?void 0:a.getWorkbook();if(!o)return console.error(J);o.getSheetAt(n)&&(o.setActiveSheet(n),f(n))},createNewSheet:function(){var e,r,a=null===(e=t.getDocument())||void 0===e||null===(r=e.getSpreadsheetEditorDocument())||void 0===r?void 0:r.getWorkbook();if(!a)return console.error(J);for(;a.getSheet("".concat(n("spreadsheetEditor.blankSheet")).concat(G));)G++;var o="".concat(n("spreadsheetEditor.blankSheet")).concat(G);a.createSheet(o)},deleteSheet:m,renameSheet:function(e,n){var r,a,o=null===(r=t.getDocument())||void 0===r||null===(a=r.getSpreadsheetEditorDocument())||void 0===a?void 0:a.getWorkbook();if(!o)return console.error(J);var i=o.getSheet(e);i&&(i.name=n)},checkIsSheetNameDuplicated:function(e){var n,r;return(null===(n=t.getDocument())||void 0===n||null===(r=n.getSpreadsheetEditorDocument())||void 0===r?void 0:r.getWorkbook())?function(e,t,n){var r=n.toLowerCase();return e.some((function(e){return e.name.toLowerCase()===r&&e.sheetIndex!==t.sheetIndex}))}(c,c[d],e):(console.error(J),!1)}});return a.a.createElement(W,h)}K.propTypes={};var z=K;t.default=z}}]);
//# sourceMappingURL=chunk.53.js.map