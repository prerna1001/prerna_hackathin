{"version":3,"sources":["webpack:///./src/ui/src/components/HeaderFooterControlsOverlay/HeaderFooterControlsBar/HeaderFooterControlsBar.scss?d40a","webpack:///./src/ui/src/components/HeaderFooterControlsOverlay/HeaderFooterControlsBar/HeaderFooterControlsBar.js","webpack:///./src/ui/src/components/HeaderFooterControlsOverlay/HeaderFooterControlsBar/index.js","webpack:///./src/ui/src/components/HeaderFooterControlsOverlay/HeaderFooterControlsOverlay.js","webpack:///./src/ui/src/components/HeaderFooterControlsOverlay/index.js"],"names":["module","exports","e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","enumerable","configurable","writable","_invoke","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_slicedToArray","Array","isArray","_arrayWithHoles","next","push","_iterableToArrayLimit","_arrayLikeToArray","toString","slice","constructor","name","from","test","_unsupportedIterableToArray","_nonIterableRest","propTypes","type","PropTypes","oneOf","pageNumber","number","isActive","bool","MOUSE_EVENTS_TYPES","HeaderFooterControlsBar","_ref","core","useCore","useTranslation","dispatch","useDispatch","doc","getDocument","officeEditor","getOfficeEditor","blockerRef","useRef","dropdownId","concat","barId","_useState2","useState","containerStyle","setContainerStyle","_useState4","sectionNumber","setSectionNumber","_useState6","headerType","setHeaderType","_useState8","footerType","setFooterType","_useState0","optionsDisabled","setOptionsDisabled","_useState10","showHeaderBar","setShowHeaderBar","_useState12","showFooterBar","setShowFooterBar","barClassName","useMemo","showBar","classNames","getHeaderFooterTop","_blockerRef$current","heightOfBar","current","clientHeight","getHeaderPosition","getFooterPosition","updateHeaderFooterSectionNumber","_ref2","_callee","_context","getSectionNumber","useEffect","_callee2","onBarClick","onHeaderFooterUpdated","updateHeaderFooterTop","onEditModeUpdated","_context2","event","actions","closeElements","DataElements","CONTEXT_MENU_POPUP","stopPropagation","forEach","eventType","addEventListener","top","editMode","isReadOnlyMode","OfficeEditorEditMode","VIEW_ONLY","PREVIEW","headerFooterStyle","HEADER_FOOTER_BAR_DEFAULT_POSITION","bottom","getInitialHeaderFooterStyle","_blockerRef$current2","removeEventListener","onLayoutChange","source","EditOperationSource","HEADER_FOOTER","getHeaderPageType","getFooterPageType","handlePageOptionsClick","_ref4","_callee3","_context3","HeaderFooterModalState","setPageNumber","openElement","HEADER_FOOTER_OPTIONS_MODAL","dropdownItems","label","key","icon","onClick","removeHeaders","removeFooters","onClickItem","_ref5","_callee4","itemKey","item","_context4","find","_x","sectionType","barLabelKey","sectionLabel","barLabel","buttonLabel","buttonLabelId","React","createElement","className","id","style","ref","Dropdown","width","renderItem","Fragment","Icon","glyph","getKey","items","displayButton","isOpen","ActionButton","ariaLabelledby","ariaControls","ariaExpanded","img","disabled","VisuallyHiddenLabel","labelledById","stopPropagationOnMouseDown","memo","visiblePages","arrayOf","isHeaderControlsActive","isFooterControlsActive","HeaderFooterControlsOverlay","portals","map","pageSection","getRootNode","getElementById","createPortal"],"mappings":"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","file":"chunks/chunk.52.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"LEFT_HEADER_WIDTH\":\"41px\",\"RIGHT_HEADER_WIDTH\":\"41px\"};","import React, { useEffect, useMemo, useRef, useState } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport Icon from 'components/Icon';\nimport ActionButton from 'components/ActionButton';\nimport VisuallyHiddenLabel from 'components/VisuallyHiddenLabel';\nimport PropTypes from 'prop-types';\nimport actions from 'actions';\nimport DataElements from 'constants/dataElement';\nimport Dropdown from 'components/Dropdown';\nimport classNames from 'classnames';\nimport useCore from 'hooks/useCore';\nimport HeaderFooterModalState from 'helpers/headerFooterModalState';\nimport { HEADER_FOOTER_BAR_DEFAULT_POSITION, OfficeEditorEditMode, EditOperationSource } from 'constants/officeEditor';\n\nimport './HeaderFooterControlsBar.scss';\n\nconst propTypes = {\n  type: PropTypes.oneOf(['header', 'footer']),\n  pageNumber: PropTypes.number,\n  isActive: PropTypes.bool,\n};\n\nconst MOUSE_EVENTS_TYPES = [\n  'click',\n  'mousedown',\n  'mouseup',\n  'mousemove',\n  'mouseenter',\n  'mouseleave',\n  'contextmenu',\n];\n\nconst HeaderFooterControlsBar = ({ type, pageNumber, isActive }) => {\n  const { core } = useCore();\n  const [t] = useTranslation();\n  const dispatch = useDispatch();\n  const doc = core.getDocument();\n  const officeEditor = doc.getOfficeEditor();\n  const blockerRef = useRef();\n  const dropdownId = `${type}-options-dropdown-${pageNumber}`;\n  const barId = `${type}-edit-ui-${pageNumber}`;\n\n  const [containerStyle, setContainerStyle] = useState({});\n  const [sectionNumber, setSectionNumber] = useState(null);\n  const [headerType, setHeaderType] = useState(0); // 0 is default for header type all\n  const [footerType, setFooterType] = useState(0); // 0 is default for footer type all\n  const [optionsDisabled, setOptionsDisabled] = useState(false);\n  const [showHeaderBar, setShowHeaderBar] = useState(false);\n  const [showFooterBar, setShowFooterBar] = useState(false);\n\n  const barClassName = useMemo(() => {\n    const showBar = type === 'header' ? showHeaderBar : showFooterBar;\n    return classNames(\n      'header-footer-edit-ui',\n      `${type}-edit-ui`,\n      {\n        'active': isActive && showBar,\n      }\n    );\n  }, [type, isActive, showHeaderBar, showFooterBar]);\n\n  const getHeaderFooterTop = () => {\n    const heightOfBar = blockerRef.current?.clientHeight || 0;\n    switch (type) {\n      case 'header':\n        return officeEditor.getHeaderPosition(pageNumber);\n      case 'footer':\n        return officeEditor.getFooterPosition(pageNumber) - heightOfBar;\n      default:\n        return 0;\n    }\n  };\n\n  const updateHeaderFooterSectionNumber = async () => {\n    const sectionNumber = await officeEditor.getSectionNumber(pageNumber);\n    setSectionNumber(sectionNumber);\n  };\n\n  useEffect(async () => {\n    // This stops the cursor from moving when the user clicks on the bar\n    const onBarClick = (event) => {\n      if (event.type === 'mousedown') {\n        dispatch(actions.closeElements([DataElements.CONTEXT_MENU_POPUP]));\n      }\n      event.stopPropagation();\n    };\n\n    MOUSE_EVENTS_TYPES.forEach((eventType) => {\n      blockerRef.current.addEventListener(eventType, onBarClick);\n    });\n\n    const onHeaderFooterUpdated = () => {\n      updateHeaderFooterTop();\n      updateHeaderFooterSectionNumber();\n    };\n\n    const updateHeaderFooterTop = () => {\n      const top = getHeaderFooterTop();\n      if (top > 0) {\n        // Sometimes the headerTop is 0 when the data isn't loaded.\n        // In this case just ignore it and wait for the next event to update the position\n        setContainerStyle({ top });\n      }\n    };\n\n    doc.addEventListener('headerFooterUpdated', onHeaderFooterUpdated);\n\n    const onEditModeUpdated = (editMode) => {\n      const isReadOnlyMode = editMode === OfficeEditorEditMode.VIEW_ONLY || editMode === OfficeEditorEditMode.PREVIEW;\n      setOptionsDisabled(isReadOnlyMode);\n    };\n    doc.addEventListener('editModeUpdated', onEditModeUpdated);\n\n    const getInitialHeaderFooterStyle = () => {\n      const headerFooterStyle = type === 'header' ? { top: HEADER_FOOTER_BAR_DEFAULT_POSITION } : { bottom: HEADER_FOOTER_BAR_DEFAULT_POSITION };\n      const top = getHeaderFooterTop();\n      return top > 0 ? { top } : headerFooterStyle;\n    };\n    setContainerStyle(getInitialHeaderFooterStyle());\n\n    return () => {\n      MOUSE_EVENTS_TYPES.forEach((eventType) => {\n        blockerRef.current?.removeEventListener(eventType, onBarClick);\n      });\n\n      doc.removeEventListener('headerFooterUpdated', onHeaderFooterUpdated);\n      doc.removeEventListener('editModeUpdated', onEditModeUpdated);\n    };\n  }, [isActive]);\n\n  useEffect(() => {\n    const onLayoutChange = (e) => {\n      if (e.source !== EditOperationSource.HEADER_FOOTER) {\n        return;\n      }\n      const headerType = officeEditor.getHeaderPageType(pageNumber);\n      const footerType = officeEditor.getFooterPageType(pageNumber);\n      if (headerType !== -1) {\n        setShowHeaderBar(true);\n        setHeaderType(headerType);\n      }\n      if (footerType !== -1) {\n        setShowFooterBar(true);\n        setFooterType(footerType);\n      }\n    };\n    doc.addEventListener('officeDocumentEdited', onLayoutChange);\n    return () => {\n      doc.removeEventListener('officeDocumentEdited', onLayoutChange);\n    };\n  }, [pageNumber]);\n\n  useEffect(() => {\n    updateHeaderFooterSectionNumber();\n    const headerType = officeEditor.getHeaderPageType(pageNumber);\n    const footerType = officeEditor.getFooterPageType(pageNumber);\n    if (headerType !== -1) {\n      setShowHeaderBar(true);\n      setHeaderType(headerType);\n    }\n    if (footerType !== -1) {\n      setShowFooterBar(true);\n      setFooterType(footerType);\n    }\n  }, [isActive, pageNumber]);\n\n  const handlePageOptionsClick = async () => {\n    HeaderFooterModalState.setPageNumber(pageNumber);\n    dispatch(actions.openElement(DataElements.HEADER_FOOTER_OPTIONS_MODAL));\n  };\n\n  const handleRemoveHeaderFooterOnClick = () => {\n    if (type === 'header') {\n      return officeEditor.removeHeaders(pageNumber);\n    }\n    if (type === 'footer') {\n      return officeEditor.removeFooters(pageNumber);\n    }\n  };\n\n  const renderDropdownItem = (item) => (\n    <>\n      <Icon glyph={item.icon} className='Dropdown__item-icon' />\n      <div className='Dropdown__item-vertical'>\n        <div className='Dropdown__item-label'>{t(item.label)}</div>\n      </div>\n      {item.key === 'page-options' && <div className='Divider'></div>}\n    </>\n  );\n\n\n  const dropdownItems = [\n    {\n      label: t('officeEditor.pageOptions'),\n      key: 'page-options',\n      icon: 'ic-edit-page',\n      onClick: handlePageOptionsClick,\n    },\n    {\n      label: type === 'header' ? t('officeEditor.removeHeader') : t('officeEditor.removeFooter'),\n      key: `remove-${type}`,\n      icon: 'ic-delete-page',\n      onClick: handleRemoveHeaderFooterOnClick,\n    },\n  ];\n\n  const onClickItem = async (itemKey) => {\n    const item = dropdownItems.find((item) => item.key === itemKey);\n    await item?.onClick();\n  };\n\n  const sectionType = type === 'header' ? headerType : footerType;\n  const barLabelKey = `officeEditor.${type}.${sectionType}`;\n  const sectionLabel = sectionNumber ? ` - ${t('officeEditor.section')} ${sectionNumber}` : '';\n  const barLabel = `${t(barLabelKey)}${sectionLabel}`;\n  const buttonLabel = `${barLabel} ${t('officeEditor.options')}`;\n  const buttonLabelId = `${dropdownId}-label`;\n\n  const renderDropdownButton = (isOpen) => (\n    <>\n      <ActionButton\n        className='options-button'\n        ariaLabelledby={buttonLabelId}\n        ariaControls={`${dropdownId}-dropdown`}\n        ariaExpanded={isOpen}\n        img={'icon-chevron-down'}\n        label={t('officeEditor.options')}\n        isActive={isOpen}\n        disabled={optionsDisabled}\n      />\n      <VisuallyHiddenLabel\n        id={buttonLabelId}\n        label={buttonLabel}\n      />\n    </>\n  );\n\n  return (\n    <div className={barClassName} id={barId} style={containerStyle}>\n      <div className='box-shadow-div' ref={blockerRef}></div>\n      <div className='label'>{barLabel}</div>\n\n      <Dropdown\n        width='auto'\n        id={dropdownId}\n        renderItem={renderDropdownItem}\n        className='options-dropdown-container'\n        getKey={(item) => item.key}\n        items={dropdownItems}\n        onClickItem={onClickItem}\n        displayButton={renderDropdownButton}\n        labelledById={buttonLabelId}\n        stopPropagationOnMouseDown={true}\n        disabled={optionsDisabled}\n      />\n    </div>\n  );\n};\n\nHeaderFooterControlsBar.propTypes = propTypes;\n\nexport default React.memo(HeaderFooterControlsBar);\n","import HeaderFooterControlsBar from './HeaderFooterControlsBar';\n\nexport default HeaderFooterControlsBar;\n","import React from 'react';\nimport { createPortal } from 'react-dom';\nimport getRootNode from 'src/helpers/getRootNode';\nimport HeaderFooterControlsBar from './HeaderFooterControlsBar';\nimport PropTypes from 'prop-types';\n\nimport './HeaderFooterControlsOverlay.scss';\n\nconst propTypes = {\n  visiblePages: PropTypes.arrayOf(PropTypes.number),\n  isHeaderControlsActive: PropTypes.bool,\n  isFooterControlsActive: PropTypes.bool,\n};\n\nconst HeaderFooterControlsOverlay = ({ visiblePages, isHeaderControlsActive, isFooterControlsActive }) => {\n  const portals = visiblePages.map((pageNumber) => {\n    const pageSection = getRootNode().getElementById(`pageSection${pageNumber}`);\n    if (!pageSection) {\n      return null;\n    }\n\n    return createPortal(\n      <div key={pageNumber} className='HeaderFooterControlsOverlay'>\n        <HeaderFooterControlsBar type='header' pageNumber={pageNumber} isActive={isHeaderControlsActive} />\n        <HeaderFooterControlsBar type='footer' pageNumber={pageNumber} isActive={isFooterControlsActive} />\n      </div>,\n      pageSection\n    );\n  });\n\n  return (\n    <>\n      {portals}\n    </>\n  );\n};\n\nHeaderFooterControlsOverlay.propTypes = propTypes;\n\nexport default HeaderFooterControlsOverlay;\n","import HeaderFooterControlsOverlay from './HeaderFooterControlsOverlay';\n\nexport default HeaderFooterControlsOverlay;\n"],"sourceRoot":""}