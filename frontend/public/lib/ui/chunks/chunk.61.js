(window.webpackJsonpWebViewerUI=window.webpackJsonpWebViewerUI||[]).push([[61],{1751:function(e,t,n){e.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1882:function(e,t,n){"use strict";n.r(t);n(9),n(10),n(14),n(31),n(38),n(36),n(27),n(21),n(20),n(12),n(22),n(32),n(18),n(16),n(29),n(47),n(23),n(46),n(48),n(37),n(8),n(17),n(19),n(11),n(30),n(13),n(94);var o=n(0),a=n.n(o),i=n(15),r=n.n(i),c=n(185),l=n.n(c),u=n(6),f=n(326),m=n(307),E=n(82),s=n(1676),d=n(53),O=n(148),b=n(99),g=n(2),p=n(3),T=n(33),C=n(45),h=n(63),_=n(24),y=n(5),v=n(76);n(1751);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=j(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=j(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==j(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,i,r,c=[],l=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(o=i.call(n)).done)&&(c.push(o.value),c.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var R=function(e){var t=e.dataElement,n=e.onClick,o=e.img,i=e.title,c=e.shortcut,l=void 0===c?"":c,f=e.disabled,E=void 0!==f&&f,s=k(Object(m.a)(),1)[0],O=Object(u.d)();return a.a.createElement("div",{className:r()("office-action-item",{disabled:E}),onClick:function(e){E||(n(),O(g.a.closeElement(y.a.CONTEXT_MENU_POPUP))),e.stopPropagation()},tabIndex:E?-1:0,"data-element":t,onKeyDown:function(e){"Enter"!==e.key||E||(n(),O(g.a.closeElement(y.a.CONTEXT_MENU_POPUP)))}},a.a.createElement("div",{className:"icon-title"},o&&a.a.createElement(d.a,{glyph:o,disabled:E}),!o&&a.a.createElement("span",{className:"Icon"}),a.a.createElement("div",null,s(i))),a.a.createElement("div",{className:"shortcut"},l))},F=function(e){var t=e.clickPosition,n=Object(T.a)().core,i=Object(u.e)((function(e){return p.a.isElementOpen(e,y.a.CONTEXT_MENU_POPUP)})),c=Object(u.e)((function(e){return p.a.isElementDisabled(e,y.a.CONTEXT_MENU_POPUP)})),d=Object(u.e)(p.a.isRightClickAnnotationPopupEnabled),j=Object(u.e)(p.a.isMultiViewerMode),P=Object(u.e)(p.a.getActiveDocumentViewerKey),N=Object(u.e)(p.a.isCursorInTable),w=Object(u.e)(p.a.isSpreadsheetEditorModeEnabled),F=Object(u.e)(p.a.getSpreadsheetEditorEditMode),S=F===v.h.VIEW_ONLY,x=k(Object(o.useState)(w&&S),2),D=x[0],U=x[1],A=k(Object(m.a)(),1)[0],M=Object(u.d)(),L=Object(u.f)(),H=k(Object(o.useState)({left:0,top:0}),2),B=H[0],W=H[1],V=Object(o.useRef)(),X=!!C.l||Object(C.k)();Object(O.a)(V,(function(){M(g.a.closeElement(y.a.CONTEXT_MENU_POPUP))})),Object(o.useEffect)((function(){i&&M(g.a.closeElements([y.a.ANNOTATION_POPUP,y.a.TEXT_POPUP,y.a.INLINE_COMMENT_POPUP]))}),[i]),Object(o.useEffect)((function(){var e=F===v.h.VIEW_ONLY;U(w&&e)}),[w,F]),Object(o.useLayoutEffect)((function(){if(!D){var e=V.current.getBoundingClientRect(),n=e.width,o=e.height,a=j?"#DocumentContainer".concat(P):".DocumentContainer",i=Object(_.a)().querySelector(a);if(i){var r=i.getBoundingClientRect(),c=Y(t,r,n,o),l=c.left,u=c.top;W({left:l,top:u})}}}),[t,j,P,D]);var Y=function(e,t,n,o){var a=e.left,i=e.top,r=G(),c=r.offsetLeft,l=r.offsetTop;a-=c+window.scrollX,i-=l+window.scrollY;return a<t.left-c&&(a=t.left+2-c),a+n>t.right-c&&(a=t.right-n-2-c),i<t.top-l&&(i=t.top+2-l),i+o>t.bottom-l&&(i=t.bottom-l-o-2),{left:a,top:i}},G=function(){var e=0,t=0;if(window.isApryseWebViewerWebComponent){var n,o=null===(n=Object(_.a)())||void 0===n?void 0:n.host,a=null==o?void 0:o.getBoundingClientRect();a&&(e=a.left,t=a.top,e+=o.scrollLeft,t+=o.scrollTop)}return{offsetLeft:e,offsetTop:t}},J=C.j?"⌘ Command":"Ctrl",K=C.j?"⌘Cmd":"Ctrl",q=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(C.c){var t=A(e?"officeEditor.pastingTitle":"officeEditor.pastingWithoutFormatTitle"),o=A(e?"officeEditor.pastingMessage":"officeEditor.pastingWithoutFormatMessage"),a="".concat(J,e?" + V":" + Shift + V"),i=A("action.close"),r={message:"".concat(o,":\n\n").concat(a),title:t,confirmBtnText:i,onConfirm:function(){setTimeout((function(){n.getViewerElement().focus()}))},onCancel:function(){setTimeout((function(){n.getViewerElement().focus()}))}};M(g.a.showWarningMessage(r))}else n.getOfficeEditor().pasteText(e)};if(c)return null;var z=a.a.createElement("div",{className:r()("Popup","ContextMenuPopup",{open:i,closed:!i,isOfficeEditor:Object(h.p)(),"is-vertical":d&&!Object(h.p)(),"is-horizontal":!d&&!Object(h.p)()}),ref:V,"data-element":y.a.CONTEXT_MENU_POPUP,style:I({},B),onClick:function(){return M(g.a.closeElement(y.a.CONTEXT_MENU_POPUP))}},a.a.createElement(f.a,{locked:i&&0!==B.top&&0!==B.left},a.a.createElement("div",{className:"container"},Object(h.p)()?a.a.createElement(a.a.Fragment,null,a.a.createElement(R,{title:"action.cut",img:"icon-cut",dataElement:y.a.OFFICE_EDITOR_CUT,onClick:function(){return n.getOfficeEditor().cutSelectedText()},shortcut:"".concat(K,"+X"),disabled:!n.getOfficeEditor().isTextSelected()}),a.a.createElement(R,{title:"action.copy",img:"icon-copy",dataElement:y.a.OFFICE_EDITOR_COPY,onClick:function(){return n.getOfficeEditor().copySelectedText()},shortcut:"".concat(K,"+C"),disabled:!n.getOfficeEditor().isTextSelected()}),a.a.createElement(R,{title:"action.paste",img:"icon-paste",dataElement:y.a.OFFICE_EDITOR_PASTE,onClick:function(){return q()},shortcut:"".concat(K,"+V")}),a.a.createElement(R,{title:"action.pasteWithoutFormatting",img:"icon-paste-without-formatting",dataElement:y.a.OFFICE_EDITOR_PASTE_WITHOUT_FORMATTING,onClick:function(){return q(!1)},shortcut:"".concat(K,"+Shift+V")}),!N&&a.a.createElement(R,{title:"action.delete",img:"icon-delete-line",dataElement:y.a.OFFICE_EDITOR_DELETE,onClick:function(){return n.getOfficeEditor().removeSelection()},disabled:!(n.getOfficeEditor().isTextSelected()||n.getOfficeEditor().isImageSelected())}),N&&a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"divider"}),a.a.createElement(R,{title:"officeEditor.insertRowAbove",dataElement:y.a.OFFICE_EDITOR_INSERT_ROW_ABOVE,onClick:function(){return n.getOfficeEditor().insertRows(1,!0)}}),a.a.createElement(R,{title:"officeEditor.insertRowBelow",dataElement:y.a.OFFICE_EDITOR_INSERT_ROW_BELOW,onClick:function(){return n.getOfficeEditor().insertRows(1,!1)}}),a.a.createElement(R,{title:"officeEditor.insertColumnRight",dataElement:y.a.OFFICE_EDITOR_INSERT_COLUMN_RIGHT,onClick:function(){return n.getOfficeEditor().insertColumns(1,!0)}}),a.a.createElement(R,{title:"officeEditor.insertColumnLeft",dataElement:y.a.OFFICE_EDITOR_INSERT_COLUMN_LEFT,onClick:function(){return n.getOfficeEditor().insertColumns(1,!1)}}),a.a.createElement(R,{title:"officeEditor.deleteRow",dataElement:y.a.OFFICE_EDITOR_DELETE_ROW,onClick:function(){return n.getOfficeEditor().removeRows()}}),a.a.createElement(R,{title:"officeEditor.deleteColumn",dataElement:y.a.OFFICE_EDITOR_DELETE_COLUMN,onClick:function(){return n.getOfficeEditor().removeColumns()}}),a.a.createElement(R,{title:"officeEditor.deleteTable",dataElement:y.a.OFFICE_EDITOR_DELETE_TABLE,onClick:function(){return n.getOfficeEditor().removeTable()}}))):a.a.createElement(s.a,{dataElement:y.a.CONTEXT_MENU_POPUP,childrenClassName:"main-menu-button"},a.a.createElement(E.a,{className:"main-menu-button",dataElement:"panToolButton",label:d?"tool.pan":"",title:d?"":"tool.pan",img:"icon-header-pan",onClick:function(){return Object(b.a)(L,"Pan")}}),a.a.createElement(E.a,{className:"main-menu-button",dataElement:"stickyToolButton",label:d?"annotation.stickyNote":"",title:d?"":"annotation.stickyNote",img:"icon-tool-comment-line",onClick:function(){return Object(b.a)(L,"AnnotationCreateSticky")}}),a.a.createElement(E.a,{className:"main-menu-button",dataElement:"highlightToolButton",label:d?"annotation.highlight":"",title:d?"":"annotation.highlight",img:"icon-tool-highlight",onClick:function(){return Object(b.a)(L,"AnnotationCreateTextHighlight")}}),a.a.createElement(E.a,{className:"main-menu-button",dataElement:"freeHandToolButton",label:d?"annotation.freehand":"",title:d?"":"annotation.freehand",img:"icon-tool-pen-line",onClick:function(){return Object(b.a)(L,"AnnotationCreateFreeHand")}}),a.a.createElement(E.a,{className:"main-menu-button",dataElement:"freeHandHighlightToolButton",label:d?"annotation.freeHandHighlight":"",title:d?"":"annotation.freeHandHighlight",img:"icon-tool-pen-highlight",onClick:function(){return Object(b.a)(L,"AnnotationCreateFreeHandHighlight")}}),a.a.createElement(E.a,{className:"main-menu-button",dataElement:"freeTextToolButton",label:d?"annotation.freetext":"",title:d?"":"annotation.freetext",img:"icon-tool-text-free-text",onClick:function(){return Object(b.a)(L,"AnnotationCreateFreeText")}}),a.a.createElement(E.a,{className:"main-menu-button",dataElement:"markInsertTextToolButton",label:d?"annotation.markInsertText":"",title:d?"":"annotation.markInsertText",img:"ic-insert text",onClick:function(){return Object(b.a)(L,"AnnotationCreateMarkInsertText")}}),a.a.createElement(E.a,{className:"main-menu-button",dataElement:"markReplaceTextToolButton",label:d?"annotation.markReplaceText":"",title:d?"":"annotation.markReplaceText",img:"ic-replace text",onClick:function(){return Object(b.a)(L,"AnnotationCreateMarkReplaceText")}})))));return D?null:C.e||X?z:a.a.createElement(l.a,{cancel:".Button, .cell, .sliders-container svg, select, button, input"},z)},S=a.a.memo(F);t.default=S}}]);
//# sourceMappingURL=chunk.61.js.map