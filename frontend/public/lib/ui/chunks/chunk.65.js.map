{"version":3,"sources":["webpack:///./src/ui/src/components/FilterAnnotModal/FilterAnnotModal.scss?94da","webpack:///./src/ui/src/components/FilterAnnotModal/FilterAnnotModal.js","webpack:///./src/ui/src/components/FilterAnnotModal/FilterAnnotModalContainer.js","webpack:///./src/ui/src/components/FilterAnnotModal/index.js"],"names":["module","exports","TABS_ID","FilterAnnotModal","_ref","isInFormBuilderMode","core","useCore","_useSelector2","_slicedToArray","useSelector","state","selectors","isElementDisabled","DataElements","FILTER_MODAL","isElementOpen","getColorMap","getSelectedTab","getAnnotationFilters","getIsMeasurementAnnotationFilterEnabled","getCustomNoteFilter","isDisabled","isOpen","colorMap","selectedTab","annotationFilters","isMeasurementAnnotationFilterEnabled","customNoteFilter","t","useTranslation","dispatch","useDispatch","_useState2","useState","authors","setAuthors","_useState4","annotTypes","setAnnotTypes","_useState6","colors","setColorTypes","_useState8","statuses","setStatusTypes","_useState0","authorFilter","setAuthorFilter","_useState10","typesFilter","setTypesFilter","_useState12","colorFilter","setColorFilter","_useState14","checkRepliesForAuthorFilter","setCheckRepliesForAuthorFilter","_useState16","isDocumentFilterActive","setIsDocumentFilterActive","_useState18","statusFilter","setStatusFilter","_useState20","filterCount","setFilterCount","_useState22","ifShowAnnotationStatus","setIfShowAnnotationStatus","getIconColor","annot","_colorMap$key","key","mapAnnotationToKey","iconColor","similarColorExist","currColors","newColor","colorObject","map","c","Object","assign","R","parseInt","concat","G","B","filter","Math","abs","length","filterApply","newFilter","documentViewerKey","arguments","undefined","type","author","color","status","isMeasurementAnnotation","IT","getCustomData","measurementKey","includes","getAnnotationClass","getDisplayAuthor","_step","allReplies","getReplies","_iterator","_createForOfIteratorHelper","s","n","done","reply","value","err","e","f","COMMON_COLORS","getStatus","actions","setInternalNoteFilter","setAnnotationFilters","includeReplies","typeFilter","redrawList","getDocumentViewers","forEach","documentViewer","index","getAnnotationManager","getAnnotationsList","window","Core","Annotations","WidgetAnnotation","shouldHide","NoView","push","drawAnnotationsFromList","fireEvent","Events","ANNOTATION_FILTER_CHANGED","types","closeModal","filterClear","closeElement","setToolMode","defaultTool","useEffect","clearAllFilters","addEventListener","removeEventListener","_ref2","annotLists","filteredList","filteredList2","annots","apply","_toConsumableArray","Hidden","authorsToBeAdded","Set","annotTypesToBeAdded","annotColorsToBeAdded","annotStatusesToBeAdded","displayAuthor","add","StickyAnnotation","isReply","Link","rgbaToHex","A","ANNOTATION_STATUS_FILTER_PANEL_BUTTON","setSelectedTab","ANNOTATION_USER_FILTER_PANEL_BUTTON","modalClass","classNames","Modal","open","closed","React","createElement","className","data-element","ModalWrapper","title","closeHandler","onCloseClick","swipeToClose","onMouseDown","stopPropagation","Tabs","id","Tab","dataElement","ANNOTATION_COLOR_FILTER_PANEL_BUTTON","ANNOTATION_TYPE_FILTER_PANEL_BUTTON","Fragment","TabPanel","val","Choice","aria-label","label","Tooltip","content","checked","onChange","indexOf","target","getAttribute","_val$toUpperCase","toUpperCase","call","hideOnClick","style","background","getHexToRgbaString","sort","type1","type2","toLocaleLowerCase","role","aria-labelledby","Button","onClick","disabled","propTypes","PropTypes","bool","FilterAnnotModalContainer","getFormFieldCreationManager","isInFormFieldCreationMode"],"mappings":"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","file":"chunks/chunk.65.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"LEFT_HEADER_WIDTH\":\"41px\",\"RIGHT_HEADER_WIDTH\":\"41px\"};","import React, { useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport useCore from 'hooks/useCore';\nimport actions from 'actions';\nimport selectors from 'selectors';\nimport PropTypes from 'prop-types';\nimport fireEvent from 'helpers/fireEvent';\nimport defaultTool from 'constants/defaultTool';\nimport Events from 'constants/events';\nimport { mapAnnotationToKey } from 'constants/map';\nimport DataElements from 'constants/dataElement';\nimport { rgbaToHex, getHexToRgbaString } from 'helpers/color';\nimport { getAnnotationClass } from 'helpers/getAnnotationClass';\nimport Choice from 'components/Choice';\nimport Button from 'components/Button';\nimport { Tabs, Tab, TabPanel } from 'components/Tabs';\nimport Tooltip from 'components/Tooltip';\nimport { COMMON_COLORS } from 'constants/commonColors';\nimport ModalWrapper from 'components/ModalWrapper';\n\nimport './FilterAnnotModal.scss';\n\nconst TABS_ID = 'filterAnnotModal';\n\nconst FilterAnnotModal = ({ isInFormBuilderMode }) => {\n  const { core } = useCore();\n  const [isDisabled, isOpen, colorMap, selectedTab, annotationFilters,\n    isMeasurementAnnotationFilterEnabled, customNoteFilter] = useSelector((state) => [\n    selectors.isElementDisabled(state, DataElements.FILTER_MODAL),\n    selectors.isElementOpen(state, DataElements.FILTER_MODAL),\n    selectors.getColorMap(state),\n    selectors.getSelectedTab(state, TABS_ID),\n    selectors.getAnnotationFilters(state),\n    selectors.getIsMeasurementAnnotationFilterEnabled(state),\n    selectors.getCustomNoteFilter(state),\n  ]);\n\n  const [t] = useTranslation();\n  const dispatch = useDispatch();\n\n  const [authors, setAuthors] = useState([]);\n  const [annotTypes, setAnnotTypes] = useState([]);\n  const [colors, setColorTypes] = useState([]);\n  const [statuses, setStatusTypes] = useState([]);\n  const [authorFilter, setAuthorFilter] = useState([]);\n  const [typesFilter, setTypesFilter] = useState([]);\n  const [colorFilter, setColorFilter] = useState([]);\n  const [checkRepliesForAuthorFilter, setCheckRepliesForAuthorFilter] = useState(true);\n  const [isDocumentFilterActive, setIsDocumentFilterActive] = useState(false);\n  const [statusFilter, setStatusFilter] = useState([]);\n  const [filterCount, setFilterCount] = useState(0);\n  const [ifShowAnnotationStatus, setIfShowAnnotationStatus] = useState(false);\n\n  const getIconColor = (annot) => {\n    const key = mapAnnotationToKey(annot);\n    const iconColorProperty = colorMap[key]?.iconColor;\n\n    return annot[iconColorProperty];\n  };\n\n  const similarColorExist = (currColors, newColor) => {\n    const colorObject = currColors.map((c) => Object.assign({\n      R: parseInt(`${c[1]}${c[2]}`, 16),\n      G: parseInt(`${c[3]}${c[4]}`, 16),\n      B: parseInt(`${c[5]}${c[6]}`, 16)\n    }));\n\n    const threshold = 10;\n    const similarColors = colorObject\n      .filter((c) => Math.abs(newColor.R - c.R) < threshold\n        && Math.abs(newColor.G - c.G) < threshold\n        && Math.abs(newColor.B - c.B) < threshold);\n\n    return !!similarColors.length;\n  };\n\n  const filterApply = () => {\n    const newFilter = (annot, documentViewerKey = 1) => {\n      let type = true;\n      let author = true;\n      let color = true;\n      let status = true;\n      if (typesFilter.length > 0) {\n        const isMeasurementAnnotation = annot.IT || annot.getCustomData('trn-is-count');\n        if (isMeasurementAnnotationFilterEnabled && isMeasurementAnnotation) {\n          const measurementKey = mapAnnotationToKey(annot);\n          type = typesFilter.includes(measurementKey);\n        } else {\n          type = typesFilter.includes(getAnnotationClass(annot));\n        }\n      }\n      if (authorFilter.length > 0) {\n        author = authorFilter.includes(core.getDisplayAuthor(annot['Author'], documentViewerKey));\n        if (!author && checkRepliesForAuthorFilter) {\n          const allReplies = annot.getReplies();\n          for (const reply of allReplies) {\n            // Short-circuit the search if at least one reply is created by\n            // one of the desired authors\n            if (authorFilter.includes(core.getDisplayAuthor(reply['Author'], documentViewerKey))) {\n              author = true;\n              break;\n            }\n          }\n        }\n      }\n      if (colorFilter.length > 0) {\n        const iconColor = getIconColor(annot);\n        if (iconColor) {\n          color = similarColorExist(colorFilter, iconColor);\n        } else {\n          // check for default color if no color is available\n          color = colorFilter.includes(COMMON_COLORS['gray8']);\n        }\n      }\n      if (statusFilter.length > 0) {\n        if (annot.getStatus()) {\n          status = statusFilter.includes(annot.getStatus());\n        } else {\n          status = statusFilter.includes('None');\n        }\n      }\n      return type && author && color && status;\n    };\n\n    dispatch(actions.setInternalNoteFilter(newFilter));\n    dispatch(actions.setAnnotationFilters({\n      isDocumentFilterActive,\n      includeReplies: checkRepliesForAuthorFilter,\n      authorFilter,\n      colorFilter,\n      typeFilter: typesFilter,\n      statusFilter\n    }));\n\n    const redrawList = [];\n    if (isDocumentFilterActive) {\n      core.getDocumentViewers().forEach((documentViewer, index) => documentViewer.getAnnotationManager()\n        .getAnnotationsList().forEach((annot) => {\n\n          // Do not hide widgets if filtering outside of form builder mode.\n          if (!isInFormBuilderMode && annot instanceof window.Core.Annotations.WidgetAnnotation) {\n            return;\n          }\n\n          const shouldHide = !newFilter(annot, index + 1);\n          if (shouldHide !== annot.NoView) {\n            annot.NoView = shouldHide;\n            redrawList.push(annot);\n          }\n        }));\n    } else {\n      core.getDocumentViewers().forEach((documentViewer) => documentViewer.getAnnotationManager()\n        .getAnnotationsList().forEach((annot) => {\n          if (annot.NoView === true) {\n            annot.NoView = false;\n            redrawList.push(annot);\n          }\n        }));\n    }\n    core.getDocumentViewers().forEach((documentViewer) => documentViewer.getAnnotationManager().drawAnnotationsFromList(redrawList));\n    fireEvent(\n      Events.ANNOTATION_FILTER_CHANGED,\n      {\n        types: typesFilter,\n        authors: authorFilter,\n        colors: colorFilter,\n        statuses: statusFilter,\n        checkRepliesForAuthorFilter\n      }\n    );\n    closeModal();\n  };\n\n  const filterClear = () => {\n    setCheckRepliesForAuthorFilter(false);\n    setIsDocumentFilterActive(false);\n    setAuthorFilter([]);\n    setTypesFilter([]);\n    setColorFilter([]);\n    setStatusFilter([]);\n\n    const redrawList = [];\n    core.getDocumentViewers().forEach((documentViewer) => documentViewer.getAnnotationManager().getAnnotationsList()\n      .forEach((annot) => {\n        if (annot.NoView === true) {\n          annot.NoView = false;\n          redrawList.push(annot);\n        }\n      }));\n    core.getDocumentViewers().forEach((documentViewer) => documentViewer.getAnnotationManager().drawAnnotationsFromList(redrawList));\n  };\n\n  const closeModal = () => {\n    dispatch(actions.closeElement(DataElements.FILTER_MODAL));\n    core.setToolMode(defaultTool);\n  };\n\n  useEffect(() => {\n    const clearAllFilters = () => {\n      filterClear();\n      filterApply();\n    };\n    core.addEventListener('documentUnloaded', clearAllFilters);\n    return () => {\n      core.removeEventListener('documentUnloaded', clearAllFilters);\n    };\n  }, []);\n\n  useEffect(() => {\n    let annotLists = core.getDocumentViewers().map((documentViewer) => documentViewer.getAnnotationManager().getAnnotationsList());\n\n    if (customNoteFilter) {\n      const filteredList = (annotLists[0]) ? annotLists[0].filter(customNoteFilter): [];\n      annotLists[0] = filteredList;\n      const filteredList2 = (annotLists[1]) ? annotLists[1].filter(customNoteFilter) : [];\n      annotLists[1] = filteredList2;\n    }\n\n    const annots = [].concat(...annotLists).filter((annot) => !annot.Hidden);\n    // set is a great way to remove any duplicate additions and ensure the unique items are present\n    // the only gotcha that it should not be used by state since not always it will trigger a rerender\n    const authorsToBeAdded = new Set();\n    const annotTypesToBeAdded = new Set();\n    const annotColorsToBeAdded = new Set();\n    const annotStatusesToBeAdded = new Set();\n    annots.forEach((annot) => {\n      const displayAuthor = core.getDisplayAuthor(annot['Author']);\n      if (displayAuthor && displayAuthor !== '') {\n        authorsToBeAdded.add(displayAuthor);\n      }\n\n      const ignoreFilter = (\n        (!isInFormBuilderMode && annot instanceof window.Core.Annotations.WidgetAnnotation) ||\n        (annot instanceof window.Core.Annotations.StickyAnnotation && annot.isReply()) ||\n        annot instanceof window.Core.Annotations.Link\n      );\n\n      if (ignoreFilter) {\n        return;\n      }\n\n      // If the annotation is also measurement, and the API is on, we want to instead add the measurement type\n      const isMeasurementAnnotation = annot.IT || annot.getCustomData('trn-is-count');\n      if (isMeasurementAnnotationFilterEnabled && isMeasurementAnnotation) {\n        const measurementKey = mapAnnotationToKey(annot);\n        annotTypesToBeAdded.add(measurementKey);\n      } else {\n        annotTypesToBeAdded.add(getAnnotationClass(annot));\n      }\n      const iconColor = getIconColor(annot);\n      if (iconColor && !similarColorExist([...annotColorsToBeAdded], iconColor)) {\n        annotColorsToBeAdded.add(rgbaToHex(iconColor.R, iconColor.G, iconColor.B, iconColor.A));\n      }\n\n      if (annot.getStatus()) {\n        annotStatusesToBeAdded.add(annot.getStatus());\n      } else {\n        annotStatusesToBeAdded.add('None');\n      }\n    });\n\n    setAuthors([...authorsToBeAdded]);\n    setAnnotTypes([...annotTypesToBeAdded]);\n    setColorTypes([...annotColorsToBeAdded]);\n    setStatusTypes([...annotStatusesToBeAdded]);\n\n    core.addEventListener('documentUnloaded', closeModal);\n    return () => {\n      core.removeEventListener('documentUnloaded', closeModal);\n    };\n  }, [isOpen, isMeasurementAnnotationFilterEnabled]);\n\n  useEffect(() => {\n    if (selectedTab === DataElements.ANNOTATION_STATUS_FILTER_PANEL_BUTTON && !ifShowAnnotationStatus) {\n      dispatch(actions.setSelectedTab(TABS_ID, DataElements.ANNOTATION_USER_FILTER_PANEL_BUTTON));\n    }\n  }, [isOpen, selectedTab, ifShowAnnotationStatus]);\n\n  useEffect(() => {\n    setFilterCount(\n      (checkRepliesForAuthorFilter ? 1 : 0) +\n      (isDocumentFilterActive ? 1 : 0) +\n      authorFilter.length +\n      colorFilter.length +\n      typesFilter.length +\n      statusFilter.length\n    );\n  }, [checkRepliesForAuthorFilter, isDocumentFilterActive, authorFilter, colorFilter, typesFilter, statusFilter]);\n\n  useEffect(() => {\n    setIfShowAnnotationStatus((statuses.length > 1) || (statuses.length === 1 && statuses[0] !== 'None'));\n  }, [statuses]);\n\n  useEffect(() => {\n    if (isOpen) {\n      setIsDocumentFilterActive(annotationFilters.isDocumentFilterActive);\n      setCheckRepliesForAuthorFilter(annotationFilters.includeReplies);\n      setAuthorFilter(annotationFilters.authorFilter);\n      setColorFilter(annotationFilters.colorFilter);\n      setTypesFilter(annotationFilters.typeFilter);\n      setStatusFilter(annotationFilters.statusFilter);\n    }\n  }, [isOpen]);\n\n  const renderAuthors = () => {\n    return (\n      <div className=\"user-filters three-column-filter\">\n        {[...authors].map((val, index) => {\n          return (\n            <Choice\n              type=\"checkbox\"\n              key={index}\n              aria-label={`${val} ${t('formField.types.checkbox')}`}\n              label={<Tooltip content={val}><div>{val}</div></Tooltip>}\n              checked={authorFilter.includes(val)}\n              id={val}\n              onChange={(e) => {\n                if (authorFilter.indexOf(e.target.getAttribute('id')) === -1) {\n                  setAuthorFilter([...authorFilter, e.target.getAttribute('id')]);\n                } else {\n                  setAuthorFilter(authorFilter.filter((author) => author !== e.target.getAttribute('id')));\n                }\n              }}\n            />\n          );\n        })}\n      </div>\n    );\n  };\n\n  const renderAnnotTypes = () => {\n    return (\n      <div className=\"type-filters three-column-filter\">\n        {[...annotTypes]\n          .sort((type1, type2) => (t(`annotation.${type1}`) <= t(`annotation.${type2}`) ? -1 : 1))\n          .map((val, index) => {\n            return (\n              <Choice\n                type=\"checkbox\"\n                key={index}\n                label={<Tooltip content={t(`annotation.${val}`)}><div>{t(`annotation.${val}`)}</div></Tooltip>}\n                checked={typesFilter.includes(val)}\n                id={val}\n                onChange={(e) => {\n                  if (typesFilter.indexOf(e.target.getAttribute('id')) === -1) {\n                    setTypesFilter([...typesFilter, e.target.getAttribute('id')]);\n                  } else {\n                    setTypesFilter(typesFilter.filter((type) => type !== e.target.getAttribute('id')));\n                  }\n                }}\n              />\n            );\n          })}\n      </div>\n    );\n  };\n\n  const renderColorTypes = () => {\n    return (\n      <div className=\"color-filters\">\n        {[...colors].map((val, index) => {\n          return (\n            <div className=\"colorSelect\" key={`color${index}`}>\n              <Tooltip content={`${t('option.colorPalette.colorLabel')} ${val?.toUpperCase?.()}`} hideOnClick={false}>\n                <Choice\n                  type=\"checkbox\"\n                  checked={colorFilter.includes(val)}\n                  aria-label={`${t('option.colorPalette.colorLabel')} ${val?.toUpperCase()} ${t('formField.types.checkbox')}`}\n                  id={val}\n                  onChange={(e) => {\n                    if (colorFilter.indexOf(e.target.getAttribute('id')) === -1) {\n                      setColorFilter([...colorFilter, e.target.getAttribute('id')]);\n                    } else {\n                      setColorFilter(colorFilter.filter((color) => color !== e.target.getAttribute('id')));\n                    }\n                  }}\n                />\n              </Tooltip>\n              <div className=\"colorCell\" style={{ background: getHexToRgbaString(val) }}></div>\n            </div>\n          );\n        })}\n      </div>\n    );\n  };\n\n  const renderStatusTypes = () => {\n    return (\n      <div className=\"status-filters three-column-filter\">\n        {[...statuses].map((val, index) => {\n          return (\n            <Choice\n              type=\"checkbox\"\n              key={index}\n              checked={statusFilter.includes(val)}\n              aria-label={`${val} ${t('formField.types.checkbox')}`}\n              label={t(`option.state.${val.toLocaleLowerCase()}`)}\n              id={val}\n              onChange={(e) => {\n                if (statusFilter.indexOf(e.target.getAttribute('id')) === -1) {\n                  setStatusFilter([...statusFilter, e.target.getAttribute('id')]);\n                } else {\n                  setStatusFilter(statusFilter.filter((status) => status !== e.target.getAttribute('id')));\n                }\n              }}\n            />\n          );\n        })}\n      </div>\n    );\n  };\n\n  const modalClass = classNames({\n    Modal: true,\n    FilterAnnotModal: true,\n    open: isOpen,\n    closed: !isOpen,\n  });\n\n  return isDisabled ? null : (\n    <div className={modalClass} data-element={DataElements.FILTER_MODAL}>\n      <ModalWrapper\n        isOpen={isOpen}\n        title={`${t('option.filterAnnotModal.filters')} (${filterCount})`}\n        closeHandler={closeModal}\n        onCloseClick={closeModal}\n        swipeToClose\n      >\n        <div className=\"container\" onMouseDown={(e) => e.stopPropagation()}>\n          {core.getAnnotationsList().length > 0 ? (\n            <div className=\"filter-modal\">\n              <div className=\"body\">\n                <Tabs id={TABS_ID}>\n                  <div className=\"tab-list\">\n                    <Tab dataElement={DataElements.ANNOTATION_USER_FILTER_PANEL_BUTTON}>\n                      <button className=\"tab-options-button\">\n                        {t('option.filterAnnotModal.user')}\n                      </button>\n                    </Tab>\n                    <div className=\"tab-options-divider\" />\n                    <Tab dataElement={DataElements.ANNOTATION_COLOR_FILTER_PANEL_BUTTON}>\n                      <button className=\"tab-options-button\">\n                        {t('option.filterAnnotModal.color')}\n                      </button>\n                    </Tab>\n                    <div className=\"tab-options-divider\" />\n                    <Tab dataElement={DataElements.ANNOTATION_TYPE_FILTER_PANEL_BUTTON}>\n                      <button className=\"tab-options-button\">\n                        {t('option.filterAnnotModal.type')}\n                      </button>\n                    </Tab>\n                    {ifShowAnnotationStatus && (\n                      <>\n                        <div className=\"tab-options-divider\" />\n                        <Tab dataElement={DataElements.ANNOTATION_STATUS_FILTER_PANEL_BUTTON}>\n                          <button className=\"tab-options-button\">\n                            {t('option.filterAnnotModal.status')}\n                          </button>\n                        </Tab>\n                      </>\n                    )}\n                  </div>\n                  <div className=\"filter-options\">\n                    <TabPanel dataElement=\"annotationUserFilterPanel\">\n                      {renderAuthors()}\n                    </TabPanel>\n                    <TabPanel dataElement=\"annotationColorFilterPanel\">\n                      {renderColorTypes()}\n                    </TabPanel>\n                    <TabPanel dataElement=\"annotationTypeFilterPanel\">\n                      {renderAnnotTypes()}\n                    </TabPanel>\n                    {ifShowAnnotationStatus && (\n                      <TabPanel dataElement=\"annotationStatusFilterPanel\">\n                        {renderStatusTypes()}\n                      </TabPanel>\n                    )}\n                  </div>\n                </Tabs>\n              </div>\n              <div className=\"divider\"></div>\n              <fieldset className=\"settings-body\">\n                <legend id=\"filter-settings\" className=\"settings-header\">{t('option.filterAnnotModal.filterSettings')}</legend>\n                <div className=\"settings\" role=\"group\" aria-labelledby='filter-settings'>\n                  <Choice\n                    label={t('option.filterAnnotModal.includeReplies')}\n                    checked={checkRepliesForAuthorFilter}\n                    onChange={(e) => setCheckRepliesForAuthorFilter(e.target.checked)}\n                    id=\"filter-annot-modal-include-replies\"\n                  />\n                  <Choice\n                    label={t('option.filterAnnotModal.filterDocument')}\n                    checked={isDocumentFilterActive}\n                    onChange={(e) => setIsDocumentFilterActive(e.target.checked)}\n                    id=\"filter-annot-modal-filter-document\"\n                  />\n                </div>\n              </fieldset>\n              <div className=\"divider\"></div>\n              <div className=\"footer\">\n                <Button className=\"filter-annot-clear\" onClick={filterClear} label={t('action.clearAll')}\n                  disabled={filterCount === 0} />\n                <Button className=\"filter-annot-apply\" onClick={filterApply} label={t('action.apply')} />\n              </div>\n            </div>\n          ) : (\n            <div>\n              <div className=\"swipe-indicator\" />\n              <div className=\"message\">{t('message.noAnnotationsFilter')}</div>\n            </div>\n          )}\n        </div>\n      </ModalWrapper>\n    </div>\n  );\n};\n\nFilterAnnotModal.propTypes = {\n  isInFormBuilderMode: PropTypes.bool,\n};\n\nexport default FilterAnnotModal;\n","import React from 'react';\nimport FilterAnnotModal from './FilterAnnotModal';\nimport useCore from 'hooks/useCore';\n\nfunction FilterAnnotModalContainer() {\n  const { core } = useCore();\n  const isInFormBuilderMode = core.getAnnotationManager().getFormFieldCreationManager().isInFormFieldCreationMode();\n  return <FilterAnnotModal isInFormBuilderMode={isInFormBuilderMode}/>;\n}\n\nexport default FilterAnnotModalContainer;","import FilterAnnotModalContainer from './FilterAnnotModalContainer';\n\nexport default FilterAnnotModalContainer;"],"sourceRoot":""}