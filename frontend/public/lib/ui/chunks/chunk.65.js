(window.webpackJsonpWebViewerUI=window.webpackJsonpWebViewerUI||[]).push([[65],{1770:function(e,t,n){e.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1872:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=(n(9),n(10),n(14),n(38),n(36),n(27),n(21),n(49),n(77),n(20),n(12),n(43),n(22),n(146),n(18),n(16),n(57),n(8),n(112),n(17),n(19),n(116),n(62),n(11),n(30),n(13),n(15)),i=n.n(r),c=n(6),l=n(307),s=n(33),u=n(2),d=n(3),f=n(1),m=n.n(f),b=n(51),g=n(68),E=n(52),p=n(56),A=n(5),v=n(174),h=n(265),N=n(106),y=n(44),O=n(141),T=n(120),F=n(107),w=n(383);n(1770);function S(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=j(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,r=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw r}}}}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,o,r,i,c=[],l=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=r.call(n)).done)&&(c.push(a.value),c.length!==t);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return c}}(e,t)||j(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(e){if("string"==typeof e)return M(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var _="filterAnnotModal",C=function(e){var t=e.isInFormBuilderMode,n=Object(s.a)().core,r=L(Object(c.e)((function(e){return[d.a.isElementDisabled(e,A.a.FILTER_MODAL),d.a.isElementOpen(e,A.a.FILTER_MODAL),d.a.getColorMap(e),d.a.getSelectedTab(e,_),d.a.getAnnotationFilters(e),d.a.getIsMeasurementAnnotationFilterEnabled(e),d.a.getCustomNoteFilter(e)]})),7),f=r[0],m=r[1],j=r[2],M=r[3],C=r[4],k=r[5],R=r[6],D=L(Object(l.a)(),1)[0],U=Object(c.d)(),x=L(Object(a.useState)([]),2),P=x[0],V=x[1],B=L(Object(a.useState)([]),2),H=B[0],G=B[1],W=L(Object(a.useState)([]),2),J=W[0],Y=W[1],$=L(Object(a.useState)([]),2),q=$[0],z=$[1],K=L(Object(a.useState)([]),2),Q=K[0],X=K[1],Z=L(Object(a.useState)([]),2),ee=Z[0],te=Z[1],ne=L(Object(a.useState)([]),2),ae=ne[0],oe=ne[1],re=L(Object(a.useState)(!0),2),ie=re[0],ce=re[1],le=L(Object(a.useState)(!1),2),se=le[0],ue=le[1],de=L(Object(a.useState)([]),2),fe=de[0],me=de[1],be=L(Object(a.useState)(0),2),ge=be[0],Ee=be[1],pe=L(Object(a.useState)(!1),2),Ae=pe[0],ve=pe[1],he=function(e){var t,n=Object(p.g)(e);return e[null===(t=j[n])||void 0===t?void 0:t.iconColor]},Ne=function(e,t){var n=e.map((function(e){return Object.assign({R:parseInt("".concat(e[1]).concat(e[2]),16),G:parseInt("".concat(e[3]).concat(e[4]),16),B:parseInt("".concat(e[5]).concat(e[6]),16)})}));return!!n.filter((function(e){return Math.abs(t.R-e.R)<10&&Math.abs(t.G-e.G)<10&&Math.abs(t.B-e.B)<10})).length},ye=function(){var e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=!0,o=!0,r=!0,i=!0;if(ee.length>0){var c=e.IT||e.getCustomData("trn-is-count");if(k&&c){var l=Object(p.g)(e);a=ee.includes(l)}else a=ee.includes(Object(h.a)(e))}if(Q.length>0&&!(o=Q.includes(n.getDisplayAuthor(e.Author,t)))&&ie){var s,u=e.getReplies(),d=I(u);try{for(d.s();!(s=d.n()).done;){var f=s.value;if(Q.includes(n.getDisplayAuthor(f.Author,t))){o=!0;break}}}catch(e){d.e(e)}finally{d.f()}}if(ae.length>0){var m=he(e);r=m?Ne(ae,m):ae.includes(F.b.gray8)}return fe.length>0&&(i=e.getStatus()?fe.includes(e.getStatus()):fe.includes("None")),a&&o&&r&&i};U(u.a.setInternalNoteFilter(e)),U(u.a.setAnnotationFilters({isDocumentFilterActive:se,includeReplies:ie,authorFilter:Q,colorFilter:ae,typeFilter:ee,statusFilter:fe}));var a=[];se?n.getDocumentViewers().forEach((function(n,o){return n.getAnnotationManager().getAnnotationsList().forEach((function(n){if(t||!(n instanceof window.Core.Annotations.WidgetAnnotation)){var r=!e(n,o+1);r!==n.NoView&&(n.NoView=r,a.push(n))}}))})):n.getDocumentViewers().forEach((function(e){return e.getAnnotationManager().getAnnotationsList().forEach((function(e){!0===e.NoView&&(e.NoView=!1,a.push(e))}))})),n.getDocumentViewers().forEach((function(e){return e.getAnnotationManager().drawAnnotationsFromList(a)})),Object(b.a)(E.a.ANNOTATION_FILTER_CHANGED,{types:ee,authors:Q,colors:ae,statuses:fe,checkRepliesForAuthorFilter:ie}),Te()},Oe=function(){ce(!1),ue(!1),X([]),te([]),oe([]),me([]);var e=[];n.getDocumentViewers().forEach((function(t){return t.getAnnotationManager().getAnnotationsList().forEach((function(t){!0===t.NoView&&(t.NoView=!1,e.push(t))}))})),n.getDocumentViewers().forEach((function(t){return t.getAnnotationManager().drawAnnotationsFromList(e)}))},Te=function(){U(u.a.closeElement(A.a.FILTER_MODAL)),n.setToolMode(g.a)};Object(a.useEffect)((function(){var e=function(){Oe(),ye()};return n.addEventListener("documentUnloaded",e),function(){n.removeEventListener("documentUnloaded",e)}}),[]),Object(a.useEffect)((function(){var e,a=n.getDocumentViewers().map((function(e){return e.getAnnotationManager().getAnnotationsList()}));if(R){var o=a[0]?a[0].filter(R):[];a[0]=o;var r=a[1]?a[1].filter(R):[];a[1]=r}var i=(e=[]).concat.apply(e,S(a)).filter((function(e){return!e.Hidden})),c=new Set,l=new Set,s=new Set,u=new Set;return i.forEach((function(e){var a=n.getDisplayAuthor(e.Author);if(a&&""!==a&&c.add(a),!(!t&&e instanceof window.Core.Annotations.WidgetAnnotation||e instanceof window.Core.Annotations.StickyAnnotation&&e.isReply()||e instanceof window.Core.Annotations.Link)){var o=e.IT||e.getCustomData("trn-is-count");if(k&&o){var r=Object(p.g)(e);l.add(r)}else l.add(Object(h.a)(e));var i=he(e);i&&!Ne(S(s),i)&&s.add(Object(v.e)(i.R,i.G,i.B,i.A)),e.getStatus()?u.add(e.getStatus()):u.add("None")}})),V(S(c)),G(S(l)),Y(S(s)),z(S(u)),n.addEventListener("documentUnloaded",Te),function(){n.removeEventListener("documentUnloaded",Te)}}),[m,k]),Object(a.useEffect)((function(){M!==A.a.ANNOTATION_STATUS_FILTER_PANEL_BUTTON||Ae||U(u.a.setSelectedTab(_,A.a.ANNOTATION_USER_FILTER_PANEL_BUTTON))}),[m,M,Ae]),Object(a.useEffect)((function(){Ee((ie?1:0)+(se?1:0)+Q.length+ae.length+ee.length+fe.length)}),[ie,se,Q,ae,ee,fe]),Object(a.useEffect)((function(){ve(q.length>1||1===q.length&&"None"!==q[0])}),[q]),Object(a.useEffect)((function(){m&&(ue(C.isDocumentFilterActive),ce(C.includeReplies),X(C.authorFilter),oe(C.colorFilter),te(C.typeFilter),me(C.statusFilter))}),[m]);var Fe=i()({Modal:!0,FilterAnnotModal:!0,open:m,closed:!m});return f?null:o.a.createElement("div",{className:Fe,"data-element":A.a.FILTER_MODAL},o.a.createElement(w.a,{isOpen:m,title:"".concat(D("option.filterAnnotModal.filters")," (").concat(ge,")"),closeHandler:Te,onCloseClick:Te,swipeToClose:!0},o.a.createElement("div",{className:"container",onMouseDown:function(e){return e.stopPropagation()}},n.getAnnotationsList().length>0?o.a.createElement("div",{className:"filter-modal"},o.a.createElement("div",{className:"body"},o.a.createElement(O.d,{id:_},o.a.createElement("div",{className:"tab-list"},o.a.createElement(O.a,{dataElement:A.a.ANNOTATION_USER_FILTER_PANEL_BUTTON},o.a.createElement("button",{className:"tab-options-button"},D("option.filterAnnotModal.user"))),o.a.createElement("div",{className:"tab-options-divider"}),o.a.createElement(O.a,{dataElement:A.a.ANNOTATION_COLOR_FILTER_PANEL_BUTTON},o.a.createElement("button",{className:"tab-options-button"},D("option.filterAnnotModal.color"))),o.a.createElement("div",{className:"tab-options-divider"}),o.a.createElement(O.a,{dataElement:A.a.ANNOTATION_TYPE_FILTER_PANEL_BUTTON},o.a.createElement("button",{className:"tab-options-button"},D("option.filterAnnotModal.type"))),Ae&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"tab-options-divider"}),o.a.createElement(O.a,{dataElement:A.a.ANNOTATION_STATUS_FILTER_PANEL_BUTTON},o.a.createElement("button",{className:"tab-options-button"},D("option.filterAnnotModal.status"))))),o.a.createElement("div",{className:"filter-options"},o.a.createElement(O.c,{dataElement:"annotationUserFilterPanel"},o.a.createElement("div",{className:"user-filters three-column-filter"},S(P).map((function(e,t){return o.a.createElement(N.a,{type:"checkbox",key:t,"aria-label":"".concat(e," ").concat(D("formField.types.checkbox")),label:o.a.createElement(T.a,{content:e},o.a.createElement("div",null,e)),checked:Q.includes(e),id:e,onChange:function(e){-1===Q.indexOf(e.target.getAttribute("id"))?X([].concat(S(Q),[e.target.getAttribute("id")])):X(Q.filter((function(t){return t!==e.target.getAttribute("id")})))}})})))),o.a.createElement(O.c,{dataElement:"annotationColorFilterPanel"},o.a.createElement("div",{className:"color-filters"},S(J).map((function(e,t){var n;return o.a.createElement("div",{className:"colorSelect",key:"color".concat(t)},o.a.createElement(T.a,{content:"".concat(D("option.colorPalette.colorLabel")," ").concat(null==e||null===(n=e.toUpperCase)||void 0===n?void 0:n.call(e)),hideOnClick:!1},o.a.createElement(N.a,{type:"checkbox",checked:ae.includes(e),"aria-label":"".concat(D("option.colorPalette.colorLabel")," ").concat(null==e?void 0:e.toUpperCase()," ").concat(D("formField.types.checkbox")),id:e,onChange:function(e){-1===ae.indexOf(e.target.getAttribute("id"))?oe([].concat(S(ae),[e.target.getAttribute("id")])):oe(ae.filter((function(t){return t!==e.target.getAttribute("id")})))}})),o.a.createElement("div",{className:"colorCell",style:{background:Object(v.a)(e)}}))})))),o.a.createElement(O.c,{dataElement:"annotationTypeFilterPanel"},o.a.createElement("div",{className:"type-filters three-column-filter"},S(H).sort((function(e,t){return D("annotation.".concat(e))<=D("annotation.".concat(t))?-1:1})).map((function(e,t){return o.a.createElement(N.a,{type:"checkbox",key:t,label:o.a.createElement(T.a,{content:D("annotation.".concat(e))},o.a.createElement("div",null,D("annotation.".concat(e)))),checked:ee.includes(e),id:e,onChange:function(e){-1===ee.indexOf(e.target.getAttribute("id"))?te([].concat(S(ee),[e.target.getAttribute("id")])):te(ee.filter((function(t){return t!==e.target.getAttribute("id")})))}})})))),Ae&&o.a.createElement(O.c,{dataElement:"annotationStatusFilterPanel"},o.a.createElement("div",{className:"status-filters three-column-filter"},S(q).map((function(e,t){return o.a.createElement(N.a,{type:"checkbox",key:t,checked:fe.includes(e),"aria-label":"".concat(e," ").concat(D("formField.types.checkbox")),label:D("option.state.".concat(e.toLocaleLowerCase())),id:e,onChange:function(e){-1===fe.indexOf(e.target.getAttribute("id"))?me([].concat(S(fe),[e.target.getAttribute("id")])):me(fe.filter((function(t){return t!==e.target.getAttribute("id")})))}})}))))))),o.a.createElement("div",{className:"divider"}),o.a.createElement("fieldset",{className:"settings-body"},o.a.createElement("legend",{id:"filter-settings",className:"settings-header"},D("option.filterAnnotModal.filterSettings")),o.a.createElement("div",{className:"settings",role:"group","aria-labelledby":"filter-settings"},o.a.createElement(N.a,{label:D("option.filterAnnotModal.includeReplies"),checked:ie,onChange:function(e){return ce(e.target.checked)},id:"filter-annot-modal-include-replies"}),o.a.createElement(N.a,{label:D("option.filterAnnotModal.filterDocument"),checked:se,onChange:function(e){return ue(e.target.checked)},id:"filter-annot-modal-filter-document"}))),o.a.createElement("div",{className:"divider"}),o.a.createElement("div",{className:"footer"},o.a.createElement(y.a,{className:"filter-annot-clear",onClick:Oe,label:D("action.clearAll"),disabled:0===ge}),o.a.createElement(y.a,{className:"filter-annot-apply",onClick:ye,label:D("action.apply")}))):o.a.createElement("div",null,o.a.createElement("div",{className:"swipe-indicator"}),o.a.createElement("div",{className:"message"},D("message.noAnnotationsFilter"))))))};C.propTypes={isInFormBuilderMode:m.a.bool};var k=C;var R=function(){var e=Object(s.a)().core.getAnnotationManager().getFormFieldCreationManager().isInFormFieldCreationMode();return o.a.createElement(k,{isInFormBuilderMode:e})};t.default=R}}]);
//# sourceMappingURL=chunk.65.js.map