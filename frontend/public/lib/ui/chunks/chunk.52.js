(window.webpackJsonpWebViewerUI=window.webpackJsonpWebViewerUI||[]).push([[52],{1742:function(e,t,n){e.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1743:function(e,t,n){},1858:function(e,t,n){"use strict";n.r(t);n(43),n(8);var r=n(0),o=n.n(r),a=n(123),i=n(24),c=(n(9),n(10),n(14),n(38),n(81),n(27),n(21),n(20),n(12),n(22),n(18),n(26),n(16),n(40),n(23),n(41),n(42),n(54),n(17),n(19),n(11),n(13),n(6)),u=n(307),l=n(53),f=n(82),s=n(254),d=n(1),p=n.n(d),v=n(2),m=n(5),b=n(72),y=n(15),E=n.n(y),h=n(33),g=n(1691),O=n(25);n(1742);function w(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return j(l,"_invoke",function(n,r,o){var a,c,u,l=0,f=o||[],s=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,c=0,u=e,d.n=n,i}};function p(n,r){for(c=n,u=r,t=0;!s&&l&&!o&&t<f.length;t++){var o,a=f[t],p=d.p,v=a[2];n>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<v&&(o=n<3||a[0]>r||r>v)&&(a[4]=n,a[5]=r,d.n=v,c=0))}if(o||n>1)return i;throw s=!0,r}return function(o,f,v){if(l>1)throw TypeError("Generator is already running");for(s&&1===f&&p(f,v),c=f,u=v;(t=c<2?e:u)||!s;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,u)))throw TypeError("iterator result is not an object");if(!t.done)return t;u=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(s=d.n<0)?u:n.call(r,d))!==i)break}catch(t){a=e,c=1,u=t}finally{l=1}}return{value:t,done:s}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}t=Object.getPrototypeOf;var f=[][r]?t(t([][r]())):(j(t={},r,(function(){return this})),t),s=l.prototype=c.prototype=Object.create(f);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,j(e,o,"GeneratorFunction")),e.prototype=Object.create(s),e}return u.prototype=l,j(s,"constructor",l),j(l,"constructor",u),u.displayName="GeneratorFunction",j(l,o,"GeneratorFunction"),j(s),j(s,o,"Generator"),j(s,r,(function(){return this})),j(s,"toString",(function(){return"[object Generator]"})),(w=function(){return{w:a,m:d}})()}function j(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}(j=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){j(e,t,(function(e){return this._invoke(t,n,e)}))};a("next",0),a("throw",1),a("return",2)}})(e,t,n,r)}function P(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function _(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){P(a,r,o,i,c,"next",e)}function c(e){P(a,r,o,i,c,"throw",e)}i(void 0)}))}}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return N(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var A={type:p.a.oneOf(["header","footer"]),pageNumber:p.a.number,isActive:p.a.bool},S=["click","mousedown","mouseup","mousemove","mouseenter","mouseleave","contextmenu"],F=function(e){var t=e.type,n=e.pageNumber,a=e.isActive,i=Object(h.a)().core,d=T(Object(u.a)(),1)[0],p=Object(c.d)(),y=i.getDocument(),j=y.getOfficeEditor(),P=Object(r.useRef)(),N="".concat(t,"-options-dropdown-").concat(n),A="".concat(t,"-edit-ui-").concat(n),F=T(Object(r.useState)({}),2),k=F[0],H=F[1],D=T(Object(r.useState)(null),2),I=D[0],C=D[1],L=T(Object(r.useState)(0),2),x=L[0],R=L[1],U=T(Object(r.useState)(0),2),G=U[0],M=U[1],W=T(Object(r.useState)(!1),2),V=W[0],B=W[1],J=T(Object(r.useState)(!1),2),K=J[0],X=J[1],Y=T(Object(r.useState)(!1),2),$=Y[0],q=Y[1],z=Object(r.useMemo)((function(){var e="header"===t?K:$;return E()("header-footer-edit-ui","".concat(t,"-edit-ui"),{active:a&&e})}),[t,a,K,$]),Q=function(){var e,r=(null===(e=P.current)||void 0===e?void 0:e.clientHeight)||0;switch(t){case"header":return j.getHeaderPosition(n);case"footer":return j.getFooterPosition(n)-r;default:return 0}},Z=function(){var e=_(w().m((function e(){var t;return w().w((function(e){for(;;)switch(e.n){case 0:return e.n=1,j.getSectionNumber(n);case 1:t=e.v,C(t);case 2:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)(_(w().m((function e(){var n,r,o,a;return w().w((function(e){for(;;)switch(e.n){case 0:return n=function(e){"mousedown"===e.type&&p(v.a.closeElements([m.a.CONTEXT_MENU_POPUP])),e.stopPropagation()},S.forEach((function(e){P.current.addEventListener(e,n)})),r=function(){o(),Z()},o=function(){var e=Q();e>0&&H({top:e})},y.addEventListener("headerFooterUpdated",r),a=function(e){var t=e===O.C.VIEW_ONLY||e===O.C.PREVIEW;B(t)},y.addEventListener("editModeUpdated",a),H(function(){var e="header"===t?{top:O.m}:{bottom:O.m},n=Q();return n>0?{top:n}:e}()),e.a(2,(function(){S.forEach((function(e){var t;null===(t=P.current)||void 0===t||t.removeEventListener(e,n)})),y.removeEventListener("headerFooterUpdated",r),y.removeEventListener("editModeUpdated",a)}))}}),e)}))),[a]),Object(r.useEffect)((function(){var e=function(e){if(e.source===O.j.HEADER_FOOTER){var t=j.getHeaderPageType(n),r=j.getFooterPageType(n);-1!==t&&(X(!0),R(t)),-1!==r&&(q(!0),M(r))}};return y.addEventListener("officeDocumentEdited",e),function(){y.removeEventListener("officeDocumentEdited",e)}}),[n]),Object(r.useEffect)((function(){Z();var e=j.getHeaderPageType(n),t=j.getFooterPageType(n);-1!==e&&(X(!0),R(e)),-1!==t&&(q(!0),M(t))}),[a,n]);var ee=function(){var e=_(w().m((function e(){return w().w((function(e){for(;;)switch(e.n){case 0:g.a.setPageNumber(n),p(v.a.openElement(m.a.HEADER_FOOTER_OPTIONS_MODAL));case 1:return e.a(2)}}),e)})));return function(){return e.apply(this,arguments)}}(),te=[{label:d("officeEditor.pageOptions"),key:"page-options",icon:"ic-edit-page",onClick:ee},{label:d("header"===t?"officeEditor.removeHeader":"officeEditor.removeFooter"),key:"remove-".concat(t),icon:"ic-delete-page",onClick:function(){return"header"===t?j.removeHeaders(n):"footer"===t?j.removeFooters(n):void 0}}],ne=function(){var e=_(w().m((function e(t){var n;return w().w((function(e){for(;;)switch(e.n){case 0:return n=te.find((function(e){return e.key===t})),e.n=1,null==n?void 0:n.onClick();case 1:return e.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}(),re="header"===t?x:G,oe="officeEditor.".concat(t,".").concat(re),ae=I?" - ".concat(d("officeEditor.section")," ").concat(I):"",ie="".concat(d(oe)).concat(ae),ce="".concat(ie," ").concat(d("officeEditor.options")),ue="".concat(N,"-label");return o.a.createElement("div",{className:z,id:A,style:k},o.a.createElement("div",{className:"box-shadow-div",ref:P}),o.a.createElement("div",{className:"label"},ie),o.a.createElement(b.a,{width:"auto",id:N,renderItem:function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(l.a,{glyph:e.icon,className:"Dropdown__item-icon"}),o.a.createElement("div",{className:"Dropdown__item-vertical"},o.a.createElement("div",{className:"Dropdown__item-label"},d(e.label))),"page-options"===e.key&&o.a.createElement("div",{className:"Divider"}))},className:"options-dropdown-container",getKey:function(e){return e.key},items:te,onClickItem:ne,displayButton:function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(f.a,{className:"options-button",ariaLabelledby:ue,ariaControls:"".concat(N,"-dropdown"),ariaExpanded:e,img:"icon-chevron-down",label:d("officeEditor.options"),isActive:e,disabled:V}),o.a.createElement(s.a,{id:ue,label:ce}))},labelledById:ue,stopPropagationOnMouseDown:!0,disabled:V}))};F.propTypes=A;var k=o.a.memo(F),H=(n(1743),{visiblePages:p.a.arrayOf(p.a.number),isHeaderControlsActive:p.a.bool,isFooterControlsActive:p.a.bool}),D=function(e){var t=e.visiblePages,n=e.isHeaderControlsActive,r=e.isFooterControlsActive,c=t.map((function(e){var t=Object(i.a)().getElementById("pageSection".concat(e));return t?Object(a.createPortal)(o.a.createElement("div",{key:e,className:"HeaderFooterControlsOverlay"},o.a.createElement(k,{type:"header",pageNumber:e,isActive:n}),o.a.createElement(k,{type:"footer",pageNumber:e,isActive:r})),t):null}));return o.a.createElement(o.a.Fragment,null,c)};D.propTypes=H;var I=D;t.default=I}}]);
//# sourceMappingURL=chunk.52.js.map