(window.webpackJsonpWebViewerUI=window.webpackJsonpWebViewerUI||[]).push([[49],{1820:function(e,t,n){},1821:function(e,t,n){},1822:function(e,t,n){},1853:function(e,t,n){"use strict";n.r(t);n(9),n(10),n(14),n(21),n(20),n(12),n(22),n(18),n(16),n(8),n(17),n(19),n(11),n(13);var r=n(0),a=n.n(r),l=n(6),o=n(3),u=(n(38),n(83),n(43),n(1)),c=n.n(u),i=n(15),s=n.n(i),f=n(307),m=n(53),d=n(5),v=n(61),g=n(148),b=(n(1820),n(1821),function(e){var t,n=e.selectedFormula,r=e.labelId,l=Object(f.a)().t,o=(null==n?void 0:n.name)||"",u=(null==n||null===(t=n.parameters)||void 0===t?void 0:t.map((function(e){return l("formulas.".concat(n.name,".parameters.").concat(e.name,".name"),e.name)})))||[];return a.a.createElement("div",{className:"FormulaHelperOverlay","aria-labelledby":r},a.a.createElement("span",{className:"formulaHelperOverlayValue"},o,"(",u.join(", "),")"))});b.propTypes={selectedFormula:c.a.object,labelId:c.a.string};var p=b,h=function(e){var t=e.isOpen,n=e.options,l=e.onSelect,o=e.onClose,u=e.triggerElement,c=e.highlightedIndex,i=e.setHighlightedIndex,m=e.selectedFormula,b=e.id,h=Object(f.a)().t,y=Object(r.useRef)(null),E=Object(r.useRef)([]);Object(r.useEffect)((function(){E.current[c]&&E.current[c].scrollIntoView({behavior:"smooth",block:"nearest"})}),[c]);var O=Object(r.useCallback)((function(e){!t||null!=u&&u.contains(e.target)||o()}),[t,o,u]);return Object(g.a)(y,O),t?a.a.createElement(v.a,{dataElement:d.a.FORMULA_OVERLAY,className:"FormulaOverlay"},a.a.createElement("span",{id:"formula-overlay-label",className:"formula-label"},h("formulaBar.formulas")),!m&&a.a.createElement("ul",{ref:y,className:"formula-overlay-list",role:"listbox","aria-labelledby":"formula-overlay-label",id:b},n.map((function(e,t){return a.a.createElement("li",{key:"".concat(e.name,"-").concat(t),ref:function(e){return E.current[t]=e},className:s()("formula-option",{highlighted:c===t}),onClick:function(){return l(e)},onMouseEnter:function(){return i(t)},id:"option-".concat(t),role:"option","aria-labelledby":"formula-name-".concat(t," formula-desc-").concat(t),"aria-selected":c===t,tabIndex:0},a.a.createElement("div",{id:"formula-name-".concat(t),className:"formula-name"},e.name),c===t&&a.a.createElement("div",{id:"formula-desc-".concat(t),className:"formula-description"},h("formulas.".concat(e.name,".description"),e.description)))}))),m&&a.a.createElement(p,{selectedFormula:m,labelId:"formula-overlay-label"})):null};h.propTypes={id:c.a.string.isRequired,isOpen:c.a.bool.isRequired,options:c.a.arrayOf(c.a.shape({name:c.a.string.isRequired,description:c.a.string.isRequired})).isRequired,onSelect:c.a.func.isRequired,onClose:c.a.func.isRequired,triggerElement:c.a.instanceOf(Element),highlightedIndex:c.a.number.isRequired,setHighlightedIndex:c.a.func.isRequired,selectedFormula:c.a.shape({name:c.a.string,description:c.a.string.isRequired,parameters:c.a.arrayOf(c.a.shape({name:c.a.string}))})};var y=h,E=n(33);n(1822);function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,o,u=[],c=!0,i=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(u.push(r.value),u.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(i)throw a}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return j(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var R=function(e){var t=e.isReadOnly,n=e.activeCellRange,l=e.cellFormula,o=e.stringCellValue,u=e.onRangeInputChange,c=e.onRangeInputKeyDown,i=Object(f.a)().t,g=Object(E.a)().core,b=l||o||"",p=O(Object(r.useState)(b),2),h=p[0],j=p[1],R=O(Object(r.useState)(!1),2),S=R[0],C=R[1],F=O(Object(r.useState)(0),2),I=F[0],w=F[1],A=O(Object(r.useState)(null),2),x=A[0],B=A[1],k=O(Object(r.useState)([]),2),L=k[0],N=k[1],D=O(Object(r.useState)([]),2),T=D[0],V=D[1],M=O(Object(r.useState)(!1),2),q=M[0],U=M[1],H=Object(r.useRef)(null),K=Object(r.useRef)(null),_=Object(r.useRef)(),P=g.getDocumentViewer().getSpreadsheetEditorManager();Object(r.useEffect)((function(){function e(){K.current=P.getFormulaBarProvider()}return g.addEventListener("spreadsheetEditorReady",e),function(){g.removeEventListener("spreadsheetEditorReady",e)}}),[P]),Object(r.useEffect)((function(){var e=function(e){var t,n;if(q){var r=null!==(t=null===(n=e.getFormulaInfoItems)||void 0===n?void 0:n.call(e))&&void 0!==t?t:[];N(r),w(0)}};return g.addEventListener("formulaSearchEvent",e),function(){g.removeEventListener("formulaSearchEvent",e)}}),[q]),Object(r.useEffect)((function(){var e=function(e){var t=e.getInfo();V(t);var n=t.map((function(e){return e._text})).join("");j(n)},t=function(e){var t,n;null===(t=H.current)||void 0===t||t.focus();var r=e.getSelectionPosition();null===(n=H.current)||void 0===n||n.setSelectionRange(r,r)},n=function(e){B(e.getFormulaInfo())};return g.addEventListener("formulaBarTextChangedEvent",e),g.addEventListener("formulaBarSelectionChangedEvent",t),g.addEventListener("formulaHelpEvent",n),function(){g.removeEventListener("formulaBarTextChangedEvent",e),g.removeEventListener("formulaBarSelectionChangedEvent",t),g.removeEventListener("formulaHelpEvent",n)}}),[]),Object(r.useEffect)((function(){var e=n;_.current!==e&&(j(b),_.current=e)}),[n,b]);var W=Object(r.useCallback)((function(e){K.current&&(K.current.onFormulaBarSelectFormula(e.name),K.current.onFormulaBarTextChange(e.name))}),[]),J=Object(r.useCallback)((function(){C(!1)}),[]),Y=Object(r.useCallback)((function(e){var t=e.target.value;j(t),V([]),K.current&&(K.current.onFormulaBarSelectionChanged(H.current.selectionStart),K.current.onFormulaBarTextChange(t))}),[]);Object(r.useEffect)((function(){0===L.length&&!x||!q?C(!1):C(!0)}),[L,x]);var $=Object(r.useCallback)((function(){U(!0),K.current&&K.current.onFormulaBarFocus()}),[]),z="formula-overlay-".concat(d.a.FORMULA_BAR),G=Object(r.useCallback)((function(e){if(S&&!t)switch(e.key){case"ArrowDown":return e.preventDefault(),void w((function(e){return(e+1)%L.length}));case"ArrowUp":return e.preventDefault(),void w((function(e){return(e-1+L.length)%L.length}));case"Enter":if(L[I])return void W(L[I]);break;case"Tab":if(!e.shiftKey)return e.preventDefault(),void(L[I]&&W(L[I]));break;case"Escape":return e.stopPropagation(),void J()}K.current&&(K.current.onFormulaBarSelectionChanged(H.current.selectionStart),K.current.onFormulaBarKeyDown(e))}),[S,t,L,I,W,J]);return a.a.createElement(v.a,{className:"FormulaBar",dataElement:d.a.FORMULA_BAR},a.a.createElement("input",{type:"text",className:"RangeInput",value:n,onChange:function(e){return u(e.target.value)},onKeyDown:c,"aria-label":i("formulaBar.range")}),a.a.createElement("div",{className:s()("Formula",{readOnly:t})},a.a.createElement(m.a,{glyph:"function",className:s()("FormulaIcon",{readOnly:t})}),a.a.createElement("div",{className:"FormulaInputMask"},T.map((function(e,t){return a.a.createElement("span",{key:"".concat(e.text,"-").concat(t),style:{color:e.color}},e.text)}))),a.a.createElement("input",{onFocus:$,id:d.a.FORMULA_BAR,ref:H,type:"text",role:"combobox","aria-autocomplete":"list","aria-expanded":L.length>0,"aria-controls":z,className:s()({FormulaInput:!0,hasFormula:T.length>0}),"aria-activedescendant":S&&-1!==I?"option-".concat(I):void 0,value:h,onChange:Y,onBlur:function(e){var t;!S||null!==(t=e.relatedTarget)&&void 0!==t&&t.closest("#".concat(z))||J(),U(!1)},onKeyDown:G,readOnly:t,"aria-label":i("formulaBar.label")}),S&&!t&&a.a.createElement(y,{isOpen:S,options:L,onSelect:W,onClose:J,triggerElement:H.current,highlightedIndex:I,setHighlightedIndex:w,selectedFormula:x,id:z})))};R.propTypes={isReadOnly:c.a.bool,activeCellRange:c.a.string,cellFormula:c.a.oneOfType([c.a.string,c.a.number]),stringCellValue:c.a.string,onRangeInputChange:c.a.func,onRangeInputKeyDown:c.a.func};var S=R;function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,l,o,u=[],c=!0,i=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(u.push(r.value),u.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(i)throw a}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var I=window.Core.SpreadsheetEditor.SpreadsheetEditorEditMode,w=function(){var e=Object(l.e)(o.a.getActiveCellRange),t=Object(l.e)(o.a.getCellFormula),n=Object(l.e)(o.a.getStringCellValue),u=Object(l.e)(o.a.getSpreadsheetEditorEditMode)===I.VIEW_ONLY,c=Object(E.a)().core,i=C(Object(r.useState)(e),2),s=i[0],f=i[1];return Object(r.useEffect)((function(){f(e)}),[e]),a.a.createElement(S,{isReadOnly:u,activeCellRange:s,cellFormula:t,stringCellValue:n,onRangeInputChange:function(e){f(e)},onRangeInputKeyDown:function(t){if("Enter"===t.key)try{var n=c.getDocumentViewer().getDocument().getSpreadsheetEditorDocument(),r=c.getCellRange(t.target.value);n.selectCellRange(r)}catch(t){return f(e),void console.error(t)}}})};t.default=w}}]);
//# sourceMappingURL=chunk.49.js.map