(window.webpackJsonpWebViewerUI=window.webpackJsonpWebViewerUI||[]).push([[29],{1448:function(t,e,n){"use strict";var r=n(0),o=n.n(r).a.createContext();e.a=o},1470:function(t,e,n){"use strict";n(27),n(8),n(232),n(268),n(389),n(30);e.a=function(t,e){var n={},r=t.getContents().ops,o=0;r.forEach((function(t){var e,r=t.attributes,a=null===(e=t.insert)||void 0===e?void 0:e.mention,i=t.insert;if(a){var c=t.insert.mention;i=c.denotationChar+c.value}var u={};(null==r?void 0:r.bold)&&(u["font-weight"]="bold"),(null==r?void 0:r.italic)&&(u["font-style"]="italic"),(null==r?void 0:r.color)&&(u.color=r.color),(null==r?void 0:r.underline)&&(u["text-decoration"]="word"),(null==r?void 0:r.strike)&&(u["text-decoration"]?u["text-decoration"]="".concat(u["text-decoration"]," line-through"):u["text-decoration"]="line-through"),(null==r?void 0:r.size)&&(u["font-size"]=r.size),(null==r?void 0:r.font)&&(u["font-family"]=r.font),n[o]=u,o+=i.length})),e.setRichTextStyle(n)}},1473:function(t,e,n){"use strict";n(9),n(10),n(14),n(31),n(36),n(27),n(21),n(20),n(12),n(22),n(32),n(18),n(16),n(29),n(47),n(23),n(46),n(48),n(37),n(8),n(17),n(19),n(11),n(111),n(136),n(30),n(13),n(94);var r=n(0),o=n.n(r),a=n(1),i=n.n(a),c=n(6),u=n(130),l=n.n(u),s=n(1448),f=n(3),d=(n(38),n(26),n(40),n(41),n(42),n(54),n(1485)),p=n(1560),b=n(382),m=n(44),y=n(307),v=n(5),g=n(24);n(83),n(43);var h=function(t){if(!t)return t;var e=t.split("\n");return e.length>1?e.map((function(t){return"<p>".concat(t||"<br>","</p>")})).join(""):t};n(77),n(87);function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?E(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function S(t,e,n){return(e=T(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,T(r.key),r)}}function A(t,e,n){return e&&w(t.prototype,e),n&&w(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function T(t){var e=function(t,e){if("object"!=O(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==O(e)?e:e+""}function C(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e,n){return e=P(e),function(t,e){if(e&&("object"==O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,function(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return function(){return!!t}()}()?Reflect.construct(e,n||[],P(t).constructor):e.apply(t,n))}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e)}function x(t,e){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}var k=d.a.import("modules/clipboard"),D=window.Core.quillShadowDOMWorkaround,_=function(t){function e(t,n){return C(this,e),D(t),N(this,e,[t,n])}return I(e,t),A(e)}(k),M=d.a.import("modules/keyboard"),R=function(t){function e(){return C(this,e),N(this,e,arguments)}return I(e,t),A(e)}(M);S(R,"DEFAULTS",j(j({},M.DEFAULTS),{},{bindings:j(j({},M.DEFAULTS.bindings),{},{"list autofill":void 0})}));var L=function(){return A((function t(e){var n,r=this;C(this,t),S(this,"handleKeyDown",(function(t){"Escape"===t.key?r.blurQuill():"Tab"===t.key&&r.shouldSkipInput&&(t.preventDefault(),r.moveFocus(t.shiftKey))})),this.quill=e,this.noteContainer=e.root.closest(".Note"),this.shouldSkipInput=!1,null===(n=this.noteContainer)||void 0===n||n.addEventListener("keydown",this.handleKeyDown.bind(this))}),[{key:"blurQuill",value:function(){this.shouldSkipInput=!0,this.quill.blur(),this.quill.container.tabIndex=0,this.quill.container.focus()}},{key:"moveFocus",value:function(t){var e,n=Array.from(this.noteContainer.querySelectorAll(".ql-container.ql-snow, button.modular-ui")),r=n.indexOf(this.quill.container);-1!==r&&(null===(e=n[t?r-1:r+1])||void 0===e||e.focus());this.shouldSkipInput=!1,this.quill.container.tabIndex=-1}}])}();n(1545),n(1546);function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){G(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function G(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=F(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==F(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return z(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,b=a[2];n>3?(o=b===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<b&&(o=n<3||a[0]>r||r>b)&&(a[4]=n,a[5]=r,d.n=b,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,b){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,b),c=s,u=b;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(z(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,z(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,z(f,"constructor",l),z(l,"constructor",u),u.displayName="GeneratorFunction",z(l,o,"GeneratorFunction"),z(f),z(f,o,"Generator"),z(f,r,(function(){return this})),z(f,"toString",(function(){return"[object Generator]"})),(W=function(){return{w:a,m:d}})()}function z(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}(z=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){z(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}})(t,e,n,r)}function B(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}var V=[],q=["background","bold","color","font","code","italic","link","size","strike","script","underline","blockquote","header","indent","list","align","direction","code-block","formula","mention"];d.a.register("modules/keyboard",R,!0),d.a.register("modules/clipboard",_,!0),d.a.register("modules/blurInput",L),d.a.register({"modules/mention":p.a,"blots/mention":p.b});var K={mention:{allowedChars:/^[A-Za-z\sÅÄÖåäö0-9\-_]*$/,mentionDenotationChars:["@","#"],mentionContainerClass:"mention__element",mentionListClass:"mention__suggestions__list",listItemClass:"mention__suggestions__item",renderItem:function(t){var e=document.createElement("div");if(e.innerText=t.value,t.email){var n=document.createElement("p");n.innerText=t.email,n.className="email",e.appendChild(n)}return e},source:function(t,e){return(n=W().m((function n(){var r,o;return W().w((function(n){for(;;)switch(n.n){case 0:return r=b.a.getMentionLookupCallback(),n.n=1,r(V,t);case 1:o=n.v,e(o,t);case 2:return n.a(2)}}),n)})),function(){var t=this,e=arguments;return new Promise((function(r,o){var a=n.apply(t,e);function i(t){B(a,r,o,i,c,"next",t)}function c(t){B(a,r,o,i,c,"throw",t)}i(void 0)}))})();var n}}},$=o.a.forwardRef((function(t,e){var n=t.value,r=void 0===n?"":n,a=t.onChange,i=t.onKeyDown,u=t.onBlur,l=t.onFocus,s=t.userData,p=t.isReply,b=Object(y.a)(),O=b.t,E=b.i18n,j=E.resolvedLanguage||E.language,S=Object(c.e)((function(t){return f.a.isElementDisabled(t,v.a.NotesPanel.ADD_REPLY_ATTACHMENT_BUTTON)}));V=s;r=h(r);var w={blurInput:{}};return o.a.createElement("div",{className:"comment-textarea",onBlur:u,onFocus:l,onClick:function(t){t.preventDefault(),t.stopPropagation()},onScroll:function(t){t.preventDefault(),t.stopPropagation()}},o.a.createElement(d.b,{key:j,className:"comment-textarea ql-container ql-editor",style:{overflowY:"visible"},ref:function(t){return t&&(t.getEditor().root.ariaLabel="".concat(O(p?"action.reply":"action.comment"))),e(t)},modules:s&&s.length>0?U(U({},w),K):w,theme:"snow",value:r,placeholder:"".concat(O(p?"action.reply":"action.comment"),"..."),onChange:a,onKeyDown:i,formats:q}),p&&!S&&o.a.createElement(m.a,{className:"add-attachment",dataElement:v.a.NotesPanel.ADD_REPLY_ATTACHMENT_BUTTON,img:"ic_fileattachment_24px",title:"".concat(O("action.add")," ").concat(O("option.type.fileattachment")),onClick:function(){var t;null===(t=Object(g.a)().querySelector("#reply-attachment-picker"))||void 0===t||t.click()}}))}));$.displayName="CommentTextarea";var Y=$;function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){Z(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Z(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=J(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==J(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return et(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?et(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var nt={value:i.a.string,placeholder:i.a.string,onChange:i.a.func.isRequired,onBlur:i.a.func,onFocus:i.a.func,onSubmit:i.a.func},rt=o.a.forwardRef((function(t,e){var n=tt(Object(c.e)((function(t){return[f.a.getUserData(t),f.a.isNoteSubmissionWithEnterEnabled(t),f.a.getAutoFocusNoteOnAnnotationSelection(t),f.a.getIsNoteEditing(t)]}),c.c),2),a=n[0],i=n[1],u=Object(r.useContext)(s.a).resize,d=Object(r.useRef)(),p=Object(r.useRef)();Object(r.useLayoutEffect)((function(){var t,e,n=null===(t=d.current)||void 0===t||null===(e=t.editor)||void 0===e?void 0:e.container.firstElementChild,r=(null==n?void 0:n.getBoundingClientRect())||{};p.current&&p.current!==r.height&&u(),p.current=r.height}),[t.value,u]);var m=Q(Q({},t),{},{ref:function(t){d.current=t,e(t)},onChange:l()((function(e,n,r,o){if(e=e.replace(/&nbsp;/g," "),d.current){var a="";if(o&&""===o.getText().trim()&&"<p><br></p>"===e||(a=e.target?e.target.value:e),t.onChange(a),b.a.doesDeltaContainMention(n.ops)){var i,c=b.a.getFormattedTextFromDeltas(n.ops),u=b.a.extractMentionDataFromStr(c),l=o.getText().length+u.plainTextValue.length,s=null===(i=d.current)||void 0===i?void 0:i.editor;setTimeout((function(){return null==s?void 0:s.setSelection(l,l)}),1)}}}),100),onKeyDown:function(e){if(13===e.which){var n=i,r=e.metaKey||e.ctrlKey;(n||r)&&t.onSubmit(e)}},userData:a});return o.a.createElement(o.a.Fragment,null,o.a.createElement(Y,m))}));rt.displayName="NoteTextarea",rt.propTypes=nt;var ot=rt;e.a=ot},1499:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));n(38);var r=n(35),o=n(4);function a(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=new window.Core.Annotations.StickyAnnotation;a.InReplyTo=t.Id,a.X=t.X,a.Y=t.Y,a.PageNumber=t.PageNumber,a.Subject="Sticky Note",a.Author=o.a.getCurrentUser(),a.State=e,a.StateModel="Marked"===e||"Unmarked"===e?"Marked":"Review",a.Hidden=!0,a.enableSkipAutoLink();var i=o.a.getDisplayAuthor(a.Author,n),c=r.a.t("option.state.".concat(e.toLowerCase())),u="".concat(c," ").concat(r.a.t("option.state.setBy")," ").concat(i);return a.setContents(u),a}},1500:function(t,e,n){"use strict";n(9),n(10),n(14),n(21),n(20),n(12),n(22),n(18),n(16),n(8),n(17),n(19),n(11),n(111),n(13);var r=n(0),o=n.n(r),a=n(1),i=n.n(a),c=n(307),u=n(15),l=n.n(u);n(1512);function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return f(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function d(t){var e=t.children.replace(/\n$/,""),n=t.panelWidth,a=t.linesToBreak,i=t.renderRichText,u=t.richTextStyle,f=t.resize,d=t.style,p=t.comment,b=void 0!==p&&p,m=t.beforeContent,y=void 0===m?function(){}:m,v=s(Object(r.useState)(!1),2),g=v[0],h=v[1],O=s(Object(r.useState)(null),2),E=O[0],j=O[1],S=s(Object(r.useState)(null),2),w=S[0],A=S[1],T=s(Object(r.useState)(!1),2),C=T[0],N=T[1],P=o.a.useRef(null),I=Object(c.a)().t,x=g?e:e.substring(0,w*a),k=I(g?"action.showLess":"action.showMore"),D=l()("note-text-preview",{"preview-comment":b});return Object(r.useEffect)((function(){var t=P.current.clientWidth;j(t)}),[n]),Object(r.useLayoutEffect)((function(){var t=function(t){var e=document.createElement("canvas").getContext("2d");return e.font="13px sans-serif",e.measureText(t).width}(e),n=t/e.length,r=Math.floor(E/n);A(r),N(t/E>a)}),[e,E]),o.a.createElement("div",{className:D,ref:P,style:d,"aria-live":"polite"},y(),i&&u?i(x,u,0):x," ",C&&o.a.createElement("button",{className:"note-text-preview-prompt",onClick:function(t){t.stopPropagation(),h(!g),f&&f()}},k))}d.propTypes={panelWidth:i.a.number,linesToBreak:i.a.number,renderRichText:i.a.func,richTextStyle:i.a.any,resize:i.a.func,style:i.a.any,comment:i.a.bool,beforeContent:i.a.func},e.a=d},1502:function(t,e,n){"use strict";n(9),n(10),n(14),n(31),n(38),n(36),n(27),n(12),n(43),n(32),n(29),n(47),n(23),n(46),n(48),n(37),n(8),n(11),n(30),n(13);var r=n(0),o=n(6),a=n(1),i=n.n(a),c=n(5),u=n(2),l=n(3);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var b=function(t,e,n){return{icon:e,label:"option.state.".concat(t.toLowerCase()),title:"option.state.".concat(t.toLowerCase()),option:t,dataElement:n}},m=[b("Accepted","icon-annotation-status-accepted","noteStateFlyoutAcceptedOption"),b("Rejected","icon-annotation-status-rejected","noteStateFlyoutRejectedOption"),b("Cancelled","icon-annotation-status-cancelled","noteStateFlyoutCancelledOption"),b("Completed","icon-annotation-status-completed","noteStateFlyoutCompletedOption"),b("None","icon-annotation-status-none","noteStateFlyoutNoneOption"),b("Marked","icon-annotation-status-marked","noteStateFlyoutMarkedOption"),b("Unmarked","icon-annotation-status-unmarked","noteStateFlyoutUnmarkedOption")],y=function(t){var e=t.noteId,n=t.handleStateChange,a=void 0===n?function(){}:n,i=t.isMultiSelectMode,s=void 0!==i&&i,f=Object(o.d)(),p=s?"":"-".concat(e),b="".concat(c.a.NOTE_STATE_FLYOUT).concat(p),y=Object(o.e)((function(t){return l.a.getFlyout(t,b)}));return Object(r.useLayoutEffect)((function(){var t={dataElement:b,className:"NoteStateFlyout",items:m.map((function(t){return d(d({},t),{},{onClick:function(){return e=t.option,void a(e);var e}})}))};f(y?u.a.updateFlyout(t.dataElement,t):u.a.addFlyout(t))}),[a]),null};y.propTypes={noteId:i.a.string,handleStateChange:i.a.func,isMultiSelectMode:i.a.bool};var v=y;e.a=v},1503:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n(49),n(62);var r=function(t,e){var n=t.getDisplayModeObject().getVisiblePages().includes(e.PageNumber);return t.isContinuousDisplayMode()||!t.isContinuousDisplayMode()&&n}},1512:function(t,e,n){},1545:function(t,e,n){},1546:function(t,e,n){t.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1547:function(t,e,n){t.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1548:function(t,e,n){t.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1549:function(t,e,n){},1550:function(t,e,n){t.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1551:function(t,e,n){t.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1552:function(t,e,n){t.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1553:function(t,e,n){t.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1554:function(t,e,n){"use strict";n(9),n(10),n(26),n(16),n(40),n(23),n(41),n(42),n(8),n(54);var r=n(0),o=n.n(r),a=n(6),i=n(3);function c(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof l?r:l,s=Object.create(c.prototype);return u(s,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,b=a[2];n>3?(o=b===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<b&&(o=n<3||a[0]>r||r>b)&&(a[4]=n,a[5]=r,d.n=b,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,b){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,b),c=s,u=b;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),s}var i={};function l(){}function s(){}function f(){}e=Object.getPrototypeOf;var d=[][r]?e(e([][r]())):(u(e={},r,(function(){return this})),e),p=f.prototype=l.prototype=Object.create(d);function b(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,u(t,o,"GeneratorFunction")),t.prototype=Object.create(p),t}return s.prototype=f,u(p,"constructor",f),u(f,"constructor",s),s.displayName="GeneratorFunction",u(f,o,"GeneratorFunction"),u(p),u(p,o,"Generator"),u(p,r,(function(){return this})),u(p,"toString",(function(){return"[object Generator]"})),(c=function(){return{w:a,m:b}})()}function u(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}(u=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){u(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}})(t,e,n,r)}function l(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}e.a=function(t){var e=t.annotationId,n=t.addAttachments,r=Object(a.e)((function(t){return i.a.getReplyAttachmentHandler(t)})),u=function(){var t,o=(t=c().m((function t(o){var a,i,u;return c().w((function(t){for(;;)switch(t.n){case 0:if(!(a=o.target.files[0])){t.n=3;break}if(i=a,!r){t.n=2;break}return t.n=1,r(a);case 1:u=t.v,i={url:u,name:a.name,size:a.size,type:a.type};case 2:n(e,[i]);case 3:return t.a(2)}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){l(a,r,o,i,c,"next",t)}function c(t){l(a,r,o,i,c,"throw",t)}i(void 0)}))});return function(t){return o.apply(this,arguments)}}();return o.a.createElement("input",{id:"reply-attachment-picker",type:"file",style:{display:"none"},onChange:u,onClick:function(t){t.target.value=""}})}},1558:function(t,e,n){"use strict";n(9),n(10),n(14),n(31),n(36),n(27),n(21),n(20),n(12),n(43),n(22),n(95),n(146),n(32),n(18),n(26),n(16),n(29),n(40),n(47),n(23),n(46),n(48),n(41),n(37),n(42),n(8),n(85),n(54),n(17),n(19),n(116),n(11),n(30),n(13),n(94);var r=n(0),o=n.n(r),a=n(15),i=n.n(a),c=n(1),u=n.n(c),l=n(6),s=n(307),f=n(1448),d=(n(49),n(77),n(165),n(475),n(62),n(111),n(136),n(1484),n(1559)),p=n(105),b=n.n(p),m=n(319),y=n.n(m),v=n(211),g=n.n(v),h=n(1535),O=n.n(h),E=n(1473),j=(n(38),n(57),n(33)),S=n(3),w=n(5),A=n(2),T=(n(1547),n(97));function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){I(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function I(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=C(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==C(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return k(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var D=function(t,e,n){return{icon:e,label:"action.".concat(t.toLowerCase()),title:"action.".concat(t.toLowerCase()),option:t,dataElement:n}},_=[D("Edit","","notePopupEdit"),D("Delete","","notePopupDelete")],M={handleEdit:u.a.func,handleDelete:u.a.func,isEditable:u.a.bool,isDeletable:u.a.bool,noteId:u.a.string};function R(){}function L(t){var e=t.handleEdit,n=void 0===e?R:e,r=t.handleDelete,a=void 0===r?R:r,c=t.isEditable,u=t.isDeletable,f=t.isReply,d=t.noteId,p=Object(l.e)((function(t){var e;return null===(e=S.a.getFeatureFlags(t))||void 0===e?void 0:e.customizableUI})),b="".concat(w.a.NOTE_POPUP_FLYOUT,"-").concat(d),m=x(Object(s.a)(),1)[0];if(!c&&!u)return null;var y=i()("overflow note-popup-toggle-trigger"),v=i()("NotePopup options note-popup-options",{"options-reply":f,"modular-ui":p});return o.a.createElement("div",{className:v},o.a.createElement(T.a,{dataElement:"notePopup-".concat(d),className:y,img:"icon-tools-more",title:m("formField.formFieldPopup.options"),toggleElement:b,disabled:!1}),o.a.createElement(F,{flyoutSelector:b,handleClick:function(t){"Edit"===t?n():"Delete"===t&&a()},isEditable:c,isDeletable:u}))}var F=function(t){var e=t.flyoutSelector,n=t.handleClick,o=t.isEditable,a=t.isDeletable,i=Object(l.d)(),c=Object(l.e)((function(t){return S.a.getFlyout(t,e)})),u=x(Object(s.a)(),1)[0];return Object(r.useLayoutEffect)((function(){var t=_;o?a||(t=t.filter((function(t){return"Delete"!==t.option}))):t=t.filter((function(t){return"Edit"!==t.option}));var r={dataElement:e,className:"NotePopupFlyout",items:t.map((function(t){return P(P({},t),{},{label:u(t.label),title:u(t.title),onClick:function(){return n(t.option)}})}))};i(c?A.a.updateFlyout(r.dataElement,r):A.a.addFlyout(r))}),[o,a]),null};F.propTypes={flyoutSelector:u.a.string,handleClick:u.a.func,isEditable:u.a.bool,isDeletable:u.a.bool},L.propTypes=M;var H=L;function U(){return(U=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(null,arguments)}function G(t){return function(t){if(Array.isArray(t))return B(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||z(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||z(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,e){if(t){if("string"==typeof t)return B(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(t,e):void 0}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var V=function(t){var e=W(Object(l.e)((function(t){return[S.a.getActiveDocumentViewerKey(t)]})),1)[0],n=t.annotation,r=t.setIsEditing,a=t.noteIndex,i=Object(j.a)().core,c=W(o.a.useState(i.canModify(n)),2),u=c[0],s=c[1],f=W(o.a.useState(i.canModifyContents(n)),2),d=f[0],p=f[1];o.a.useEffect((function(){function t(){s(i.canModify(n,e)),p(i.canModifyContents(n,e))}return t(),i.addEventListener("updateAnnotationPermission",t,void 0,e),function(){return i.removeEventListener("updateAnnotationPermission",t,e)}}),[n,e]);var b={handleEdit:o.a.useCallback((function(){n instanceof window.Core.Annotations.FreeTextAnnotation&&i.getAnnotationManager(e).isFreeTextEditingEnabled()?i.getAnnotationManager(e).trigger("annotationDoubleClicked",n):r(!0,a)}),[n,r,a]),handleDelete:o.a.useCallback((function(){i.deleteAnnotations([n].concat(G(n.getGroupedChildren())),void 0,e)}),[n]),isEditable:d,isDeletable:u&&!(null!=n&&n.NoDelete),noteId:n?n.Id:""};return o.a.createElement(H,U({},t,b))},q=n(1502);function K(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return $(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Y={annotation:u.a.object.isRequired,handleStateChange:u.a.func};function J(t){var e=t.annotation,n=t.handleStateChange,r=void 0===n?function(){}:n,a=K(Object(s.a)(),1)[0],i=e.getStatus(),c="icon-annotation-status-".concat(""===i?"none":i.toLowerCase()),u=e.Id;return o.a.createElement(o.a.Fragment,null,o.a.createElement(T.a,{dataElement:"noteState-".concat(u),title:a("option.notesOrder.status"),img:c,toggleElement:"".concat(w.a.NOTE_STATE_FLYOUT,"-").concat(u)}),o.a.createElement(q.a,{noteId:u,handleStateChange:r}))}J.propTypes=Y;var X=J,Q=n(1499),Z=n(164);function tt(){return(tt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(null,arguments)}var et={annotation:u.a.object};function nt(t){var e=Object(j.a)().core,n=Object(l.e)((function(t){return S.a.getActiveDocumentViewerKey(t)})),a=Object(l.e)((function(t){return S.a.isElementDisabled(t,"noteState")})),i=t.annotation,c=Object(Z.a)(Object(r.useCallback)((function(t){var r=Object(Q.a)(i,t,n);i.addReply(r);var o=e.getAnnotationManager(n);o.addAnnotation(r),o.trigger("addReply",[r,i,o.getRootAnnotation(i)])}),[i,n]));return!a&&o.a.createElement("div",null,o.a.createElement(X,tt({handleStateChange:c},t)))}nt.propTypes=et;var rt=nt,ot=n(53),at=n(120);function it(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ct(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ct(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var ut={annotationId:u.a.string,ariaLabel:u.a.string,pendingEditTextMap:u.a.object,pendingReplyMap:u.a.object,pendingAttachmentMap:u.a.object},lt=function(t){var e=t.annotationId,n=t.ariaLabel,a=t.pendingEditTextMap,i=t.pendingReplyMap,c=t.pendingAttachmentMap,u=Object(s.a)().t,l=it(Object(r.useState)(!1),2),f=l[0],d=l[1],p=it(Object(r.useState)(!1),2),b=p[0],m=p[1],y=it(Object(r.useState)(!1),2),v=y[0],g=y[1];return Object(r.useEffect)((function(){var t,n,r;d((null===(t=a[e])||void 0===t?void 0:t.length)>0),m((null===(n=i[e])||void 0===n?void 0:n.length)>0),g((null===(r=c[e])||void 0===r?void 0:r.length)>0)}),[a,i,c]),f||b||v?o.a.createElement("div",{"data-element":"unpostedCommentIndicator"},o.a.createElement(at.a,{content:u("message.unpostedComment")},o.a.createElement("div",null,o.a.createElement(ot.a,{className:"type-icon",glyph:"icon-unposted-comment",ariaLabel:n})))):null};lt.propTypes=ut;var st=lt,ft={annotationId:u.a.string,ariaLabel:u.a.string},dt=function(t){var e=t.annotationId,n=t.ariaLabel,r=Object(l.e)((function(t){return S.a.isElementDisabled(t,"unpostedCommentIndicator")})),a=o.a.useContext(f.a),i=a.pendingEditTextMap,c=a.pendingReplyMap,u=a.pendingAttachmentMap;return r?null:o.a.createElement(st,{annotationId:e,ariaLabel:n,pendingEditTextMap:i,pendingReplyMap:c,pendingAttachmentMap:u})};dt.propTypes=ft;var pt=dt,bt=n(106),mt=n(44),yt=n(236),vt=n(178),gt=n(174),ht=n(183),Ot=n(234),Et=n(25),jt=n(107);n(1548);function St(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return wt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var At=window.Core.Annotations,Tt={icon:u.a.string,iconColor:u.a.string,color:u.a.string,fillColor:u.a.string,annotation:u.a.object,language:u.a.string,noteDateFormat:u.a.string,isSelected:u.a.bool,setIsEditing:u.a.func,notesShowLastUpdatedDate:u.a.bool,isUnread:u.a.bool,renderAuthorName:u.a.func,isNoteStateDisabled:u.a.bool,isEditing:u.a.bool,noteIndex:u.a.number,sortStrategy:u.a.string,activeTheme:u.a.string,isMultiSelected:u.a.bool,isMultiSelectMode:u.a.bool,handleMultiSelect:u.a.func,isGroupMember:u.a.bool,showAnnotationNumbering:u.a.bool,isTrackedChange:u.a.bool};function Ct(t){var e=t.icon,n=t.iconColor,r=t.annotation,a=t.language,c=t.noteDateFormat,u=t.isSelected,l=t.setIsEditing,f=t.notesShowLastUpdatedDate,d=t.isReply,p=t.isUnread,m=t.renderAuthorName,y=t.isNoteStateDisabled,v=t.isEditing,g=t.noteIndex,h=t.sortStrategy,O=t.activeTheme,E=t.isMultiSelected,S=t.isMultiSelectMode,w=t.handleMultiSelect,A=t.isGroupMember,T=t.showAnnotationNumbering,C=t.timezone,N=t.isTrackedChange,P=Object(j.a)().core,I=St(Object(s.a)(),1)[0],x=function(t,e,n,r){var o=t===ht.a.MODIFIED_DATE||e&&t!==ht.a.CREATED_DATE?Object(yt.a)(n):n.DateCreated;if(r&&o){var a=o.toLocaleString("en-US",{timeZone:r});return new Date(a)}return o}(h,f,r,C),k=x?b()(x).locale(a).format(c):I("option.notesPanel.noteContent.noDate"),D=r.getReplies().length,_=function(t,e){var n,r,o=null===(n=t[e])||void 0===n||null===(r=n.toHexString)||void 0===r?void 0:r.call(n);if(!(t instanceof At.FreeTextAnnotation))return o;var a=t.getRichTextStyle();if(!a)return o;var i=Object.keys(a).length,c=t.getContents().length,u=a[0];if(1===i&&u&&u.color)o=(c-Object.keys(a)[0])/c>.5?u.color:o;else if(i>1){var l,s=(null===(l=t.getEditor())||void 0===l?void 0:l.getMajorityTextColors())||[];o=s.length<1?o:s[0]}return o}(r,n);""===_&&(_=function(t,e){return t===Ot.a.DARK&&e&&Object(gt.c)(e)?jt.b.white:t===Ot.a.LIGHT&&e&&Object(gt.d)(e)?jt.b.black:void 0}(O,_));var M=Object(vt.a)(r.FillColor),R=r.getAssociatedNumber(),L="#".concat(R," - "),F=i()("author-and-date",{isReply:d}),H=i()("NoteHeader",{parent:!d&&!A}),U=!(y||d||S||A||N),G=!v&&u&&!S&&!A&&!N;return o.a.createElement("div",{className:H},!d&&o.a.createElement("div",{className:"type-icon-container"},p&&o.a.createElement("div",{className:"unread-notification"}),o.a.createElement(ot.a,{className:"type-icon",glyph:e,color:_,fillColor:M})),o.a.createElement("div",{className:F},o.a.createElement("div",{className:"author-and-overflow"},o.a.createElement("div",{className:"author-and-time"},o.a.createElement("div",{className:"author"},T&&void 0!==R&&o.a.createElement("span",{className:"annotation-number"},L),m(r)),o.a.createElement("div",{className:"date-and-num-replies"},o.a.createElement("div",{className:"date-and-time"},k,A&&" (Page ".concat(r.PageNumber,")")),D>0&&!u&&o.a.createElement("div",{className:"num-replies-container"},o.a.createElement(ot.a,{className:"num-reply-icon",glyph:"icon-chat-bubble"}),o.a.createElement("div",{className:"num-replies"},D)))),o.a.createElement("div",{className:"state-and-overflow"},S&&!A&&!d&&o.a.createElement(bt.a,{id:"note-multi-select-toggle_".concat(r.Id),"aria-label":"".concat(m(r)," ").concat(I("option.notesPanel.toggleMultiSelect")),checked:E,onClick:function(t){t.preventDefault(),t.stopPropagation(),w(!E)}}),o.a.createElement(pt,{annotationId:r.Id,ariaLabel:"Unposted Comment, ".concat(m(r),", ").concat(k)}),U&&o.a.createElement(rt,{annotation:r,isSelected:u}),G&&o.a.createElement(V,{noteIndex:g,annotation:r,setIsEditing:l,isReply:d}),u&&N&&!S&&o.a.createElement(o.a.Fragment,null,o.a.createElement(mt.a,{title:I("officeEditor.accept"),img:"icon-menu-checkmark",className:"tracked-change-icon-wrapper accept",onClick:function(){return t=r.getCustomData(Et.z),void P.getOfficeEditor().acceptTrackedChange(t);var t},iconClassName:"tracked-change-icon"}),o.a.createElement(mt.a,{title:I("officeEditor.reject"),img:"icon-close",className:"tracked-change-icon-wrapper reject",onClick:function(){return t=r.getCustomData(Et.z),void P.getOfficeEditor().rejectTrackedChange(t);var t},iconClassName:"tracked-change-icon"}))))))}Ct.propTypes=Tt;var Nt=Ct,Pt=n(1500);function It(){return(It=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(null,arguments)}function xt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return kt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Dt=function(t){var e=xt(Object(l.e)((function(t){return[S.a.getNotesPanelWidth(t)]}),l.c),1)[0];return o.a.createElement(Pt.a,It({},t,{panelWidth:e}))},_t=(n(313),n(314),n(315),n(175));n(173);function Mt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Rt(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,b=a[2];n>3?(o=b===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<b&&(o=n<3||a[0]>r||r>b)&&(a[4]=n,a[5]=r,d.n=b,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,b){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,b),c=s,u=b;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Rt(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Rt(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Rt(f,"constructor",l),Rt(l,"constructor",u),u.displayName="GeneratorFunction",Rt(l,o,"GeneratorFunction"),Rt(f),Rt(f,o,"Generator"),Rt(f,r,(function(){return this})),Rt(f,"toString",(function(){return"[object Generator]"})),(Mt=function(){return{w:a,m:d}})()}function Rt(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}(Rt=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Rt(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}})(t,e,n,r)}function Lt(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Ft(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){Lt(a,r,o,i,c,"next",t)}function c(t){Lt(a,r,o,i,c,"throw",t)}i(void 0)}))}}var Ht="ic-file-pdf",Ut="ic-file-img",Gt="ic-file-cad",Wt="ic-file-doc",zt="ic-file-ppt",Bt="ic-file-xls",Vt="ic-file-etc",qt=window.Core.Annotations.FileAttachmentUtils;function Kt(t){return $t.apply(this,arguments)}function $t(){return($t=Ft(Mt().m((function t(e){return Mt().w((function(t){for(;;)switch(t.n){case 0:return t.a(2,qt.decompressWithFlateDecode(e.content,e.type))}}),t)})))).apply(this,arguments)}function Yt(t){return Jt.apply(this,arguments)}function Jt(){return(Jt=Ft(Mt().m((function t(e){var n,r=arguments;return Mt().w((function(t){for(;;)switch(t.n){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:[],t.n=1,e.setAttachments(n);case 1:return t.a(2)}}),t)})))).apply(this,arguments)}function Xt(t){return!(!t.type||!t.type.startsWith("image/"))}function Qt(t){var e;if(Xt(t))return Ut;switch(null===(e=t.name)||void 0===e?void 0:e.split(".").pop().toLowerCase()){case"pdf":return Ht;case"cad":return Gt;case"doc":case"docx":return Wt;case"ppt":case"pptx":return zt;case"xls":case"xlsx":return Bt;default:return Vt}}var Zt=n(488),te=n.n(Zt);function ee(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return ne(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,b=a[2];n>3?(o=b===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<b&&(o=n<3||a[0]>r||r>b)&&(a[4]=n,a[5]=r,d.n=b,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,b){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,b),c=s,u=b;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(ne(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,ne(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,ne(f,"constructor",l),ne(l,"constructor",u),u.displayName="GeneratorFunction",ne(l,o,"GeneratorFunction"),ne(f),ne(f,o,"Generator"),ne(f,r,(function(){return this})),ne(f,"toString",(function(){return"[object Generator]"})),(ee=function(){return{w:a,m:d}})()}function ne(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}(ne=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){ne(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}})(t,e,n,r)}function re(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}var oe=function(t){return new Promise((function(e){if(void 0===t.size)e(t.toString("utf-8"));else{var n=new FileReader;n.onload=function(){return e(n.result)},n.readAsText(t)}}))},ae=function(t){return"image/svg+xml"===t.type},ie=function(){var t,e=(t=ee().m((function t(e){var n,r,o,a;return ee().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,oe(e);case 1:if(n=t.v){t.n=2;break}return t.a(2,{svg:e});case 2:return r=[],te.a.addHook("uponSanitizeElement",(function(t,e){var n=e.tagName;e.allowedTags[n]||r.push(n)})),o=te.a.sanitize(n),a=new Blob([o],{type:"image/svg+xml"}),t.a(2,{svg:a,isDirty:r.length>0})}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){re(a,r,o,i,c,"next",t)}function c(t){re(a,r,o,i,c,"throw",t)}i(void 0)}))});return function(t){return e.apply(this,arguments)}}();n(1549);function ce(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return ue(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,b=a[2];n>3?(o=b===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<b&&(o=n<3||a[0]>r||r>b)&&(a[4]=n,a[5]=r,d.n=b,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,b){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,b),c=s,u=b;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(ue(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,ue(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,ue(f,"constructor",l),ue(l,"constructor",u),u.displayName="GeneratorFunction",ue(l,o,"GeneratorFunction"),ue(f),ue(f,o,"Generator"),ue(f,r,(function(){return this})),ue(f,"toString",(function(){return"[object Generator]"})),(ce=function(){return{w:a,m:d}})()}function ue(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}(ue=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){ue(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}})(t,e,n,r)}function le(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function se(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){le(a,r,o,i,c,"next",t)}function c(t){le(a,r,o,i,c,"throw",t)}i(void 0)}))}}function fe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return de(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var pe=function(t){var e=t.file,n=fe(Object(s.a)(),1)[0],a=fe(Object(r.useState)(),2),c=a[0],u=a[1],l=fe(Object(r.useState)(!1),2),f=l[0],d=l[1];return Object(r.useEffect)((function(){(function(){var t=se(ce().m((function t(){var n,r,o,a,i;return ce().w((function(t){for(;;)switch(t.n){case 0:if(d(!1),n=e,!(r=!(e instanceof File||e.url))){t.n=2;break}return t.n=1,Kt(e);case 1:n=t.v;case 2:if(!(e instanceof File||r)){t.n=5;break}if(!ae(e)){t.n=4;break}return t.n=3,ie(n);case 3:o=t.v,a=o.svg,i=o.isDirty,u(URL.createObjectURL(a)),d(i),t.n=5;break;case 4:u(URL.createObjectURL(n));case 5:return t.a(2)}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]),o.a.createElement("div",{className:i()({"reply-attachment-preview":!0,dirty:f})},o.a.createElement("img",{src:c}),f&&o.a.createElement("span",{className:"reply-attachment-preview-message"},n("message.svgMalicious")))},be=function(t){var e=t.files,n=t.isEditing,r=t.fileDeleted,a=fe(Object(l.e)((function(t){return[S.a.getTabManager(t),S.a.isReplyAttachmentPreviewEnabled(t)]})),2),i=a[0],c=a[1],u=fe(Object(s.a)(),1)[0],f=function(){var t=se(ce().m((function t(e,n){var r;return ce().w((function(t){for(;;)switch(t.n){case 0:if(e.preventDefault(),e.stopPropagation(),i){t.n=1;break}return t.a(2,console.warn("Can't open attachment in non-multi-tab mode"));case 1:if(!(n instanceof File)){t.n=2;break}r=n,t.n=5;break;case 2:if(!n.url){t.n=3;break}r=n.url,t.n=5;break;case 3:return t.n=4,Kt(n);case 4:r=t.v;case 5:r&&i.addTab(r,{filename:n.name,setActive:!0,saveCurrentActiveTabState:!0});case 6:return t.a(2)}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),d=function(){var t=se(ce().m((function t(e,n){var r,o;return ce().w((function(t){for(;;)switch(t.n){case 0:if(e.preventDefault(),e.stopPropagation(),!n.url){t.n=1;break}o=n.url,t.n=3;break;case 1:return t.n=2,Kt(n);case 2:o=t.v;case 3:r=o,Object(_t.saveAs)(r,n.name);case 4:return t.a(2)}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return o.a.createElement("div",{className:"reply-attachment-list"},e.map((function(t,e){return o.a.createElement("div",{className:"reply-attachment",key:e,onClick:function(e){return f(e,t)}},c&&Xt(t)&&o.a.createElement(pe,{file:t}),o.a.createElement("div",{className:"reply-attachment-info"},o.a.createElement(ot.a,{className:"reply-attachment-icon",glyph:Qt(t)}),o.a.createElement(at.a,{content:t.name},o.a.createElement("div",{className:"reply-file-name"},t.name)),n?o.a.createElement(mt.a,{className:"attachment-button",title:"".concat(u("action.delete")," ").concat(u("option.type.fileattachment")),img:"icon-close",onClick:function(e){return function(t,e){t.preventDefault(),t.stopPropagation(),r(e)}(e,t)}}):o.a.createElement(mt.a,{className:"attachment-button",title:"".concat(u("action.download")," ").concat(u("option.type.fileattachment")),img:"icon-download",onClick:function(e){return d(e,t)}})))})))},me=n(486),ye=n(382),ve=n(1470),ge=function(t){var e={};if(t["font-weight"]&&"normal"!==t["font-weight"]&&(e.bold=!0),t["font-style"]&&"normal"!==t["font-style"]&&(e.italic=!0),t.color&&(e.color=t.color),t["text-decoration"]){var n=t["text-decoration"].split(" ");n.includes("line-through")&&(e.strike=!0),n.includes("word")&&(e.underline=!0)}return e},he=function(t,e){for(var n=t.getRichTextStyle(),r=Object.keys(n),o=ye.a.getFormattedTextFromDeltas(e.getContents()),a=ye.a.extractMentionDataFromStr(o).plainTextValue,i=[],c=0;c<r.length;c++){var u=n[r[c]],l=ge(u);if(!isNaN(r[c])){var s=isNaN(r[c+1])?a.length:r[c+1],f=a.slice(r[c],s);i.push({insert:f,attributes:l})}}e.setContents(i),e.setSelection(a.length,0)},Oe=n(45),Ee=n(56),je=n(230),Se=n(61);n(1550);function we(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Ae(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,b=a[2];n>3?(o=b===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<b&&(o=n<3||a[0]>r||r>b)&&(a[4]=n,a[5]=r,d.n=b,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,b){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,b),c=s,u=b;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Ae(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Ae(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Ae(f,"constructor",l),Ae(l,"constructor",u),u.displayName="GeneratorFunction",Ae(l,o,"GeneratorFunction"),Ae(f),Ae(f,o,"Generator"),Ae(f,r,(function(){return this})),Ae(f,"toString",(function(){return"[object Generator]"})),(we=function(){return{w:a,m:d}})()}function Ae(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}(Ae=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Ae(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}})(t,e,n,r)}function Te(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Ce(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ne(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ne(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}b.a.extend(y.a);var Pe={annotation:u.a.object.isRequired,isEditing:u.a.bool,setIsEditing:u.a.func,noteIndex:u.a.number,isUnread:u.a.bool,isNonReplyNoteRead:u.a.bool,onReplyClicked:u.a.func,isMultiSelected:u.a.bool,isMultiSelectMode:u.a.bool,handleMultiSelect:u.a.func,isGroupMember:u.a.bool,handleNoteClick:u.a.func},Ie=function(t){var e,n=t.annotation,a=t.isEditing,c=t.setIsEditing,u=t.noteIndex,p=t.isUnread,b=t.isNonReplyNoteRead,m=t.onReplyClicked,y=t.isMultiSelected,v=t.isMultiSelectMode,h=t.handleMultiSelect,E=t.isGroupMember,w=t.handleNoteClick,T=void 0===w?function(){}:w,C=Object(j.a)().core,N=Object(l.e)((function(t){return S.a.getNoteDateFormat(t)})),P=Object(l.e)((function(t){return S.a.getIconColor(t,Object(Ee.g)(n),l.c)})),I=Object(l.e)((function(t){return S.a.isElementDisabled(t,"noteStateFlyout")})),x=Object(l.e)((function(t){return S.a.getCurrentLanguage(t)})),k=Object(l.e)((function(t){return S.a.notesShowLastUpdatedDate(t)})),D=Object(l.e)((function(t){return S.a.isNotesPanelTextCollapsingEnabled(t)})),_=Object(l.e)((function(t){return S.a.isNotesPanelRepliesCollapsingEnabled(t)})),M=Object(l.e)((function(t){return S.a.getActiveTheme(t)})),R=Object(l.e)((function(t){return S.a.getTimezone(t)})),L=Object(l.e)((function(t){var e;return null===(e=S.a.getFeatureFlags(t))||void 0===e?void 0:e.customizableUI})),F=Object(r.useContext)(f.a),H=F.isSelected,U=F.searchInput,G=F.resize,W=F.pendingEditTextMap,z=F.onTopNoteContentClicked,B=F.sortStrategy,V=F.showAnnotationNumbering,q=F.setPendingEditText,K=Object(l.d)(),$=Ce(Object(s.a)(),1)[0],Y=Object(l.f)(),J=n.isReply(),X=Object(Ee.g)(n)===Ee.c.TRACKED_CHANGE,Q=Ce(Object(r.useState)([]),2),Z=Q[0],tt=Q[1];Object(r.useEffect)((function(){tt(n.getAttachments())}),[n]),Object(r.useEffect)((function(){var t=function(t,e){"modify"===e&&t.forEach((function(t){t.Id===n.Id&&tt(t.getAttachments())}))};return C.addEventListener("annotationChanged",t),function(){C.removeEventListener("annotationChanged",t)}}),[n]),Object(je.a)((function(){a||K(A.a.finishNoteEditing()),G()}),[a]);var et,nt=Object(r.useCallback)((function(t){var e=C.getDisplayAuthor(t.Author);return e?Me(e,U):$("option.notesPanel.noteContent.noName")}),[U]),rt=n.getSkipAutoLink&&n.getSkipAutoLink(),ot={1:$("officeEditor.added"),2:$("officeEditor.deleted"),3:$("officeEditor.formatted")},at=Object(r.useCallback)((function(t,e,r,a){var i=[];if(a||d.a.link(t,{stripPrefix:!1,stripTrailingSlash:!1,replaceFn:function(t){var e=t.getAnchorHref(),n=t.getAnchorText(),r=t.getOffset();switch(t.getType()){case"url":case"email":case"phone":i.push({href:e,text:n,start:r,end:r+t.getMatchedText().length})}}}),!i.length){var c=Me(t,U,e);if(!U&&(!J&&D||J&&_)){return o.a.createElement(Dt,{linesToBreak:3,comment:!0,renderRichText:_e,richTextStyle:e,resize:G,style:r,beforeContent:function(){if(!X)return null;var t=ot[n.TrackedChangeType];return t&&o.a.createElement("span",{style:{color:n.FillColor.toString(),fontWeight:700}},t)}},t)}return c}var u=[],l=0;return i.forEach((function(n,r){var a=n.start,i=n.end,c=n.href;l<a&&u.push(o.a.createElement("span",{key:"span_".concat(r)},Me(t,U,e,l,a))),u.push(o.a.createElement("a",{href:c,target:"_blank",rel:"noopener noreferrer",key:"a_".concat(r)},Me(t,U,e,a,i))),l=i})),l<t.length-1&&u.push(Me(t,U,e,l)),u}),[U]),it=X&&3===n.TrackedChangeType?"ic-format-page":Object(Ee.e)(Object(Ee.g)(n)).icon;try{et=JSON.parse(n.getCustomData("trn-mention"))}catch(t){et=n.getCustomData("trn-mention")}var ct=(null===(e=et)||void 0===e?void 0:e.contents)||n.getContents();ct=function(t){return t?O()(t):t}(ct);var ut=n instanceof window.Core.Annotations.Link?Object(me.a)(n,Y):n.getContents(),lt=n.getRichTextStyle(),st=n.TextColor;if(M===Ot.a.DARK)st&&Object(gt.c)(st.toHexString())&&(st=new window.Core.Annotations.Color(255,255,255,1)),lt&&Object.keys(lt).forEach((function(t){lt[t].color&&Object(gt.c)(lt[t].color)&&(lt[t].color=jt.b.white)}));else if(M===Ot.a.LIGHT){if(st&&Object(gt.d)(st.toHexString())&&(st=new window.Core.Annotations.Color(0,0,0,1)),lt)Object.keys(lt).forEach((function(t){lt[t].color&&Object(gt.d)(lt[t].color)&&(lt[t].color=jt.b.black)}))}var ft,dt=void 0===W[n.Id];ft=ct&&dt?ct:W[n.Id];var pt=i()({NoteContent:!0,isReply:J,unread:p,clicked:b,"modular-ui":L}),bt=Object(r.useMemo)((function(){var t={};return st&&(t.color=st.toHexString()),o.a.createElement(o.a.Fragment,null,a&&H?o.a.createElement(ke,{annotation:n,noteIndex:u,setIsEditing:c,textAreaValue:ft,onTextAreaValueChange:q,pendingText:W[n.Id]}):ut&&o.a.createElement("div",{className:i()("container",{"reply-content":J}),onClick:T},J&&Z.length>0&&o.a.createElement(be,{files:Z,isEditing:!1}),at(ut,lt,t,rt)))}),[n,H,a,c,ct,at,ft,q,Z]),mt=n.getCustomData("trn-annot-preview"),vt=Object(r.useMemo)((function(){if(""===mt)return null;var t=Me(mt,U),e=!J&&D;return g()(t)&&e?o.a.createElement(Se.a,{onClick:T,className:"selected-text-preview",dataElement:"notesSelectedTextPreview"},o.a.createElement(Dt,{linesToBreak:3},'"'.concat(t,'"'))):o.a.createElement("div",{className:"selected-text-preview",style:{paddingRight:"12px"}},t)}),[mt,U]),ht=Object(r.useMemo)((function(){return o.a.createElement(Nt,{icon:it,iconColor:P,annotation:n,language:x,noteDateFormat:N,isSelected:H,setIsEditing:c,notesShowLastUpdatedDate:k,isReply:J,isUnread:p,renderAuthorName:nt,isNoteStateDisabled:I,isEditing:a,noteIndex:u,sortStrategy:B,activeTheme:M,handleMultiSelect:h,isMultiSelected:y,isMultiSelectMode:v,isGroupMember:E,showAnnotationNumbering:V,timezone:R,isTrackedChange:X})}),[it,P,n,x,N,H,c,k,J,p,nt,C.getDisplayAuthor(n.Author),I,a,u,Object(yt.a)(n),B,h,y,v,E,R,X]);return o.a.createElement("div",{className:pt,onClick:function(){E||(J?m(n):a||z())}},ht,vt,bt)};Ie.propTypes=Pe;var xe=Ie,ke=function(t){var e=t.annotation,n=t.noteIndex,a=t.setIsEditing,c=t.textAreaValue,u=t.onTextAreaValueChange,d=t.pendingText,p=Ce(Object(l.e)((function(t){return[S.a.getAutoFocusNoteOnAnnotationSelection(t),S.a.getIsMentionEnabled(t),S.a.isElementDisabled(t,w.a.INLINE_COMMENT_POPUP),S.a.isElementOpen(t,w.a.INLINE_COMMENT_POPUP),S.a.isElementOpen(t,w.a.NOTES_PANEL),S.a.getActiveDocumentViewerKey(t),S.a.isAnyCustomPanelOpen(t)]})),7),b=p[0],m=p[1],y=p[2],v=p[3],g=p[4],h=p[5],O=p[6],A=Ce(Object(s.a)(),1)[0],T=Object(r.useRef)(),C=e.isReply(),N=Object(r.useContext)(f.a),P=N.setCurAnnotId,I=N.pendingAttachmentMap,x=N.deleteAttachment,k=N.clearAttachments,D=N.addAttachments,_=!y&&v&&Object(Oe.k)(),M=Object(j.a)().core;Object(r.useEffect)((function(){if(O||(g||v)&&T.current){var t=T.current.getEditor();e&&e instanceof window.Core.Annotations.FreeTextAnnotation&&t.setText(""),d?Object(ve.a)(t,e):t.getContents()&&setTimeout((function(){if(m){c=ye.a.getFormattedTextFromDeltas(t.getContents());var n=ye.a.extractMentionDataFromStr(c),r=n.plainTextValue;n.ids.length&&t.setText(r)}var o;_||b&&(null===(o=T.current)||void 0===o||o.focus(),e.getRichTextStyle()&&he(e,t))}),100);var n=t.getLength()-1;if(_)return;setTimeout((function(){n&&t.setSelection(n,n)}),100)}}),[g,v,_]),Object(r.useEffect)((function(){if(C&&0===F.length){var t=e.getAttachments();D(e.Id,t)}}),[]);var R=function(){var t,r=(t=we().m((function t(r){var o,i,l,s,f;return we().w((function(t){for(;;)switch(t.n){case 0:return r.preventDefault(),o=T.current.getEditor(),c=ye.a.getFormattedTextFromDeltas(o.getContents()),Object(ve.a)(o,e),c.length>1&&"\n"===c[c.length-1]&&(c=c.slice(0,c.length-1)),e.getSkipAutoLink&&e.getSkipAutoLink()&&e.disableSkipAutoLink(),m?(i=ye.a.extractMentionDataFromStr(c),l=i.plainTextValue,s=i.ids,ye.a.extractMentionDataFromAnnot(e).mentions.forEach((function(t){l.includes(t.value)&&s.push(t.id)})),e.setCustomData("trn-mention",JSON.stringify({contents:c,ids:s})),e.setContents(l)):e.setContents(c),t.n=1,Yt(e,I[e.Id]);case 1:f=e instanceof window.Core.Annotations.FreeTextAnnotation?"textChanged":"noteChanged",M.getAnnotationManager(h).trigger("annotationChanged",[[e],"modify",{source:f}]),e instanceof window.Core.Annotations.FreeTextAnnotation&&M.drawAnnotationsFromList([e]),a(!1,n),""!==c&&u(void 0,e.Id),k(e.Id);case 2:return t.a(2)}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){Te(a,r,o,i,c,"next",t)}function c(t){Te(a,r,o,i,c,"throw",t)}i(void 0)}))});return function(t){return r.apply(this,arguments)}}(),L=i()("edit-content",{"reply-content":C}),F=I[e.Id]||[];return o.a.createElement("div",{className:L},C&&F.length>0&&o.a.createElement(be,{files:F,isEditing:!0,fileDeleted:function(t){return x(e.Id,t)}}),o.a.createElement(E.a,{ref:function(t){T.current=t},value:c,onChange:function(t){return u(t,e.Id)},onSubmit:R,isReply:C,onBlur:function(t){var e,n;null!==(e=t.relatedTarget)&&void 0!==e&&null!==(n=e.getAttribute("data-element"))&&void 0!==n&&n.includes("annotationCommentButton")?t.target.focus():P(void 0)},onFocus:function(){P(e.Id)}}),o.a.createElement("div",{className:"edit-buttons"},o.a.createElement(mt.a,{className:"cancel-button",label:A("action.cancel"),onClick:function(t){t.stopPropagation(),a(!1,n),u(void 0,e.Id),k(e.Id)}}),o.a.createElement(mt.a,{className:"save-button".concat(c?"":" disabled"),disabled:!c,label:A("action.save"),onClick:function(t){t.stopPropagation(),R(t)}})))};ke.propTypes={noteIndex:u.a.number.isRequired,annotation:u.a.object.isRequired,setIsEditing:u.a.func.isRequired,textAreaValue:u.a.string,onTextAreaValueChange:u.a.func.isRequired,pendingText:u.a.string};var De=function(t,e,n){var r={fontWeight:e["font-weight"],fontStyle:e["font-style"],textDecoration:e["text-decoration"],color:e.color};return r.textDecoration&&(r.textDecoration=r.textDecoration.replace("word","underline")),o.a.createElement("span",{style:r,key:n},t)},_e=function(t,e,n){if(!e||!t)return t;for(var r={},o=Object.keys(e).map(Number).sort((function(t,e){return t-e})),a=0;a<o.length;a++){var i=o[a]-n;if(r[i=Math.min(Math.max(i,0),t.length)]=e[o[a]],i===t.length)break}for(var c=[],u=Object.keys(r).map(Number).sort((function(t,e){return t-e})),l=1;l<u.length;l++)c.push(De(t.slice(u[l-1],u[l]),r[u[l-1]],"richtext_span_".concat(l)));return c},Me=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t.length,i=t.slice(r,a),c=i.toLowerCase(),u=e.toLowerCase();n&&(n[0]=n[0]||{},n[t.length]=n[t.length]||{});var l=c.indexOf(u);if(!u.trim()||-1===l)return _e(i,n,r);var s=[],f=[l],d=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");if(new RegExp("(".concat(d,")"),"gi").test(c))for(;-1!==l;)-1!==(l=c.indexOf(u,l+u.length))&&f.push(l);return f.forEach((function(t,e){0===e&&0!==t&&s.push(_e(i.substring(0,t),n,r)),s.push(o.a.createElement("span",{className:"highlight",key:"highlight_span_".concat(e)},_e(i.substring(t,t+u.length),n,r+t))),t+u.length<c.length&&t+u.length!==f[e+1]&&s.push(_e(i.substring(t+u.length,f[e+1]),n,r+t+u.length))})),s};var Re=xe;n(1551);function Le(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return Fe(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,b=a[2];n>3?(o=b===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<b&&(o=n<3||a[0]>r||r>b)&&(a[4]=n,a[5]=r,d.n=b,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,b){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,b),c=s,u=b;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(Fe(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,Fe(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,Fe(f,"constructor",l),Fe(l,"constructor",u),u.displayName="GeneratorFunction",Fe(l,o,"GeneratorFunction"),Fe(f),Fe(f,o,"Generator"),Fe(f,r,(function(){return this})),Fe(f,"toString",(function(){return"[object Generator]"})),(Le=function(){return{w:a,m:d}})()}function Fe(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}(Fe=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){Fe(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}})(t,e,n,r)}function He(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Ue(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Ge(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ge(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ge(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var We={annotation:u.a.object.isRequired},ze=function(t){var e=t.annotation,n=t.isUnread,a=t.onPendingReplyChange,c=Object(j.a)().core,u=Ue(Object(l.e)((function(t){var n;return[S.a.getAutoFocusNoteOnAnnotationSelection(t),S.a.isDocumentReadOnly(t),S.a.isElementDisabled(t,"noteReply"),null===(n=S.a.getIsReplyDisabled(t))||void 0===n?void 0:n(e),S.a.getIsMentionEnabled(t),S.a.getIsNoteEditing(t),S.a.isElementDisabled(t,w.a.INLINE_COMMENT_POPUP),S.a.isElementOpen(t,w.a.INLINE_COMMENT_POPUP),S.a.getActiveDocumentViewerKey(t)]}),l.c),9),s=u[0],d=u[1],p=u[2],b=u[3],m=u[4],y=u[5],v=u[6],g=u[7],h=u[8],O=Object(r.useContext)(f.a),T=O.isContentEditable,C=O.isSelected,N=O.pendingReplyMap,P=O.setPendingReply,I=O.isExpandedFromSearch,x=O.scrollToSelectedAnnot,k=O.setCurAnnotId,D=O.pendingAttachmentMap,_=O.clearAttachments,M=O.deleteAttachment,R=Ue(Object(r.useState)(!1),2),L=R[0],F=R[1],H=Object(l.d)(),U=Object(r.useRef)(),G=!v&&g&&Object(Oe.k)();Object(je.a)((function(){L||H(A.a.finishNoteEditing())}),[L]),Object(r.useEffect)((function(){G||y&&C&&!T&&s&&U&&U.current&&U.current.focus()}),[T,y,C,G]),Object(r.useEffect)((function(){if(!I&&x&&setTimeout((function(){U&&U.current&&s&&U.current.focus()}),100),U&&U.current){if(G)return;var t=U.current.getEditor().getLength()-1;setTimeout((function(){U.current&&U.current.editor.setSelection(t,t)}),100)}}),[]);var W=function(){var t,n=(t=Le().m((function t(n){var r,o,a,i;return Le().w((function(t){for(;;)switch(t.n){case 0:if(n.preventDefault(),n.stopPropagation(),r=U.current.getEditor(),(o=ye.a.getFormattedTextFromDeltas(r.getContents())).trim()){t.n=1;break}return t.a(2);case 1:if(!m){t.n=3;break}return a=ye.a.createMentionReply(e,o),Object(ve.a)(r,a),t.n=2,Yt(a,D[e.Id]);case 2:c.addAnnotations([a],h),t.n=5;break;case 3:return i=c.createAnnotationReply(e,o),Object(ve.a)(r,i),t.n=4,Yt(i,D[e.Id]);case 4:c.getAnnotationManager(h).trigger("annotationChanged",[[i],"modify",{}]);case 5:P("",e.Id),_(e.Id);case 6:return t.a(2)}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){He(a,r,o,i,c,"next",t)}function c(t){He(a,r,o,i,c,"throw",t)}i(void 0)}))});return function(t){return n.apply(this,arguments)}}(),z=d||p||b,B=i()({"reply-area":!0,unread:n}),V=D[e.Id]||[];return z||!C?null:o.a.createElement("form",{onSubmit:W,className:"reply-area-container"},V.length>0&&o.a.createElement(be,{files:V,isEditing:!0,fileDeleted:function(t){return M(e.Id,t)}}),o.a.createElement("div",{className:"reply-area-with-button"},o.a.createElement("div",{className:B,onMouseDown:function(t){return t.stopPropagation()}},o.a.createElement(E.a,{ref:function(t){U.current=t},value:N[e.Id],onChange:function(t){return function(t){P(t,e.Id),a&&a()}(t)},onSubmit:W,onBlur:function(){F(!1),k(void 0)},onFocus:function(){F(!0),k(e.Id)},isReply:!0})),o.a.createElement("div",{className:"reply-button-container"},o.a.createElement(mt.a,{img:"icon-post-reply",className:"reply-button",title:"action.submit",disabled:!N[e.Id],onClick:W,isSubmitType:!0}))))};ze.propTypes=We;var Be=ze;function Ve(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return qe(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qe(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var Ke={groupAnnotations:u.a.array.isRequired,isMultiSelectMode:u.a.bool.isRequired},$e=function(t){var e=t.groupAnnotations,n=t.isMultiSelectMode,a=Object(j.a)().core,c=Ve(Object(s.a)(),1)[0],u=Object(l.d)(),f=Ve(Object(r.useState)(!1),2),d=f[0],p=f[1],b=Object(l.e)((function(t){var e;return null===(e=S.a.getFeatureFlags(t))||void 0===e?void 0:e.customizableUI})),m=o.a.createElement(mt.a,{onClick:function(t){t.preventDefault(),t.stopPropagation(),p(!0)},className:"text-button",ariaLabel:c("component.noteGroupSection.open"),label:c("component.noteGroupSection.open"),img:"icon-chevron-down"}),y=o.a.createElement(mt.a,{onClick:function(t){t.preventDefault(),t.stopPropagation(),p(!1)},className:"text-button",ariaLabel:c("component.noteGroupSection.close"),label:c("component.noteGroupSection.close"),img:"icon-chevron-up"});return o.a.createElement("div",{className:i()({"group-section":!0,"modular-ui":b})},d?y:m,d&&e.map((function(t,e){return 0===e?null:o.a.createElement(mt.a,{key:t.Id,className:"group-child",onClick:function(e){e.preventDefault(),e.stopPropagation(),a.selectAnnotation(t),a.jumpToAnnotation(t),u(A.a.openElement("annotationPopup"))}},o.a.createElement(Re,{key:t.Id,annotation:t,isUnread:!1,isGroupMember:!0,isMultiSelectMode:n}))})))};$e.propTypes=Ke;var Ye=$e,Je=n(123),Xe=n(231),Qe=n(24),Ze=n(4),tn=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=window,r=n.isApryseWebViewerWebComponent,o=void 0!==r&&r;if(!o)return t;var a=Object(Qe.a)().getElementById("app").getBoundingClientRect(),i=a.left,c=a.top;return e?{x:t.x+i,y:t.y+c}:{x:t.x-i,y:t.y-c}},en=(n(1552),n(103)),nn=n.n(en);function rn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return on(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?on(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function on(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var an=function(t){var e=t.children,n=Object(Qe.a)().querySelector("#line-connector-root"),o=document.createElement("div");return o.setAttribute("data-element",w.a.ANNOTATION_NOTE_CONNECTOR_LINE),Object(r.useEffect)((function(){return n.appendChild(o),function(){return n.removeChild(o)}}),[o,n]),Object(Je.createPortal)(e,o)},cn={annotation:u.a.object,noteContainerRef:u.a.object,isCustomPanelOpen:u.a.bool},un=function(t){var e,n=t.annotation,a=t.noteContainerRef,c=t.isCustomPanelOpen,u=Object(j.a)().core,s=rn(Object(l.e)((function(t){return[S.a.getTopHeadersHeight(t),S.a.getBottomHeadersHeight(t),S.a.isElementOpen(t,w.a.ANNOTATION_NOTE_CONNECTOR_LINE),S.a.isElementOpen(t,w.a.NOTES_PANEL),S.a.isElementDisabled(t,w.a.ANNOTATION_NOTE_CONNECTOR_LINE),S.a.getDocumentContainerWidth(t),S.a.getDocumentContainerHeight(t),S.a.getActiveDocumentViewerKey(t)]}),l.c),8),f=s[0],d=s[1],p=s[2],b=s[3],m=s[4],y=s[5],v=s[6],g=s[7],h=Object(l.d)(),O=rn(Object(r.useState)(),2),E=O[0],T=O[1];Object(r.useEffect)((function(){var t=function(){h(A.a.closeElement(w.a.ANNOTATION_NOTE_CONNECTOR_LINE))};return u.addEventListener("pageNumberUpdated",t,void 0,g),function(){u.removeEventListener("pageNumberUpdated",t,g)}}),[]);var C=u.getScrollViewElement(g),N=nn()((function(t){var e=t.activeDocumentViewerKey,r=t.bottomHeadersHeight,o=t.topHeadersHeight,i=Object(Xe.d)(n,e),c=i.bottomRight,u=i.topLeft;if(a&&a.current){if(!(c&&u))return function(){h(A.a.closeElement(w.a.ANNOTATION_NOTE_CONNECTOR_LINE))};var l=function(t){var e,n=t.annotationTopLeft,r=t.annotationBottomRight,o=t.noteContainerRef,a=t.bottomHeadersHeight,i=t.topHeadersHeight,c=t.activeDocumentViewerKey,u=Ze.a.getScrollViewElement(c),l=u.scrollTop,s=u.scrollLeft,f=o.current.getBoundingClientRect(),d=null===(e=o.current.closest(".normal-notes-container, .virtualized-notes-container"))||void 0===e?void 0:e.getBoundingClientRect();if(f.bottom<(null==d?void 0:d.top)||f.top>(null==d?void 0:d.bottom))return{topLineStyle:{display:"none"},verticalLineStyle:{display:"none"},bottomLineStyle:{display:"none"},isPanelOnLeft:!1};n=tn(n,!0),r=tn(r,!0);var p,b=n.y-r.y,m=n.x-s>f.left;m?(p=n.x-f.right-s,p-=14):(p=f.left-r.x+s,p-=10);var y=.75*p,v=p-y,g=r.y-f.top+b/2-l,h=tn({x:m?f.right:f.left,y:f.top}),O={width:y+(m?2:0),top:h.y,left:h.x-(m?0:y)},E={height:Math.abs(g)-2,top:O.top+2,left:O.left+(m?y:0)};g<0&&(E.top=O.top-E.height);var j=!1,S=Object(Qe.a)().getElementById("app").getBoundingClientRect(),w=i;if(w>E.top){var A=E.top-w;E.top=w,E.height+=A,j=!0}var T=S.height-a;return E.top+E.height>T&&(E.height=T-E.top,j=!0),{topLineStyle:O,verticalLineStyle:E,bottomLineStyle:{width:v+(m?2:0),top:h.y+g,left:E.left+2-(m?2:v),visibility:j?"hidden":"visible"},isPanelOnLeft:m}}({annotationTopLeft:u,annotationBottomRight:c,noteContainerRef:a,bottomHeadersHeight:r,topHeadersHeight:o,activeDocumentViewerKey:e});T(l)}}),100,{leading:!0,trailing:!0}),P=Object(Xe.d)(n,g),I=P.bottomRight,x=P.topLeft,k=[null==I?void 0:I.x,null==I?void 0:I.y,null==x?void 0:x.x,null==x?void 0:x.y],D=[C,null==C?void 0:C.scrollTop,null==C?void 0:C.scrollLeft],_=[y,v,g,d,f],M=null==a||null===(e=a.current)||void 0===e?void 0:e.getBoundingClientRect(),R=[null==M?void 0:M.top,null==M?void 0:M.left,null==M?void 0:M.right,null==M?void 0:M.bottom];if(Object(r.useEffect)((function(){N({activeDocumentViewerKey:g,bottomHeadersHeight:d,topHeadersHeight:f})}),[].concat(R,k,D,_)),Object(r.useEffect)((function(){var t=function(){h(A.a.closeElement(w.a.ANNOTATION_NOTE_CONNECTOR_LINE))};return u.addEventListener("pageNumberUpdated",t,void 0,g),function(){u.removeEventListener("pageNumberUpdated",t,g)}}),[h,g]),p&&(b||c)&&!m&&E){var L=E.topLineStyle,F=E.verticalLineStyle,H=E.bottomLineStyle,U=E.isPanelOnLeft;return o.a.createElement(an,null,o.a.createElement("div",{className:"horizontalLine",style:L}),o.a.createElement("div",{className:"verticalLine",style:F}),o.a.createElement("div",{className:"horizontalLine",style:H},o.a.createElement("div",{className:i()("arrowHead",{"arrow-right":U})})))}return null};un.propTypes=cn;var ln=un,sn=(n(1553),n(1503));function fn(t){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dn(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var u=r&&r.prototype instanceof c?r:c,l=Object.create(u.prototype);return pn(l,"_invoke",function(n,r,o){var a,c,u,l=0,s=o||[],f=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return a=e,c=0,u=t,d.n=n,i}};function p(n,r){for(c=n,u=r,e=0;!f&&l&&!o&&e<s.length;e++){var o,a=s[e],p=d.p,b=a[2];n>3?(o=b===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,d.v=r,d.n=a[1]):p<b&&(o=n<3||a[0]>r||r>b)&&(a[4]=n,a[5]=r,d.n=b,c=0))}if(o||n>1)return i;throw f=!0,r}return function(o,s,b){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,b),c=s,u=b;(e=c<2?t:u)||!f;){a||(c?c<3?(c>1&&(d.n=-1),p(c,u)):d.n=u:d.v=u);try{if(l=2,a){if(c||(o="next"),e=a[o]){if(!(e=e.call(a,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=a.return)&&e.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((e=(f=d.n<0)?u:n.call(r,d))!==i)break}catch(e){a=t,c=1,u=e}finally{l=1}}return{value:e,done:f}}}(n,o,a),!0),l}var i={};function c(){}function u(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(pn(e={},r,(function(){return this})),e),f=l.prototype=c.prototype=Object.create(s);function d(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,pn(t,o,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=l,pn(f,"constructor",l),pn(l,"constructor",u),u.displayName="GeneratorFunction",pn(l,o,"GeneratorFunction"),pn(f),pn(f,o,"Generator"),pn(f,r,(function(){return this})),pn(f,"toString",(function(){return"[object Generator]"})),(dn=function(){return{w:a,m:d}})()}function pn(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}(pn=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{var a=function(e,n){pn(t,e,(function(t){return this._invoke(e,n,t)}))};a("next",0),a("throw",1),a("return",2)}})(t,e,n,r)}function bn(t,e,n,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function mn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function yn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mn(Object(n),!0).forEach((function(e){vn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function vn(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=fn(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=fn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==fn(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return hn(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var On={annotation:u.a.object.isRequired,isMultiSelected:u.a.bool,isMultiSelectMode:u.a.bool,isInNotesPanel:u.a.bool,handleMultiSelect:u.a.func},En=0,jn=function(t){var e=t.annotation,n=t.isMultiSelected,a=t.isMultiSelectMode,c=t.isInNotesPanel,u=t.handleMultiSelect,d=t.isCustomPanelOpen,p=t.shouldHideConnectorLine,b=Object(j.a)().core,m=Object(r.useContext)(f.a),y=m.isSelected,v=m.resize,g=m.pendingEditTextMap,h=m.isContentEditable,O=m.isDocumentReadOnly,E=m.isExpandedFromSearch,T=m.setCurAnnotId,C=Object(r.useRef)(),N=Object(r.useRef)(),P=gn(Object(r.useState)({}),2),I=P[0],x=P[1],k=Object(r.useRef)([]),D=Object(l.d)(),_=gn(Object(s.a)(),1)[0],M=new Set,R=gn(Object(l.e)((function(t){return[S.a.getNoteTransformFunction(t),S.a.getCustomNoteSelectionFunction(t),S.a.getUnreadAnnotationIdSet(t),S.a.isCommentThreadExpansionEnabled(t),S.a.isRightClickAnnotationPopupEnabled(t),S.a.getActiveDocumentViewerKey(t),S.a.getIsOfficeEditorMode(t),S.a.getOfficeEditorEditMode(t)]}),l.c),8),L=R[0],F=R[1],H=R[2],U=R[3],G=R[4],W=R[5],z=R[6],B=R[7],V=Object(r.useCallback)((function(t,e){x((function(n){return yn(yn({},n),{},vn({},e,t))}))}),[x]),q=e.getReplies().sort((function(t,e){return t.DateCreated-e.DateCreated}));q.filter((function(t){return H.has(t.Id)})).forEach((function(t){return M.add(t.Id)})),Object(r.useEffect)((function(){var t=function(t,e){"delete"===e&&t.forEach((function(t){H.has(t.Id)&&D(A.a.setAnnotationReadState({isRead:!0,annotationId:t.Id}))}))};return b.addEventListener("annotationChanged",t,void 0,W),function(){b.removeEventListener("annotationChanged",t,W)}}),[H]),Object(r.useEffect)((function(){var t=N.current,e=C.current.getBoundingClientRect().height;N.current=e,t&&Math.round(t)!==Math.round(e)&&v()})),Object(r.useEffect)((function(){if(L){var t=Object(Qe.a)().querySelectorAll(".NotesPanel")[0];k.current.forEach((function(e){var n=t.querySelector("[data-webviewer-custom-element=".concat(e,"]"));n&&n.parentNode.removeChild(n)})),k.current=[];var n={annotation:e,isSelected:y};L(C.current,n,(function(){var t,e=(t=document).createElement.apply(t,arguments),n="custom-element-".concat(En);return En++,k.current.push(n),e.setAttribute("data-webviewer-custom-element",n),e.addEventListener("mousedown",(function(t){t.stopPropagation()})),e}))}})),Object(r.useEffect)((function(){""!==g[e.Id]&&h&&!O&&V(!0,0)}),[O,h,V,e,a]),Object(je.a)((function(){!O&&h||V(!1,0)}),[O,h,V]);var K=function(){var t,r=(t=dn().m((function t(r){var o;return dn().w((function(t){for(;;)switch(t.n){case 0:if(r&&r.stopPropagation(),!window.getSelection().toString()){t.n=1;break}return t.a(2);case 1:if(!a){t.n=2;break}return u(!n),t.a(2);case 2:if(H.has(e.Id)&&D(A.a.setAnnotationReadState({isRead:!0,annotationId:e.Id})),F&&F(e),y||(b.deselectAllAnnotations(W),setTimeout((function(){return D(A.a.openElement(w.a.ANNOTATION_NOTE_CONNECTOR_LINE))}),300)),!c||z&&B===Et.C.PREVIEW){t.n=3;break}if(b.selectAnnotation(e,W),T(e.Id),b.jumpToAnnotation(e,W),G||D(A.a.openElement(w.a.ANNOTATION_POPUP)),!z){t.n=3;break}return o=e.getCustomData(Et.z),t.n=3,b.getOfficeEditor().moveCursorToTrackedChange(o);case 3:return t.a(2)}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(t){bn(a,r,o,i,c,"next",t)}function c(t){bn(a,r,o,i,c,"throw",t)}i(void 0)}))});return function(t){return r.apply(this,arguments)}}(),$=M.size>0,Y=i()({Note:!0,expanded:y,"is-multi-selected":n,unread:H.has(e.Id)||$,disabled:z&&B===Et.C.PREVIEW}),J=i()({replies:!0,hidden:!y});Object(r.useEffect)((function(){a||q.forEach((function(t,e){var n=g[t.Id];""!==n&&void 0!==n&&y&&V(!0,1+e)}))}),[y,a]),Object(r.useEffect)((function(){a&&V(!1,0)}),[a]);var X=!Object.values(I).some((function(t){return t})),Q=function(t){M.has(t.Id)&&(D(A.a.setAnnotationReadState({isRead:!0,annotationId:t.Id})),b.getAnnotationManager(W).selectAnnotation(t))},Z=function(){if(M.size>0){var t=q.filter((function(t){return M.has(t.Id)}));b.getAnnotationManager(W).selectAnnotations(t),t.forEach((function(t){return D(A.a.setAnnotationReadState({isRead:!0,annotationId:t.Id}))}))}},tt=b.getGroupAnnotations(e,W),et=tt.length>1,nt=Object(Ee.g)(e)===Ee.c.TRACKED_CHANGE,rt=q.length>0?q[q.length-1].Id:null,ot=Object(sn.a)(b,e),at=y&&(c||d)&&!p&&ot;return o.a.createElement("div",{ref:C,className:Y,id:"note_".concat(e.Id)},o.a.createElement(mt.a,{className:"note-button",onClick:function(t){return K(t)},ariaLabelledby:"note_".concat(e.Id),ariaCurrent:y,dataElement:"expandNoteButton"}),o.a.createElement(Re,{noteIndex:0,annotation:e,setIsEditing:V,handleNoteClick:K,isEditing:I[0],isNonReplyNoteRead:!H.has(e.Id),isUnread:H.has(e.Id)||$,handleMultiSelect:function(t){T(e.Id),u(t)},isMultiSelected:n,isMultiSelectMode:a}),(y||E||U)&&!nt&&o.a.createElement(o.a.Fragment,null,q.length>0&&o.a.createElement("div",{className:J},$&&o.a.createElement(mt.a,{dataElement:"markAllReadButton",className:"mark-all-read-button",label:_("action.markAllRead"),onClick:Z}),q.map((function(t,e){return o.a.createElement("div",{className:"reply",id:"note_reply_".concat(t.Id),key:"note_reply_".concat(t.Id)},o.a.createElement(Re,{noteIndex:e+1,key:t.Id,annotation:t,setIsEditing:V,isEditing:I[e+1],onReplyClicked:Q,isUnread:H.has(t.Id),handleMultiSelect:u,isMultiSelected:n,isMultiSelectMode:a,handleNoteClick:K}))}))),et&&o.a.createElement(Ye,{groupAnnotations:tt,isMultiSelectMode:a}),X&&!a&&o.a.createElement(Be,{isUnread:rt&&H.has(rt),onPendingReplyChange:Z,annotation:e})),at&&o.a.createElement(ln,{annotation:e,noteContainerRef:C,isCustomPanelOpen:d}))};jn.propTypes=On;var Sn=jn;e.a=Sn},1754:function(t,e,n){t.exports={LEFT_HEADER_WIDTH:"41px",RIGHT_HEADER_WIDTH:"41px"}},1867:function(t,e,n){"use strict";n.r(e);n(9),n(10),n(14),n(31),n(38),n(36),n(27),n(21),n(77),n(20),n(12),n(22),n(128),n(32),n(18),n(16),n(29),n(47),n(23),n(46),n(48),n(37),n(8),n(17),n(19),n(11),n(30),n(13);var r=n(0),o=n.n(r),a=n(6),i=n(185),c=n.n(i),u=n(15),l=n.n(u),s=n(1),f=n.n(s),d=n(307),p=n(1448),b=n(1558),m=n(1554),y=n(44),v=n(5),g=n(56);n(1754);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){j(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function j(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=h(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==h(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return w(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var A={isMobile:f.a.bool,isUndraggable:f.a.bool,isNotesPanelClosed:f.a.bool,popupRef:f.a.any,position:f.a.object,closeAndReset:f.a.func,commentingAnnotation:f.a.object,contextValue:f.a.object,annotationForAttachment:f.a.string,addAttachments:f.a.func},T=function(t){var e=t.isMobile,n=t.isUndraggable,a=t.isNotesPanelClosed,i=t.popupRef,u=t.position,s=t.closeAndReset,f=t.commentingAnnotation,h=t.contextValue,O=t.annotationForAttachment,j=t.addAttachments,w=S(Object(d.a)(),1)[0],A=S(Object(r.useState)(!1),2),T=A[0],C=A[1],N=Object(g.g)(f)===g.c.TRACKED_CHANGE,P=o.a.createElement("div",{className:l()({Popup:!0,InlineCommentingPopup:!0,open:a,trackedChangePopup:N}),ref:i,"data-element":v.a.INLINE_COMMENT_POPUP,style:E({},u),onMouseMove:function(t){t.stopPropagation()},onMouseDown:function(t){e&&(t.stopPropagation(),s())},onKeyDown:function(t){"Escape"===t.key&&s()}},o.a.createElement("div",{className:l()({"inline-comment-container":!0,expanded:T}),onMouseDown:function(t){e&&t.stopPropagation()}},e&&o.a.createElement("div",{className:"inline-comment-header"},o.a.createElement(y.a,{img:T?"icon-chevron-down":"icon-chevron-up",className:"expand-arrow",dataElement:v.a.INLINE_COMMENT_POPUP_EXPAND_BUTTON,onClick:function(){return C(!T)}}),o.a.createElement("span",{className:"inline-comment-header-title"},w("action.comment")),o.a.createElement(y.a,{img:"icon-close",dataElement:v.a.INLINE_COMMENT_POPUP_CLOSE_BUTTON,onClick:s})),o.a.createElement(p.a.Provider,{value:h},o.a.createElement(b.a,{annotation:f,isMultiSelected:!1,isMultiSelectMode:!1,handleMultiSelect:function(){}}),o.a.createElement(m.a,{annotationId:O,addAttachments:j}))));return n||N?P:o.a.createElement(c.a,{cancel:".Button, .cell, svg, select, button, input, .quill, .note-text-preview"},P)};T.propTypes=A;var C=T,N=n(33),P=n(231),I=n(220),x=n(148),k=n(2),D=n(3),_=n(45),M=n(24),R=n(103),L=n.n(R),F=n(59);function H(t){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||V(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?G(Object(n),!0).forEach((function(e){z(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function z(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=H(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==H(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function B(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(t,e)||V(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(t,e){if(t){if("string"==typeof t)return q(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(t,e):void 0}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var K={annotation:f.a.object,closeAndReset:f.a.func},$=function(t){var e=t.annotation,n=t.closeAndReset,i=Object(N.a)().core,c=B(Object(a.e)((function(t){return[D.a.isElementOpen(t,v.a.NOTES_PANEL),D.a.getNotesInLeftPanel(t),D.a.isElementOpen(t,v.a.LEFT_PANEL),D.a.getActiveLeftPanel(t),D.a.isAnnotationNumberingEnabled(t),D.a.getSortStrategy(t),D.a.isDocumentReadOnly(t),D.a.getActiveDocumentViewerKey(t)]}),a.c),8),u=c[0],l=c[1],s=c[2],f=c[3],d=c[4],p=c[5],b=c[6],m=c[7],y=Object(a.d)(),g=B(Object(r.useState)({left:0,top:0}),2),h=g[0],O=g[1],E=Object(r.useRef)(),j=Object(_.k)(),S=j||!!_.l||_.e,w=u||l&&s&&"notesPanel"===f;Object(x.a)(E,(function(t){var n=Object(M.a)().querySelector('[data-element="notesPanel"]'),r=null==n?void 0:n.contains(t.target),o=Object(M.a)().querySelector('[data-element="noteStateFlyout-'.concat(e.Id,'"]')),a=null==o?void 0:o.contains(t.target),i=Object(I.b)(),c=Object(I.d)(),u=Object(I.c)();r||a||c||u||i||y(k.a.closeElement(v.a.INLINE_COMMENT_POPUP))}));var A=!w,T=function(){A&&E.current&&!j&&O(Object(P.c)(e,E,m))};Object(r.useLayoutEffect)((function(){T()}),[m,e]);var R=L()((function(){T()}),16,{trailing:!0,leading:!1});Object(r.useLayoutEffect)((function(){return window.addEventListener("resize",R),function(){window.removeEventListener("resize",R)}}),[]);var H=B(Object(r.useState)({}),2),G=H[0],V=H[1],q=function(t,e){V((function(n){return W(W({},n),{},z({},t,[].concat(U(n[t]||[]),U(e))))}))},K=B(Object(r.useState)(void 0),2),$=K[0],Y=K[1],J=B(Object(r.useState)({}),2),X=J[0],Q=J[1],Z=Object(r.useCallback)((function(t,e){Q((function(n){return W(W({},n),{},z({},e,t))}))}),[Q]),tt=B(Object(r.useState)({}),2),et=tt[0],nt=tt[1],rt=Object(r.useCallback)((function(t,e){nt((function(n){return W(W({},n),{},z({},e,t))}))}),[nt]),ot={searchInput:"",resize:function(){var t;(null===(t=i.getDocument())||void 0===t?void 0:t.getType())===F.a.OFFICE_EDITOR&&O(Object(P.c)(e,E,m))},isSelected:!0,isContentEditable:i.canModifyContents(e)&&!e.getContents(),pendingEditTextMap:X,setPendingEditText:Z,pendingReplyMap:et,setPendingReply:rt,isDocumentReadOnly:b,onTopNoteContentClicked:function(){},isExpandedFromSearch:!1,scrollToSelectedAnnot:!1,sortStrategy:p,showAnnotationNumbering:d,setCurAnnotId:Y,pendingAttachmentMap:G,addAttachments:q,clearAttachments:function(t){V((function(e){return W(W({},e),{},z({},t,[]))}))},deleteAttachment:function(t,e){var n=G[t];if((null==n?void 0:n.length)>0){var r=n.indexOf(e);r>-1&&(n.splice(r,1),V((function(e){return W(W({},e),{},z({},t,U(n)))})))}}};return o.a.createElement(C,{isMobile:j,isUndraggable:S,isNotesPanelClosed:A,popupRef:E,position:h,closeAndReset:n,commentingAnnotation:e,contextValue:ot,annotationForAttachment:$,addAttachments:q})};$.propTypes=K;var Y=$;e.default=Y}}]);
//# sourceMappingURL=chunk.29.js.map