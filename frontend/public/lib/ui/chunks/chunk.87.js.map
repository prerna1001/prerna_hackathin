{"version":3,"sources":["webpack:///./src/ui/src/components/LinkModal/LinkModal.js","webpack:///./src/ui/src/components/LinkModal/index.js"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","enumerable","configurable","writable","_invoke","asyncGeneratorStep","Promise","resolve","then","_slicedToArray","Array","isArray","_arrayWithHoles","next","push","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_arrayLikeToArray","toString","slice","constructor","name","from","test","LinkModal","_ref","rightClickedAnnotation","setRightClickedAnnotation","core","useCore","_useSelector2","useSelector","state","selectors","isElementDisabled","DataElements","LINK_MODAL","isElementOpen","getTotalPages","getCurrentPage","getSelectedTab","getPageLabels","isRightClickAnnotationPopupEnabled","getActiveDocumentViewerKey","isDisabled","isOpen","totalPages","currentPage","tabSelected","pageLabels","activeDocumentViewerKey","selectedTab","useTranslation","dispatch","useDispatch","urlInput","React","createRef","pageLabelInput","_useState2","useState","url","setURL","_useState4","pageLabel","setPageLabel","isRightClickedAnnotationSelected","isAnnotationSelected","selectedAnnotations","getSelectedAnnotations","annotManager","getAnnotationManager","closeModal","actions","closeElement","setToolMode","defaultTool","newLink","x","width","height","linkPageNumber","arguments","undefined","link","window","Core","Annotations","Link","PageNumber","StrokeColor","Color","StrokeStyle","StrokeThickness","Author","getCurrentUser","Subject","X","Y","Width","Height","createLink","action","linksResults","quads","getSelectedTextQuads","selectedText","getSelectedText","_loop","currPageNumber","currPageLinks","forEach","quad","Math","min","x1","x3","y1","y3","abs","parseInt","createHighlightAnnot","apply","annot","groupedAnnots","getGroupAnnotations","linksToDelete","filter","deleteAnnotations","addAction","addAnnotations","groupAnnotations","_ref2","_callee","linkAnnotArray","text","linkAnnot","highlight","_context","TextHighlightAnnotation","Opacity","Quads","setContents","index","_next","_throw","_x","_x2","_x3","_x4","addURLLink","preventDefault","urlWithProtocol","isValidURI","concat","Actions","URI","uri","pageNumbersToDraw","map","_toConsumableArray","Set","pageNumberToDraw","drawAnnotations","addPageLink","options","dest","Dest","GoTo","page","indexOf","useEffect","urls","match","current","focus","addEventListener","removeEventListener","modalClass","classNames","Modal","open","closed","createElement","DataElementWrapper","dataElement","className","ModalWrapper","title","closeHandler","onCloseClick","swipeToClose","onMouseDown","stopPropagation","Tabs","id","Tab","TabPanel","onSubmit","htmlFor","ref","onChange","target","Button","label","onClick","disabled","includes"],"mappings":"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","file":"chunks/chunk.87.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport classNames from 'classnames';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { useTranslation } from 'react-i18next';\nimport defaultTool from 'constants/defaultTool';\nimport useCore from 'hooks/useCore';\nimport { Tabs, Tab, TabPanel } from 'components/Tabs';\nimport Button from 'components/Button';\nimport actions from 'actions';\nimport selectors from 'selectors';\nimport DataElements from 'constants/dataElement';\nimport ModalWrapper from 'components/ModalWrapper';\nimport DataElementWrapper from 'components/DataElementWrapper';\n\nimport './LinkModal.scss';\n\nconst LinkModal = ({ rightClickedAnnotation, setRightClickedAnnotation }) => {\n  const { core } = useCore();\n  const [\n    isDisabled,\n    isOpen,\n    totalPages,\n    currentPage,\n    tabSelected,\n    pageLabels,\n    isRightClickAnnotationPopupEnabled,\n    activeDocumentViewerKey,\n    selectedTab,\n  ] = useSelector((state) => [\n    selectors.isElementDisabled(state, DataElements.LINK_MODAL),\n    selectors.isElementOpen(state, DataElements.LINK_MODAL),\n    selectors.getTotalPages(state),\n    selectors.getCurrentPage(state),\n    selectors.getSelectedTab(state, DataElements.LINK_MODAL),\n    selectors.getPageLabels(state),\n    selectors.isRightClickAnnotationPopupEnabled(state),\n    selectors.getActiveDocumentViewerKey(state),\n    selectors.getSelectedTab(state, 'linkModal'),\n  ]);\n  const [t] = useTranslation();\n  const dispatch = useDispatch();\n\n  const urlInput = React.createRef();\n  const pageLabelInput = React.createRef();\n\n  const [url, setURL] = useState('');\n  const [pageLabel, setPageLabel] = useState('');\n  const isRightClickedAnnotationSelected = core.isAnnotationSelected(rightClickedAnnotation, activeDocumentViewerKey);\n  const selectedAnnotations = core.getSelectedAnnotations(activeDocumentViewerKey);\n  const annotManager = core.getAnnotationManager(activeDocumentViewerKey);\n\n  const closeModal = () => {\n    dispatch(actions.closeElement(DataElements.LINK_MODAL));\n    setURL('');\n    core.setToolMode(defaultTool);\n    setRightClickedAnnotation(null);\n  };\n\n  const newLink = (x, y, width, height, linkPageNumber = currentPage) => {\n    const link = new window.Core.Annotations.Link();\n    link.PageNumber = linkPageNumber;\n    link.StrokeColor = new window.Core.Annotations.Color(0, 165, 228);\n    link.StrokeStyle = 'underline';\n    link.StrokeThickness = 2;\n    link.Author = core.getCurrentUser();\n    link.Subject = 'Link';\n    link.X = x;\n    link.Y = y;\n    link.Width = width;\n    link.Height = height;\n    return link;\n  };\n\n  const createLink = (action) => {\n    const linksResults = [];\n\n    const quads = core.getSelectedTextQuads(activeDocumentViewerKey);\n\n    // If annotation popup is on right click, this won't clear selected text if there's any, adding links will add links for both right-clicked annotation and selected text\n    if (quads) {\n      const selectedText = core.getSelectedText(activeDocumentViewerKey);\n      for (const currPageNumber in quads) {\n        const currPageLinks = [];\n        quads[currPageNumber].forEach((quad) => {\n          currPageLinks.push(\n            newLink(\n              Math.min(quad.x1, quad.x3),\n              Math.min(quad.y1, quad.y3),\n              Math.abs(quad.x1 - quad.x3),\n              Math.abs(quad.y1 - quad.y3),\n              parseInt(currPageNumber)\n            )\n          );\n        });\n        createHighlightAnnot(\n          currPageLinks,\n          quads[currPageNumber],\n          selectedText,\n          action\n        );\n        linksResults.push(...currPageLinks);\n      }\n    }\n\n    const annotationsToAddLink = (!isRightClickAnnotationPopupEnabled || isRightClickedAnnotationSelected) ? selectedAnnotations : [rightClickedAnnotation];\n\n    annotationsToAddLink.forEach((annot) => {\n      if (!annot) {\n        return;\n      }\n      const groupedAnnots = annotManager.getGroupAnnotations(annot);\n      if (groupedAnnots.length > 1) {\n        const linksToDelete = groupedAnnots.filter((annot) => annot instanceof window.Core.Annotations.Link);\n        if (linksToDelete.length > 0) {\n          core.deleteAnnotations(linksToDelete, activeDocumentViewerKey);\n        }\n      }\n\n      // if multi-select an annotation with no link option with an annotation with link option and right click on the latter, link button will show up and will add links for all annotations\n      const link = newLink(annot.X, annot.Y, annot.Width, annot.Height);\n      link.addAction('U', action);\n      core.addAnnotations([link], activeDocumentViewerKey);\n      linksResults.push(link);\n      annotManager.groupAnnotations(annot, [link]);\n    });\n\n    return linksResults;\n  };\n\n  const createHighlightAnnot = async (linkAnnotArray, quads, text, action) => {\n    const linkAnnot = linkAnnotArray[0];\n    const highlight = new window.Core.Annotations.TextHighlightAnnotation();\n    highlight.PageNumber = linkAnnot.PageNumber;\n    highlight.X = linkAnnot.X;\n    highlight.Y = linkAnnot.Y;\n    highlight.Width = linkAnnot.Width;\n    highlight.Height = linkAnnot.Height;\n    highlight.StrokeColor = new window.Core.Annotations.Color(0, 0, 0, 0);\n    highlight.Opacity = 0;\n    highlight.Quads = quads;\n    highlight.Author = core.getCurrentUser(activeDocumentViewerKey);\n    highlight.setContents(text);\n\n    linkAnnotArray.forEach((link, index) => {\n      link.addAction('U', action);\n      index === 0 ? core.addAnnotations([link, highlight], activeDocumentViewerKey) : core.addAnnotations([link], activeDocumentViewerKey);\n    });\n    annotManager.groupAnnotations(highlight, linkAnnotArray, activeDocumentViewerKey);\n  };\n\n  const addURLLink = (e) => {\n    e.preventDefault();\n\n    if (!url.length) {\n      return;\n    }\n\n    let urlWithProtocol;\n    if (!core.isValidURI(url)) {\n      urlWithProtocol = `https://${url}`;\n    } else {\n      urlWithProtocol = url;\n    }\n\n    const action = new window.Core.Actions.URI({ uri: urlWithProtocol });\n    const links = createLink(action);\n\n    let pageNumbersToDraw = links.map((link) => link.PageNumber);\n    pageNumbersToDraw = [...new Set(pageNumbersToDraw)];\n    pageNumbersToDraw.forEach((pageNumberToDraw) => {\n      core.drawAnnotations(pageNumberToDraw, null, true, undefined, activeDocumentViewerKey);\n    });\n\n    closeModal();\n  };\n\n  const isValidPageLabel = () => {\n    return pageLabels?.includes(pageLabel);\n  };\n\n  const addPageLink = (e) => {\n    e.preventDefault();\n\n    const Dest = window.Core.Actions.GoTo.Dest;\n\n    const options = { dest: new Dest({ page: pageLabels.indexOf(pageLabel) + 1 }) };\n    const action = new window.Core.Actions.GoTo(options);\n\n    const links = createLink(action);\n\n    let pageNumbersToDraw = links.map((link) => link.PageNumber);\n    pageNumbersToDraw = [...new Set(pageNumbersToDraw)];\n    pageNumbersToDraw.forEach((pageNumberToDraw) => {\n      core.drawAnnotations(pageNumberToDraw, null, true, undefined, activeDocumentViewerKey);\n    });\n\n    closeModal();\n  };\n\n  useEffect(() => {\n    if (isOpen) {\n      //  prepopulate URL if URL is selected\n      const selectedText = core.getSelectedText(activeDocumentViewerKey);\n      if (selectedText) {\n        const urlRegex = /(http(s)?:\\/\\/.)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)/g;\n        const urls = selectedText.match(urlRegex);\n        if (urls && urls.length > 0) {\n          setURL(urls[0]);\n        }\n      }\n\n      setPageLabel(pageLabels.length > 0 ? pageLabels[0] : '1');\n    }\n  }, [totalPages, isOpen]);\n\n  useEffect(() => {\n    if (tabSelected === 'PageNumberPanelButton' && isOpen) {\n      pageLabelInput.current.focus();\n    } else if (tabSelected === 'URLPanelButton' && isOpen) {\n      urlInput.current.focus();\n    }\n  }, [tabSelected, isOpen, pageLabelInput, urlInput]);\n\n  useEffect(() => {\n    core.addEventListener('documentUnloaded', closeModal);\n    return () => {\n      core.removeEventListener('documentUnloaded', closeModal);\n    };\n  }, []);\n\n  const modalClass = classNames({\n    Modal: true,\n    LinkModal: true,\n    open: isOpen,\n    closed: !isOpen,\n  });\n\n  return isDisabled ? null : (\n    <DataElementWrapper dataElement={DataElements.LINK_MODAL} className={modalClass}>\n      <ModalWrapper\n        title={t('link.insertLinkOrPage')}\n        isOpen={isOpen}\n        closeHandler={closeModal}\n        onCloseClick={closeModal}\n        swipeToClose>\n        <div className=\"container\" onMouseDown={(e) => e.stopPropagation()}>\n          <Tabs id=\"linkModal\">\n            <div className=\"tabs-header-container\">\n              <div className=\"tab-list\">\n                <Tab dataElement=\"URLPanelButton\" >\n                  <button className=\"tab-options-button\">{t('link.url')}</button>\n                </Tab>\n                <div className=\"tab-options-divider\" />\n                <Tab dataElement=\"PageNumberPanelButton\">\n                  <button className=\"tab-options-button\">{t('link.page')}</button>\n                </Tab>\n              </div>\n            </div>\n            <TabPanel dataElement=\"URLPanel\">\n              <div className=\"panel-body\">\n                <div className=\"add-url-link\">\n                  <form onSubmit={addURLLink}>\n                    <label htmlFor=\"urlInput\" className=\"inputLabel\">{t('link.enterUrlAlt')}</label>\n                    <div className=\"linkInput\">\n                      <input\n                        id=\"urlInput\"\n                        className=\"urlInput\"\n                        ref={urlInput}\n                        value={url}\n                        onChange={(e) => setURL(e.target.value)}\n                      />\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </TabPanel>\n            <TabPanel dataElement=\"PageNumberPanel\">\n              <div className=\"panel-body\">\n                <div className=\"add-url-link\">\n                  <form onSubmit={addPageLink}>\n                    <label htmlFor=\"pageInput\" className=\"inputLabel\">{t('link.enterpage')}</label>\n                    <div className=\"linkInput\">\n                      <input\n                        id=\"pageInput\"\n                        className=\"pageInput\"\n                        ref={pageLabelInput}\n                        value={pageLabel}\n                        onChange={(e) => setPageLabel(e.target.value)}\n                      />\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </TabPanel>\n          </Tabs>\n          <div className=\"divider\"></div>\n          <div className=\"footer\">\n            {\n              (selectedTab === 'URLPanelButton')\n                ?\n                (\n                  <Button\n                    className=\"ok-button\"\n                    dataElement=\"linkSubmitButton\"\n                    label={t('action.link')}\n                    onClick={addURLLink}\n                    disabled={!url.length}\n                  />\n                )\n                :\n                (\n                  <Button\n                    className=\"ok-button\"\n                    dataElement=\"linkSubmitButton\"\n                    label={t('action.link')}\n                    onClick={addPageLink}\n                    disabled={!isValidPageLabel()}\n                  />\n                )\n            }\n          </div>\n        </div>\n      </ModalWrapper>\n    </DataElementWrapper>\n  );\n};\n\nexport default LinkModal;\n","import LinkModal from './LinkModal';\n\nexport default LinkModal;"],"sourceRoot":""}